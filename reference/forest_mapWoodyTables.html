<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Map forest plot data — forest_mapWoodyTables • medfate</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map forest plot data — forest_mapWoodyTables"><meta name="description" content="Mapping functions to facilitate building forest objects from forest plot data"><meta property="og:description" content="Mapping functions to facilitate building forest objects from forest plot data"><meta property="og:image" content="https://emf-creaf.github.io/medfate/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">medfate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/intro/PackageOverview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../articles/intro/UnderstandingInputs.html">Understanding model inputs</a></li>
    <li><a class="dropdown-item" href="../articles/intro/PreparingInputs.html">Preparing model inputs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Running simulations</h6></li>
    <li><a class="dropdown-item" href="../articles/runmodels/BasicWaterBalance.html">Basic water balance</a></li>
    <li><a class="dropdown-item" href="../articles/runmodels/AdvancedWaterEnergyBalance.html">Advanced water and energy balance</a></li>
    <li><a class="dropdown-item" href="../articles/runmodels/ForestGrowth.html">Forest growth</a></li>
    <li><a class="dropdown-item" href="../articles/runmodels/ForestDynamics.html">Forest dynamics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/medfate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Map forest plot data</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/R/forest_mapWoodyTables.R" class="external-link"><code>R/forest_mapWoodyTables.R</code></a></small>
      <div class="d-none name"><code>forest_mapWoodyTables.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Mapping functions to facilitate building forest objects from forest plot data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">forest_mapTreeTable</span><span class="op">(</span><span class="va">x</span>, <span class="va">mapping_x</span>, <span class="va">SpParams</span>, plot_size_x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">forest_mapShrubTable</span><span class="op">(</span><span class="va">y</span>, <span class="va">mapping_y</span>, <span class="va">SpParams</span>, plot_size_y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">forest_mapWoodyTables</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapping_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapping_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">SpParams</span>,</span>
<span>  plot_size_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_size_y <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A data frame with tree records in rows and attributes in columns. Tree records can correspond to individual trees or groups of trees with an associated density.</p></dd>


<dt id="arg-mapping-x">mapping_x<a class="anchor" aria-label="anchor" href="#arg-mapping-x"></a></dt>
<dd><p>A named character vector to specify mappings of columns in <code>x</code> into attributes of <code>treeData</code> data frames. Accepted names (and the corresponding specifications for the columns in <code>x</code>) are:</p></dd>


<dt id="arg-spparams">SpParams<a class="anchor" aria-label="anchor" href="#arg-spparams"></a></dt>
<dd><p>A data frame with species parameters (see <code><a href="SpParams.html">SpParamsMED</a></code>) from which valid species names are drawn.</p></dd>


<dt id="arg-plot-size-x">plot_size_x<a class="anchor" aria-label="anchor" href="#arg-plot-size-x"></a></dt>
<dd><p>The size of tree plot sampled area (in m2). Alternatively, 'plot_size_x'
can be a column in <code>x</code> and specified in <code>mapping_x</code> to indicate that trees
have been measured in different subplots and, therefore, they represent different
densities per hectare.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A data frame with shrub records in rows and attributes in columns. Records can correspond to individual shrubs (with crown dimensions and height) or groups of shrubs with an associated cover estimate.</p></dd>


<dt id="arg-mapping-y">mapping_y<a class="anchor" aria-label="anchor" href="#arg-mapping-y"></a></dt>
<dd><p>A named character vector to specify mappings of columns in <code>y</code> into attributes of <code>shrubData</code> data frames.
Accepted names (and the corresponding specifications for the columns in <code>y</code>) are:</p><ul><li><p><code>Species</code>: Species code (should follow codes in <code>SpParams</code>).</p></li>
<li><p><code>Species.name</code>: Species name. In this case, the species code will be drawn by matching names with species names in <code>SpParams</code>.</p></li>
<li><p><code>N</code>: Tree density (in individuals per ha).</p></li>
<li><p><code>Cover</code>: Shrub cover (in percent).</p></li>
<li><p><code>D1</code>: Shrub largest crown diameter (in cm).</p></li>
<li><p><code>D2</code>: Shrub crown diameter orthogonal to the largest one (in cm).</p></li>
<li><p><code>plot.size</code>: Plot size (in m2) to which each record refers to. This is used to calculate tree density (stems per hectare) when not supplied or shrub cover when shrub data is given at the individual level.</p></li>
<li><p><code>DBH</code>: Diameter at breast height (in cm).</p></li>
<li><p><code>Height</code>: Tree or shrub height (in cm).</p></li>
<li><p><code>Z50</code>: Depth (in mm) corresponding to 50 percent of fine roots.</p></li>
<li><p><code>Z95</code>: Depth (in mm) corresponding to 95 percent of fine roots.</p></li>
</ul></dd>


<dt id="arg-plot-size-y">plot_size_y<a class="anchor" aria-label="anchor" href="#arg-plot-size-y"></a></dt>
<dd><p>The size of shrub plot sampled area (in m2). Alternatively, 'plot_size_y'
can be a column in <code>y</code> and specified in <code>mapping_y</code> to indicate that shrubs
have been measured in different subplots and, therefore, they represent different
cover values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Functions <code>forest_mapTreeTable</code> and <code>forest_mapShrubTable</code> return a data frame with the structure of <code>treeData</code> and <code>shrubData</code> from <code><a href="forest.html">forest</a></code> objects. Function <code>forest_mapWoodyTable</code> returns directly a <code><a href="forest.html">forest</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="forest.html">forest</a></code>, <code><a href="poblet_trees.html">poblet_trees</a></code>, <code><a href="forest_simplification.html">forest_mergeTrees</a></code>, <code><a href="tree2forest.html">tree2forest</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Cáceres Ainsa, EMF-CREAF</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load species parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SpParamsMED</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create an empty forest object</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="emptyforest.html">emptyforest</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) Mapping tree data</span></span></span>
<span class="r-in"><span><span class="co"># Load Poblet tree data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">poblet_trees</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subset control plot</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">poblet_trees</span>, <span class="va">Plot.Code</span><span class="op">==</span><span class="st">"POBL_CTL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate sampled area (15-m radius plot)</span></span></span>
<span class="r-in"><span><span class="va">sampled_area</span> <span class="op">&lt;-</span> <span class="va">pi</span><span class="op">*</span><span class="fl">15</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define mapping</span></span></span>
<span class="r-in"><span><span class="va">mapping_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species.name"</span> <span class="op">=</span> <span class="st">"Species"</span>, <span class="st">"DBH"</span> <span class="op">=</span> <span class="st">"Diameter.cm"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Map tree data for plot 'POBL_CTL'</span></span></span>
<span class="r-in"><span><span class="va">f</span><span class="op">$</span><span class="va">treeData</span> <span class="op">&lt;-</span> <span class="fu">forest_mapTreeTable</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>                    mapping_x <span class="op">=</span> <span class="va">mapping_x</span>, SpParams <span class="op">=</span> <span class="va">SpParamsMED</span>,</span></span>
<span class="r-in"><span>                    plot_size_x <span class="op">=</span> <span class="va">sampled_area</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) Mapping shrub individual data</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Create the individual shrub data frame</span></span></span>
<span class="r-in"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Erica arborea"</span>,<span class="st">"Cistus albidus"</span>, <span class="st">"Erica arborea"</span>, <span class="st">"Cistus albidus"</span>, <span class="st">"Cistus albidus"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">50</span>,<span class="fl">100</span>,<span class="fl">40</span>,<span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">140</span>,<span class="fl">40</span>,<span class="fl">100</span>, <span class="fl">35</span>,<span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D2</span> <span class="op">&lt;-</span> <span class="va">D1</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">H</span>, <span class="va">D1</span>, <span class="va">D2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define mapping (D1 and D2 map to variables with the same name)</span></span></span>
<span class="r-in"><span><span class="va">mapping_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species.name"</span><span class="op">=</span> <span class="st">"species"</span>, <span class="st">"Height"</span> <span class="op">=</span><span class="st">"H"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Map individual shrub data to cover data (here each individual becomes a cohort)</span></span></span>
<span class="r-in"><span><span class="co"># assuming that the sampled area was 4 m2</span></span></span>
<span class="r-in"><span><span class="va">f</span><span class="op">$</span><span class="va">shrubData</span> <span class="op">&lt;-</span> <span class="fu">forest_mapShrubTable</span><span class="op">(</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>                     mapping_y <span class="op">=</span> <span class="va">mapping_y</span>, SpParams <span class="op">=</span> <span class="va">SpParamsMED</span>,</span></span>
<span class="r-in"><span>                     plot_size_y <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) Print forest attributes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">SpParamsMED</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tree BA (m2/ha): 42.6957047  adult trees: 42.6957047  saplings: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Density (ind/ha) adult trees: 3777.277316  saplings: 0  shrubs (estimated): 19051.5105038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cover (%) adult trees: 100  saplings: 0  shrubs: 65.4334845  herbs: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LAI (m2/m2) total: 6.0900572  adult trees: 5.6770407  saplings: 0  shrubs: 0.4130165  herbs: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fuel loading (kg/m2) total: 1.5959112  adult trees: 1.493419  saplings: 0  shrubs: 0.1024922  herbs: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PAR ground (%): NA  SWR ground (%): NA </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (4) Forest initialization in a single step</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">forest_mapWoodyTables</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,</span></span>
<span class="r-in"><span>                           mapping_x <span class="op">=</span> <span class="va">mapping_x</span>, mapping_y <span class="op">=</span> <span class="va">mapping_y</span>,</span></span>
<span class="r-in"><span>                           SpParams <span class="op">=</span> <span class="va">SpParamsMED</span>,</span></span>
<span class="r-in"><span>                           plot_size_x <span class="op">=</span> <span class="va">sampled_area</span>, plot_size_y <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">SpParamsMED</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tree BA (m2/ha): 42.6957047  adult trees: 42.6957047  saplings: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Density (ind/ha) adult trees: 3777.277316  saplings: 0  shrubs (estimated): 19051.5105038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cover (%) adult trees: 100  saplings: 0  shrubs: 65.4334845  herbs: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LAI (m2/m2) total: 6.0900572  adult trees: 5.6770407  saplings: 0  shrubs: 0.4130165  herbs: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fuel loading (kg/m2) total: 1.5959112  adult trees: 1.493419  saplings: 0  shrubs: 0.1024922  herbs: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PAR ground (%): NA  SWR ground (%): NA </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Víctor Granda, Antoine Cabon, Arsène Druel, Julien Ruffault.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>


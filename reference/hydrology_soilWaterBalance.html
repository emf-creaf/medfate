<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title> Correction: Amount of water (mm) added to deep drainage to correct the water balance. VolumeChange: Change in soil water volume (mm). Substep: Time step of the moisture solving (seconds).  If soilDomains == "dual" the named vector contains the following additional elements:  Lateral flows: Sum of water circulating between micropores and macropores, positive when filling micropores (mm). InfiltrationMatrix: Water infiltrated into the soil matrix (mm). InfiltrationMacropores: Water infiltrated into the soil macropore domain (mm). InfiltrationExcessMatrix/InfiltrationExcessMacropores: Excess infiltration in the topmost layer (mm) leading to an increase in runoff. SaturationExcessMatrix/SaturationExcessMacropores: Excess saturation in the topmost layer (mm) leading to an increase in runoff. DrainageMatrix: Water draining from the bottom layer of the matrix domain (mm). This quantity is corrected to close water balance in the micropore domain. DrainageMacropores: Water draining from the bottom layer of the macropore domain (mm). This quantity is corrected to close the water balance in the macropore domain. CorrectionMatrix: Amount of water (mm) added to deep drainage of soil matrix to correct the water balance. CorrectionMacropores: Amount of water (mm) added to deep drainage of macropores to correct the water balance. MatrixVolumeChange: Change in soil water volume in the soil matrix domain (mm). MacroporeVolumeChange: Change in soil water volume in the macropore domain (mm).  — hydrology_soilWaterBalance • medfate</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content=" Correction: Amount of water (mm) added to deep drainage to correct the water balance. VolumeChange: Change in soil water volume (mm). Substep: Time step of the moisture solving (seconds).  If soilDomains == " dual the named vector contains following additional elements: lateral flows: sum of water circulating between micropores and macropores positive when filling infiltrationmatrix: infiltrated into soil matrix infiltrationmacropores: macropore domain infiltrationexcessmatrix excess infiltration in topmost layer leading to an increase runoff. saturationexcessmatrix saturation drainagematrix: draining from bottom this quantity is corrected close balance micropore domain. drainagemacropores: correctionmatrix: amount added deep drainage correct balance. correctionmacropores: matrixvolumechange: change volume macroporevolumechange: hydrology_soilwaterbalance><meta name="description" content='

Correction: Amount of water (mm) added to deep drainage to correct the water balance.
VolumeChange: Change in soil water volume (mm).
Substep: Time step of the moisture solving (seconds).
If soilDomains == "dual" the named vector contains the following additional elements:
Lateral flows: Sum of water circulating between micropores and macropores, positive when filling micropores (mm).
InfiltrationMatrix: Water infiltrated into the soil matrix (mm).
InfiltrationMacropores: Water infiltrated into the soil macropore domain (mm).
InfiltrationExcessMatrix/InfiltrationExcessMacropores: Excess infiltration in the topmost layer (mm) leading to an increase in runoff.
SaturationExcessMatrix/SaturationExcessMacropores: Excess saturation in the topmost layer (mm) leading to an increase in runoff.
DrainageMatrix: Water draining from the bottom layer of the matrix domain (mm). This quantity is corrected to close water balance in the micropore domain.
DrainageMacropores: Water draining from the bottom layer of the macropore domain (mm). This quantity is corrected to close the water balance in the macropore domain.
CorrectionMatrix: Amount of water (mm) added to deep drainage of soil matrix to correct the water balance.
CorrectionMacropores: Amount of water (mm) added to deep drainage of macropores to correct the water balance.
MatrixVolumeChange: Change in soil water volume in the soil matrix domain (mm).
MacroporeVolumeChange: Change in soil water volume in the macropore domain (mm).

'><meta property="og:description" content='

Correction: Amount of water (mm) added to deep drainage to correct the water balance.
VolumeChange: Change in soil water volume (mm).
Substep: Time step of the moisture solving (seconds).
If soilDomains == "dual" the named vector contains the following additional elements:
Lateral flows: Sum of water circulating between micropores and macropores, positive when filling micropores (mm).
InfiltrationMatrix: Water infiltrated into the soil matrix (mm).
InfiltrationMacropores: Water infiltrated into the soil macropore domain (mm).
InfiltrationExcessMatrix/InfiltrationExcessMacropores: Excess infiltration in the topmost layer (mm) leading to an increase in runoff.
SaturationExcessMatrix/SaturationExcessMacropores: Excess saturation in the topmost layer (mm) leading to an increase in runoff.
DrainageMatrix: Water draining from the bottom layer of the matrix domain (mm). This quantity is corrected to close water balance in the micropore domain.
DrainageMacropores: Water draining from the bottom layer of the macropore domain (mm). This quantity is corrected to close the water balance in the macropore domain.
CorrectionMatrix: Amount of water (mm) added to deep drainage of soil matrix to correct the water balance.
CorrectionMacropores: Amount of water (mm) added to deep drainage of macropores to correct the water balance.
MatrixVolumeChange: Change in soil water volume in the soil matrix domain (mm).
MacroporeVolumeChange: Change in soil water volume in the macropore domain (mm).

'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label=""><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">medfate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/emf-creaf/medfate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><ul><li><p><code>Correction</code>: Amount of water (mm) added to deep drainage to correct the water balance.</p></li> <li><p><code>VolumeChange</code>: Change in soil water volume (mm).</p></li> <li><p><code>Substep</code>: Time step of the moisture solving (seconds).</p></li> </ul> If <code>soilDomains == "dual"</code> the named vector contains the following additional elements: <ul><li><p><code>Lateral flows</code>: Sum of water circulating between micropores and macropores, positive when filling micropores (mm).</p></li> <li><p><code>InfiltrationMatrix</code>: Water infiltrated into the soil matrix (mm).</p></li> <li><p><code>InfiltrationMacropores</code>: Water infiltrated into the soil macropore domain (mm).</p></li> <li><p><code>InfiltrationExcessMatrix/InfiltrationExcessMacropores</code>: Excess infiltration in the topmost layer (mm) leading to an increase in runoff.</p></li> <li><p><code>SaturationExcessMatrix/SaturationExcessMacropores</code>: Excess saturation in the topmost layer (mm) leading to an increase in runoff.</p></li> <li><p><code>DrainageMatrix</code>: Water draining from the bottom layer of the matrix domain (mm). This quantity is corrected to close water balance in the micropore domain.</p></li> <li><p><code>DrainageMacropores</code>: Water draining from the bottom layer of the macropore domain (mm). This quantity is corrected to close the water balance in the macropore domain.</p></li> <li><p><code>CorrectionMatrix</code>: Amount of water (mm) added to deep drainage of soil matrix to correct the water balance.</p></li> <li><p><code>CorrectionMacropores</code>: Amount of water (mm) added to deep drainage of macropores to correct the water balance.</p></li> <li><p><code>MatrixVolumeChange</code>: Change in soil water volume in the soil matrix domain (mm).</p></li> <li><p><code>MacroporeVolumeChange</code>: Change in soil water volume in the macropore domain (mm).</p></li> </ul></h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>hydrology_soilWaterBalance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    
<ul><li><p><code>Correction</code>: Amount of water (mm) added to deep drainage to correct the water balance.</p></li>
<li><p><code>VolumeChange</code>: Change in soil water volume (mm).</p></li>
<li><p><code>Substep</code>: Time step of the moisture solving (seconds).</p></li>
</ul><p>If <code>soilDomains == "dual"</code> the named vector contains the following additional elements:</p><ul><li><p><code>Lateral flows</code>: Sum of water circulating between micropores and macropores, positive when filling micropores (mm).</p></li>
<li><p><code>InfiltrationMatrix</code>: Water infiltrated into the soil matrix (mm).</p></li>
<li><p><code>InfiltrationMacropores</code>: Water infiltrated into the soil macropore domain (mm).</p></li>
<li><p><code>InfiltrationExcessMatrix/InfiltrationExcessMacropores</code>: Excess infiltration in the topmost layer (mm) leading to an increase in runoff.</p></li>
<li><p><code>SaturationExcessMatrix/SaturationExcessMacropores</code>: Excess saturation in the topmost layer (mm) leading to an increase in runoff.</p></li>
<li><p><code>DrainageMatrix</code>: Water draining from the bottom layer of the matrix domain (mm). This quantity is corrected to close water balance in the micropore domain.</p></li>
<li><p><code>DrainageMacropores</code>: Water draining from the bottom layer of the macropore domain (mm). This quantity is corrected to close the water balance in the macropore domain.</p></li>
<li><p><code>CorrectionMatrix</code>: Amount of water (mm) added to deep drainage of soil matrix to correct the water balance.</p></li>
<li><p><code>CorrectionMacropores</code>: Amount of water (mm) added to deep drainage of macropores to correct the water balance.</p></li>
<li><p><code>MatrixVolumeChange</code>: Change in soil water volume in the soil matrix domain (mm).</p></li>
<li><p><code>MacroporeVolumeChange</code>: Change in soil water volume in the macropore domain (mm).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hydrology_soilWaterBalance</span><span class="op">(</span></span>
<span>  <span class="va">soil</span>,</span>
<span>  <span class="va">soilFunctions</span>,</span>
<span>  <span class="va">rainfallInput</span>,</span>
<span>  <span class="va">rainfallIntensity</span>,</span>
<span>  <span class="va">snowmelt</span>,</span>
<span>  <span class="va">sourceSink</span>,</span>
<span>  runon <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lateralFlows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  waterTableDepth <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  infiltrationMode <span class="op">=</span> <span class="st">"GreenAmpt1911"</span>,</span>
<span>  infiltrationCorrection <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  soilDomains <span class="op">=</span> <span class="st">"buckets"</span>,</span>
<span>  nsteps <span class="op">=</span> <span class="fl">24L</span>,</span>
<span>  max_nsubsteps <span class="op">=</span> <span class="fl">3600L</span>,</span>
<span>  modifySoil <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bonan, G. (2019). Climate change and terrestrial ecosystem modeling. Cambridge University Press, Cambridge, UK.</p>
<p>Jarvis, N.J., Jansson, P‐E., Dik, P.E. &amp; Messing, I. (1991). Modelling water and solute transport in macroporous soil. I. Model description and sensitivity analysis. Journal of Soil Science, 42, 59–70.</p>
<p>Larsbo, M., Roulier, S., Stenemo, F., Kasteel, R. &amp; Jarvis, N. (2005). An Improved Dual‐Permeability Model of Water Flow and Solute Transport in the Vadose Zone. Vadose Zone Journal, 4, 398–406.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Define soil parameters</span></span></span>
<span class="r-in"><span><span class="va">spar</span> <span class="op">&lt;-</span> <span class="fu"><a href="defaultSoilParams.html">defaultSoilParams</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initializes soil hydraulic parameters</span></span></span>
<span class="r-in"><span><span class="va">examplesoil</span> <span class="op">&lt;-</span> <span class="fu"><a href="soil.html">soil</a></span><span class="op">(</span><span class="va">spar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Water balance in a multi-bucket model</span></span></span>
<span class="r-in"><span><span class="fu">hydrology_soilWaterBalance</span><span class="op">(</span><span class="va">examplesoil</span>, <span class="st">"VG"</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                           soilDomains <span class="op">=</span> <span class="st">"buckets"</span>, modifySoil <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Local source/sinks Lateral source/sinks         Infiltration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -4.000000             0.000000            10.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   InfiltrationExcess     SaturationExcess               Runoff </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0.000000             0.000000             0.000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DeepDrainage      CapillarityRise </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             4.121414             0.000000 </span>
<span class="r-in"><span>                           </span></span>
<span class="r-in"><span><span class="co"># Water balance in a single-domain model (Richards equation)</span></span></span>
<span class="r-in"><span><span class="fu">hydrology_soilWaterBalance</span><span class="op">(</span><span class="va">examplesoil</span>, <span class="st">"VG"</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                           soilDomains <span class="op">=</span> <span class="st">"single"</span>, modifySoil <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Local source/sinks Lateral source/sinks         Infiltration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         -4.000000000          0.000000000         10.000000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   InfiltrationExcess     SaturationExcess               Runoff </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0.000000000          0.000000000          0.000000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DeepDrainage      CapillarityRise           Correction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0.005785380          0.000000000         -0.001286961 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         VolumeChange             Substeps </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5.994214620         24.000000000 </span>
<span class="r-in"><span>                    </span></span>
<span class="r-in"><span><span class="co"># Water balance in a dual-permeability model (MACRO)</span></span></span>
<span class="r-in"><span><span class="fu">hydrology_soilWaterBalance</span><span class="op">(</span><span class="va">examplesoil</span>, <span class="st">"VG"</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                           soilDomains <span class="op">=</span> <span class="st">"dual"</span>, modifySoil <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Local source/sinks         Lateral source/sinks </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                -4.000000e+00                 0.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Matrix-macropore flow           InfiltrationMatrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 4.836043e+00                 4.481027e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       InfiltrationMacropores     InfiltrationExcessMatrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 5.518973e+00                 0.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InfiltrationExcessMacropores       SaturationExcessMatrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.000000e+00                 0.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SaturationExcessMacropores               DrainageMatrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.000000e+00                 2.379449e-02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           DrainageMacropores            CapillarityMatrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 3.889382e-06                 0.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        CapillarityMacropores             CorrectionMatrix </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.000000e+00                -4.573672e-03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CorrectionMacropores           MatrixVolumeChange </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 3.889382e-06                 5.293276e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        MacroporeVolumeChange                 Infiltration </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 6.829261e-01                 1.000000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           InfiltrationExcess             SaturationExcess </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.000000e+00                 0.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       Runoff                 DeepDrainage </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.000000e+00                 2.379838e-02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              CapillarityRise                   Correction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.000000e+00                -4.569782e-03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 VolumeChange                     Substeps </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 5.976202e+00                 2.400000e+01 </span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label=""><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>

  

  

  </body></html>


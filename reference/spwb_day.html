<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Single day simulation — spwb_day • medfate</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Single day simulation — spwb_day"><meta property="og:description" content="Function spwb_day performs water balance for a single day and growth_day performs water and carbon balance for a single day."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/emf-creaf/medfate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Single day simulation</h1>
    
    <div class="hidden name"><code>spwb_day.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>spwb_day</code> performs water balance for a single day and <code>growth_day</code> performs water and carbon balance for a single day.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">spwb_day</span><span class="op">(</span><span class="va">x</span>, <span class="va">date</span>, <span class="va">tmin</span>, <span class="va">tmax</span>, <span class="va">rhmin</span>, <span class="va">rhmax</span>, <span class="va">rad</span>, <span class="va">wind</span>, 
         <span class="va">latitude</span>, <span class="va">elevation</span>, <span class="va">slope</span>, <span class="va">aspect</span>, <span class="va">prec</span>, runon <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>
<span class="fu">growth_day</span><span class="op">(</span><span class="va">x</span>, <span class="va">date</span>, <span class="va">tmin</span>, <span class="va">tmax</span>, <span class="va">rhmin</span>, <span class="va">rhmax</span>, <span class="va">rad</span>, <span class="va">wind</span>, 
           <span class="va">latitude</span>, <span class="va">elevation</span>, <span class="va">slope</span>, <span class="va">aspect</span>, <span class="va">prec</span>, runon <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>An object of class <code><a href="modelInput.html">spwbInput</a></code> or <code><a href="modelInput.html">growthInput</a></code>.</p></dd>
<dt>date</dt>
<dd><p>Date as string "yyyy-mm-dd".</p></dd>
<dt>tmin, tmax</dt>
<dd><p>Minimum and maximum temperature (in degrees Celsius).</p></dd>
<dt>rhmin, rhmax</dt>
<dd><p>Minimum and maximum relative humidity (in percent).</p></dd>
<dt>rad</dt>
<dd><p>Solar radiation (in MJ/m2/day).</p></dd>
<dt>wind</dt>
<dd><p>Wind speed (in m/s).</p></dd>
<dt>prec</dt>
<dd><p>Precipitation (in mm).</p></dd>
<dt>latitude</dt>
<dd><p>Latitude (in degrees). Required when using the 'Sperry' transpiration mode.</p></dd>
<dt>elevation, slope, aspect</dt>
<dd><p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North). Required when using the 'Sperry' transpiration mode.</p></dd>
<dt>runon</dt>
<dd><p>Surface water amount running on the target area from upslope (in mm).</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Detailed model description is available in the vignettes section. The model using 'Granier' transpiration mode is described in De Caceres et al. (2015). Simulations using the 'Sperry' transpiration mode are computationally much more expensive, are described in De Cáceres et al. (2021) and are illustrated by function <code><a href="transp_modes.html">transp_transpirationSperry</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Function <code>spwb_day()</code> returns a list of class <code>spwb_day</code> with the following elements:</p><ul><li><p><code>"cohorts"</code>: A data frame with cohort information, copied from <code><a href="modelInput.html">spwbInput</a></code>.</p></li>
<li><p><code>"WaterBalance"</code>: A vector of water balance components (rain, snow, net rain, infiltration, ...) for the simulated day, equivalent to one row of 'WaterBalance' object given in <code><a href="spwb.html">spwb</a></code>.</p></li>
<li><p><code>"Soil"</code>: A data frame with results for each soil layer:
    </p><ul><li><p><code>"SoilEvaporation"</code>: Water evaporated from the soil surface (in mm).</p></li>
<li><p><code>"HydraulicInput"</code>: Water entering each soil layer from other layers, transported via plant hydraulic network (in mm) (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"HydraulicOutput"</code>: Water leaving each soil layer (going to other layers or the transpiration stream) (in mm) (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"PlantExtraction"</code>: Water extracted by plants from each soil layer (in mm).</p></li>
<li><p><code>"psi"</code>: Soil water potential (in MPa).</p></li>
</ul></li>
<li><p><code>"Stand"</code>: A named vector with with stand values for the simulated day, equivalent to one row of 'Stand' object returned by <code><a href="spwb.html">spwb</a></code>.</p></li>
<li><p><code>"Plants"</code>: A data frame of results for each plant cohort (see <code><a href="transp_modes.html">transp_transpirationGranier</a></code> or <code><a href="transp_modes.html">transp_transpirationSperry</a></code>).</p></li>
</ul><p>The following items are only returned when <code>transpirationMode = "Sperry"</code>:</p><ul><li><p><code>"EnergyBalance"</code>: Energy balance of the stand (see <code><a href="transp_modes.html">transp_transpirationSperry</a></code>).</p></li>
<li><p><code>"RhizoPsi"</code>: Minimum water potential (in MPa) inside roots, after crossing rhizosphere, per cohort and soil layer.</p></li>
<li><p><code>"SunlitLeaves"</code> and <code>"ShadeLeaves"</code>: For each leaf type, a data frame with values of LAI, Vmax298 and Jmax298 for leaves of this type in each plant cohort.</p></li>
<li><p><code>"ExtractionInst"</code>: Water extracted by each plant cohort during each time step.</p></li>
<li><p><code>"PlantsInst"</code>: A list with instantaneous (per time step) results for each plant cohort (see <code><a href="transp_modes.html">transp_transpirationSperry</a></code>).</p></li>
<li><p><code>"LightExtinction"</code>: A list of information regarding radiation balance through the canopy, as returned by function <code><a href="light.html">light_instantaneousLightExtinctionAbsortion</a></code>.</p></li>
<li><p><code>"CanopyTurbulence"</code>: Canopy turbulence (see <code><a href="wind.html">wind_canopyTurbulence</a></code>).</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>De Cáceres M, Martínez-Vilalta J, Coll L, Llorens P, Casals P, Poyatos R, Pausas JG, Brotons L. (2015) Coupling a water balance model with forest inventory data to predict drought stress: the role of forest structural changes vs. climate changes. Agricultural and Forest Meteorology (doi:10.1016/j.agrformet.2015.06.012).</p>
<p>De Cáceres M, Mencuccini M, Martin-StPaul N, Limousin JM, Coll L, Poyatos R, Cabon A, Granda V, Forner A, Valladares F, Martínez-Vilalta J (2021) Unravelling the effect of species mixing on water use and drought stress in holm oak forests: a modelling approach. Agricultural and Forest Meteorology 296 (doi: 10.1016/j.agrformet.2020.108233).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CREAF</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Object <code>x</code> is modified during the simulation, unless control parameter <code>modifyInput = FALSE</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="modelInput.html">spwbInput</a></code>, <code><a href="spwb.html">spwb</a></code>,  <code><a href="plot.spwb_day.html">plot.spwb_day</a></code>,  
<code><a href="modelInput.html">growthInput</a></code>, <code><a href="growth.html">growth</a></code>,  <code><a href="plot.spwb_day.html">plot.growth_day</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#Load example daily meteorological data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Load example plot plant data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exampleforestMED</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Default species parameterization</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SpParamsMED</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Initialize control parameters</span></span>
<span class="r-in"><span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="defaultControl.html">defaultControl</a></span><span class="op">(</span><span class="st">"Granier"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Day to be simulated</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">=</span> <span class="fl">100</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Simulate water balance one day only (Granier)</span></span>
<span class="r-in"><span class="va">examplesoil</span> <span class="op">=</span> <span class="fu"><a href="soil.html">soil</a></span><span class="op">(</span><span class="fu"><a href="defaultSoilParams.html">defaultSoilParams</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="modelInput.html">forest2spwbInput</a></span><span class="op">(</span><span class="va">exampleforestMED</span>,<span class="va">examplesoil</span>, <span class="va">SpParamsMED</span>, <span class="va">control</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sd1</span><span class="op">&lt;-</span><span class="fu">spwb_day</span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>,  </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MinTemperature</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MaxTemperature</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MinRelativeHumidity</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MaxRelativeHumidity</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">Radiation</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">WindSpeed</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             latitude <span class="op">=</span> <span class="fl">41.82592</span>, elevation <span class="op">=</span> <span class="fl">100</span>, slope<span class="op">=</span><span class="fl">0</span>, aspect<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">             prec <span class="op">=</span> <span class="va">examplemeteo</span><span class="op">$</span><span class="va">Precipitation</span><span class="op">[</span><span class="va">d</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Simulate water balance for one day only (Sperry's mode)</span></span>
<span class="r-in"><span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="defaultControl.html">defaultControl</a></span><span class="op">(</span><span class="st">"Sperry"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">examplesoil2</span> <span class="op">=</span> <span class="fu"><a href="soil.html">soil</a></span><span class="op">(</span><span class="fu"><a href="defaultSoilParams.html">defaultSoilParams</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="modelInput.html">forest2spwbInput</a></span><span class="op">(</span><span class="va">exampleforestMED</span>,<span class="va">examplesoil2</span>, <span class="va">SpParamsMED</span>, <span class="va">control</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sd2</span><span class="op">&lt;-</span><span class="fu">spwb_day</span><span class="op">(</span><span class="va">x2</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>,</span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MinTemperature</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MaxTemperature</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MinRelativeHumidity</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MaxRelativeHumidity</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">Radiation</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">WindSpeed</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             latitude <span class="op">=</span> <span class="fl">41.82592</span>, elevation <span class="op">=</span> <span class="fl">100</span>, slope<span class="op">=</span><span class="fl">0</span>, aspect<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">             prec <span class="op">=</span> <span class="va">examplemeteo</span><span class="op">$</span><span class="va">Precipitation</span><span class="op">[</span><span class="va">d</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Plot plant transpiration (see function 'plot.swb.day()')</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/sensitivity/man/plot.support.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sd2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spwb_day-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Simulate water and carbon balance for one day only</span></span>
<span class="r-in"><span class="va">examplesoil3</span> <span class="op">=</span> <span class="fu"><a href="soil.html">soil</a></span><span class="op">(</span><span class="fu"><a href="defaultSoilParams.html">defaultSoilParams</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x3</span> <span class="op">=</span> <span class="fu"><a href="modelInput.html">forest2growthInput</a></span><span class="op">(</span><span class="va">exampleforestMED</span>,<span class="va">examplesoil3</span>, <span class="va">SpParamsMED</span>, <span class="va">control</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sd3</span><span class="op">&lt;-</span><span class="fu">growth_day</span><span class="op">(</span><span class="va">x3</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>,</span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MinTemperature</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MaxTemperature</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MinRelativeHumidity</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">MaxRelativeHumidity</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             <span class="va">examplemeteo</span><span class="op">$</span><span class="va">Radiation</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, <span class="va">examplemeteo</span><span class="op">$</span><span class="va">WindSpeed</span><span class="op">[</span><span class="va">d</span><span class="op">]</span>, </span>
<span class="r-in">             latitude <span class="op">=</span> <span class="fl">41.82592</span>, elevation <span class="op">=</span> <span class="fl">100</span>, slope<span class="op">=</span><span class="fl">0</span>, aspect<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">             prec <span class="op">=</span> <span class="va">examplemeteo</span><span class="op">$</span><span class="va">Precipitation</span><span class="op">[</span><span class="va">d</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>


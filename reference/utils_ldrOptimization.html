<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimization of root distribution — utils_ldrExploration • medfate</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimization of root distribution — utils_ldrExploration"><meta name="description" content="Functions utils_ldrExploration and utils_ldrOptimization are used to
find optimum the species root distribution within spwb, given the arguments
x, meteo and psi_crit."><meta property="og:description" content="Functions utils_ldrExploration and utils_ldrOptimization are used to
find optimum the species root distribution within spwb, given the arguments
x, meteo and psi_crit."><meta property="og:image" content="https://emf-creaf.github.io/medfate/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">medfate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/intro/PackageOverview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../articles/intro/UnderstandingInputs.html">Understanding model inputs</a></li>
    <li><a class="dropdown-item" href="../articles/intro/PreparingInputs.html">Preparing model inputs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Running simulations</h6></li>
    <li><a class="dropdown-item" href="../articles/runmodels/BasicWaterBalance.html">Basic water balance</a></li>
    <li><a class="dropdown-item" href="../articles/runmodels/AdvancedWaterEnergyBalance.html">Advanced water and energy balance</a></li>
    <li><a class="dropdown-item" href="../articles/runmodels/ForestGrowth.html">Forest growth</a></li>
    <li><a class="dropdown-item" href="../articles/runmodels/ForestDynamics.html">Forest dynamics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/medfate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimization of root distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/R/utils_ldrOptimization.R" class="external-link"><code>R/utils_ldrOptimization.R</code></a></small>
      <div class="d-none name"><code>utils_ldrOptimization.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions <code>utils_ldrExploration</code> and <code>utils_ldrOptimization</code> are used to
find optimum the species root distribution within <code>spwb</code>, given the arguments
<code>x</code>, <code>meteo</code> and <code>psi_crit</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">utils_ldrExploration</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">meteo</span>,</span>
<span>  cohorts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RZmin <span class="op">=</span> <span class="fl">301</span>,</span>
<span>  RZmax <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  V1min <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  V1max <span class="op">=</span> <span class="fl">0.94</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  heat_stop <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  transformation <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">utils_ldrOptimization</span><span class="op">(</span><span class="va">y</span>, <span class="va">psi_crit</span>, opt_mode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code><a href="modelInput.html">spwbInput</a></code>.</p></dd>


<dt id="arg-meteo">meteo<a class="anchor" aria-label="anchor" href="#arg-meteo"></a></dt>
<dd><p>A data frame with daily meteorological data series (see <code><a href="spwb.html">spwb</a></code>).</p></dd>


<dt id="arg-cohorts">cohorts<a class="anchor" aria-label="anchor" href="#arg-cohorts"></a></dt>
<dd><p>A character string with the names of cohorts to be explored. If <code>NULL</code> then all cohorts are explored.</p></dd>


<dt id="arg-rzmin">RZmin<a class="anchor" aria-label="anchor" href="#arg-rzmin"></a></dt>
<dd><p>The minimum value of RZ (the rooting depth) to be explored (in mm)</p></dd>


<dt id="arg-rzmax">RZmax<a class="anchor" aria-label="anchor" href="#arg-rzmax"></a></dt>
<dd><p>The maximum value of RZ (the rooting depth) to be explored (in mm)</p></dd>


<dt id="arg-v-min">V1min<a class="anchor" aria-label="anchor" href="#arg-v-min"></a></dt>
<dd><p>The minimum value of V1 (the root proportion in the first soil layer) to be explored</p></dd>


<dt id="arg-v-max">V1max<a class="anchor" aria-label="anchor" href="#arg-v-max"></a></dt>
<dd><p>The maximum value of V1 (the root proportion in the first soil layer) to be explored</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>An integer defining the number of values to obtain by discretization of the root parameters RZ and V1. The number of parameter combinations and therefore the computation cost increases increase with the square of resolution</p></dd>


<dt id="arg-heat-stop">heat_stop<a class="anchor" aria-label="anchor" href="#arg-heat-stop"></a></dt>
<dd><p>An integer defining the number of days during to discard from the calculation of the optimal root distribution. Usefull if the soil water content initialization is not certain</p></dd>


<dt id="arg-transformation">transformation<a class="anchor" aria-label="anchor" href="#arg-transformation"></a></dt>
<dd><p>Function to modify the size of Z intervals to be explored (by default, bins are equal).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value. Print the internal messages of the function?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters to function <code><a href="spwb.html">spwb</a></code>.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The result of calling <code>utils_ldrExploration</code>.</p></dd>


<dt id="arg-psi-crit">psi_crit<a class="anchor" aria-label="anchor" href="#arg-psi-crit"></a></dt>
<dd><p>A numerical vector of length iqual to the number of species in the plot containing the species values of water potential inducing hydraulic failure (in MPa). Use <code>NA</code> values to skip optimization for particular plant cohorts.</p></dd>


<dt id="arg-opt-mode">opt_mode<a class="anchor" aria-label="anchor" href="#arg-opt-mode"></a></dt>
<dd><p>Optimization mode:</p><ul><li><p><code>opt_mode = 1</code> maximizes transpiration along the line of stress equal to <code>psi_crit</code> (Cabon et al. 2018). The optimization is based on the eco-hydrological equilibrium hypothesis (Eagleson, 1982), which is formulated here as the root distribution for which plant transpiration is maximized while the plant water potential is close to the species-defined critical value <code>psi_crit</code> (Cabon et al.,2018).</p></li>
<li><p><code>opt_mode = 2</code> maximizes transpiration among combinations with stress according to <code>psi_crit</code>).</p></li>
<li><p><code>opt_mode = 3</code> maximizes photosynthesis among combinations with stress according to <code>psi_crit</code>).</p></li>
<li><p><code>opt_mode = 4</code> maximizes transpiration, subject to root construction constrains, among combinations with stress according to <code>psi_crit</code>).</p></li>
<li><p><code>opt_mode = 5</code> maximizes photosynthesis, subject to root construction constrains, among combinations with stress according to <code>psi_crit</code>).</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>utils_ldrExploration</code> returns a list containing a list containing
the explored RZ and V1 combinations as well as arrays with the values of average daily plant transpiration,
average daily net photosynthesis and the minimum plant water potential for each cohort and parameter combination.</p>
<p>Function <code>utils_ldrOptimization</code>  returns a data frame with containing
the species index used in medfate, <code>psi_crit</code> and the optimized values of V1
and the LDR parameters Z50 and Z95 (see <code><a href="root.html">root_ldrDistribution</a></code>)
and as many rows as the number of species.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each combination of the parameters RZ and V1 the function <code>utils_ldrExploration</code> runs <code>spwb</code>,
setting the total soil depth equal to RZ. The root proportion in each soil layer is derived from V1,
the depth of the first soil layer and RZ using the LDR root distribution model (Schenk and Jackson, 2002)
and assuming that the depth containing 95 percent of the roots is equal to RZ.
Function <code>utils_ldrOptimization</code> takes the result of the exploration and tries
to find optimum root distribution parameters. <code>psi_crit</code>, the species specific
water potential inducing hydraulic failure, can be approached by the water potential
inducing 50 percent of loss of conductance for the and gymnosperms and 88 percent for
the angiosperms (Urli et al., 2013, Brodribb et al., 2010). Details of the hypothesis
and limitations of the optimization method are given in Cabon et al. (2019).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Brodribb, T.J., Bowman, D.J.M.S., Nichols, S., Delzon, S., Burlett, R., 2010. Xylem function and growth rate interact to determine recovery rates after exposure to extreme water deficit. New Phytol. 188, 533–542. doi:10.1111/j.1469-8137.2010.03393.x</p>
<p>Cabon, A., Martínez-Vilalta, J., Poyatos, R., Martínez de Aragón, J., De Cáceres, M. (2018) Applying the eco-hydrological equilibrium hypothesis to estimate root ditribution in water-limited forests. Ecohydrology 11: e2015.</p>
<p>Eagleson, P.S., 1982. Ecological optimality in water-limited natural soil-vegetation systems: 1. Theory and hypothesis. Water Resour. Res. 18, 325–340. doi:10.1029/WR018i002p00325</p>
<p>Schenk, H.J., Jackson, R.B., 2002. The Global Biogeography of Roots. Ecol. Monogr. 72, 311. doi:10.2307/3100092</p>
<p>Urli, M., Porte, A.J., Cochard, H., Guengant, Y., Burlett, R., Delzon, S., 2013. Xylem embolism threshold for catastrophic hydraulic failure in angiosperm trees. Tree Physiol. 33, 672–683. doi:10.1093/treephys/tpt030</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="utils_rockOptimization.html">utils_rockOptimization</a></code>,  <code><a href="spwb.html">spwb</a></code>, <code><a href="soil.html">soil</a></code>, <code><a href="root.html">root_ldrDistribution</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Antoine Cabon, WSL</p>
<p>Miquel De Cáceres Ainsa, CREAF</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Víctor Granda, Antoine Cabon, Arsène Druel, Julien Ruffault.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>


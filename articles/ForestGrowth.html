<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forest growth • medfate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Forest growth">
<meta property="og:description" content="medfate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/emf-creaf/medfate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Forest growth</h1>
                        <h4 data-toc-skip class="author">Miquel De Caceres</h4>
            
            <h4 data-toc-skip class="date">2022-02-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/vignettes/ForestGrowth.Rmd" class="external-link"><code>vignettes/ForestGrowth.Rmd</code></a></small>
      <div class="hidden name"><code>ForestGrowth.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about-this-vignette">About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h2>
<p>This document describes how to run the growth model of <code>medfate</code>, implemented in function <code><a href="../reference/growth.html">growth()</a></code>. All the details of the model design and formulation can be found at <a href="https://emf-creaf.github.io/medfatebook/index.html" class="external-link uri">https://emf-creaf.github.io/medfatebook/index.html</a>.</p>
</div>
<div class="section level2">
<h2 id="preparing-model-inputs">Preparing model inputs<a class="anchor" aria-label="anchor" href="#preparing-model-inputs"></a>
</h2>
<p>Model inputs are explained in greater detail in vignette ‘<em>Simulation inputs</em>’. Here we only review the different steps required to run function <code><a href="../reference/growth.html">growth()</a></code>.</p>
<div class="section level3">
<h3 id="soil-vegetation-meteorology-and-species-data">Soil, vegetation, meteorology and species data<a class="anchor" aria-label="anchor" href="#soil-vegetation-meteorology-and-species-data"></a>
</h3>
<p>Soil information needs to be entered as a <code>data frame</code> with soil layers in rows and physical attributes in columns. Soil physical attributes can be initialized to default values, for a given number of layers, using function <code><a href="../reference/defaultSoilParams.html">defaultSoilParams()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spar</span> <span class="op">=</span> <span class="fu"><a href="../reference/defaultSoilParams.html">defaultSoilParams</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<p>The soil input for water balance simulation is actually a list of class <code>soil</code> that is created using a function with the same name:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">examplesoil</span> <span class="op">=</span> <span class="fu"><a href="../reference/soil.html">soil</a></span><span class="op">(</span><span class="va">spar</span><span class="op">)</span></code></pre></div>
<p>As explained in the package overview, models included in <code>medfate</code> were primarily designed to be ran on <strong>forest inventory plots</strong>. Here we use the example object provided with the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exampleforestMED</span><span class="op">)</span>
<span class="va">exampleforestMED</span></code></pre></div>
<pre><code><span class="co">## $ID</span>
<span class="co">## [1] "1"</span>
<span class="co">## </span>
<span class="co">## $patchsize</span>
<span class="co">## [1] 10000</span>
<span class="co">## </span>
<span class="co">## $treeData</span>
<span class="co">##   Species   N   DBH Height Z50  Z95</span>
<span class="co">## 1     148 168 37.55    800 400 2000</span>
<span class="co">## 2     168 384 14.60    660 400 2000</span>
<span class="co">## </span>
<span class="co">## $shrubData</span>
<span class="co">##   Species Cover Height Z50  Z95</span>
<span class="co">## 1     165  3.75     80 300 1500</span>
<span class="co">## </span>
<span class="co">## $herbCover</span>
<span class="co">## [1] 10</span>
<span class="co">## </span>
<span class="co">## $herbHeight</span>
<span class="co">## [1] 20</span>
<span class="co">## </span>
<span class="co">## attr(,"class")</span>
<span class="co">## [1] "forest" "list"</span></code></pre>
<p>In the basic water balance, only mean temperature, precipitation and potential evapotranspiration is required, but radiation may also be necessary to simulate snow melt.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##            MeanTemperature MinTemperature MaxTemperature Precipitation</span>
<span class="co">## 2001-01-01      3.57668969     -0.5934215       6.287950      4.869109</span>
<span class="co">## 2001-01-02      1.83695972     -2.3662458       4.569737      2.498292</span>
<span class="co">## 2001-01-03      0.09462563     -3.8541036       2.661951      0.000000</span>
<span class="co">## 2001-01-04      1.13866156     -1.8744860       3.097705      5.796973</span>
<span class="co">## 2001-01-05      4.70578690      0.3288287       7.551532      1.884401</span>
<span class="co">## 2001-01-06      4.57036721      0.5461322       7.186784     13.359801</span>
<span class="co">##            MeanRelativeHumidity MinRelativeHumidity MaxRelativeHumidity</span>
<span class="co">## 2001-01-01             78.73709            65.15411           100.00000</span>
<span class="co">## 2001-01-02             69.70800            57.43761            94.71780</span>
<span class="co">## 2001-01-03             70.69610            58.77432            94.66823</span>
<span class="co">## 2001-01-04             76.89156            66.84256            95.80950</span>
<span class="co">## 2001-01-05             76.67424            62.97656           100.00000</span>
<span class="co">## 2001-01-06             89.01940            74.25754           100.00000</span>
<span class="co">##            Radiation WindSpeed WindDirection       PET</span>
<span class="co">## 2001-01-01  12.89251  2.000000           172 1.3212770</span>
<span class="co">## 2001-01-02  13.03079  7.662544           278 2.2185985</span>
<span class="co">## 2001-01-03  16.90722  2.000000           141 1.8045176</span>
<span class="co">## 2001-01-04  11.07275  2.000000           172 0.9200627</span>
<span class="co">## 2001-01-05  13.45205  7.581347           321 2.2914449</span>
<span class="co">## 2001-01-06  12.84841  6.570501           141 1.7255058</span></code></pre>
<p>Finally, simulations in <code>medfate</code> require a data frame with species parameter values, which we load using defaults for Catalonia (NE Spain):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SpParamsMED"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulation-control">Simulation control<a class="anchor" aria-label="anchor" href="#simulation-control"></a>
</h3>
<p>Apart from data inputs, the behaviour of simulation models can be controlled using a set of global parameters. The default parameterization is obtained using function <code><a href="../reference/defaultControl.html">defaultControl()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="../reference/defaultControl.html">defaultControl</a></span><span class="op">(</span><span class="st">"Granier"</span><span class="op">)</span></code></pre></div>
<p>Here we will run growth simulations using the basic water balance model (i.e. <code>transpirationMode = "Granier"</code>). The complexity of the soil water balance calculations can be changed by using <code>"Sperry"</code> as input to <code><a href="../reference/defaultControl.html">defaultControl()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="growth-input-object">Growth input object<a class="anchor" aria-label="anchor" href="#growth-input-object"></a>
</h3>
<p>A last object is needed before calling simulation functions, called <code>growthInput</code>. This is analogous to <code>spwbInput</code> and consists in the compilation of aboveground and belowground parameters and the specification of additional parameter values for each plant cohort. The object can be obtained by calling function <code><a href="../reference/modelInput.html">growthInput()</a></code>, but if one has a <code>forest</code> object, it can be generated more directly using function <code><a href="../reference/modelInput.html">forest2growthInput()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/modelInput.html">forest2growthInput</a></span><span class="op">(</span><span class="va">exampleforestMED</span>, <span class="va">examplesoil</span>, <span class="va">SpParamsMED</span>, <span class="va">control</span><span class="op">)</span></code></pre></div>
<p>All the input information for forest data and species parameter values can be inspected by printing different elements of the input object, which are:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] "control"             "soil"                "canopy"             </span>
<span class="co">##  [4] "cohorts"             "above"               "below"              </span>
<span class="co">##  [7] "belowLayers"         "paramsPhenology"     "paramsAnatomy"      </span>
<span class="co">## [10] "paramsInterception"  "paramsTranspiration" "paramsWaterStorage" </span>
<span class="co">## [13] "paramsGrowth"        "paramsAllometries"   "internalPhenology"  </span>
<span class="co">## [16] "internalWater"       "internalCarbon"      "internalAllocation" </span>
<span class="co">## [19] "internalMortality"   "internalRings"</span></code></pre>
<p>First, information about the cohort species is found in element <code>cohorts</code> (i.e. code, species and name):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">cohorts</span></code></pre></div>
<pre><code><span class="co">##         SP              Name</span>
<span class="co">## T1_148 148  Pinus halepensis</span>
<span class="co">## T2_168 168      Quercus ilex</span>
<span class="co">## S1_165 165 Quercus coccifera</span></code></pre>
<p>Element <code>above</code> contains the aboveground structure data that we already know, but with additional columns that describe the estimated initial amount of sapwood area and carbon reserves (if required):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">above</span></code></pre></div>
<pre><code><span class="co">##         SP        N   DBH Cover   H        CR         SA   LAI_live</span>
<span class="co">## T1_148 148 168.0000 37.55    NA 800 0.6605196 437.032040 0.96734365</span>
<span class="co">## T2_168 168 384.0000 14.60    NA 660 0.6055642  96.506387 0.93111690</span>
<span class="co">## S1_165 165 749.4923    NA  3.75  80 0.8032817   1.251072 0.03928201</span>
<span class="co">##        LAI_expanded LAI_dead</span>
<span class="co">## T1_148   0.96734365        0</span>
<span class="co">## T2_168   0.93111690        0</span>
<span class="co">## S1_165   0.03928201        0</span></code></pre>
<p>As with the soil input object, the <code>growthInput</code> object will be modified during simulations. In the case of <code><a href="../reference/growth.html">growth()</a></code>, these modifications concern <code>SA</code>, <code>fastCstorage</code>, <code>slowCstorage</code>, <code>LAI_expanded</code> and <code>LAI_dead</code> in element <code>above</code>, as well as canopy variables.</p>
<p>Elements starting with <code>params*</code> contain cohort-specific model parameters. Aboveground parameters related to plant transpiration can be seen in <code>paramsTransp</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">paramsTransp</span></code></pre></div>
<pre><code><span class="co">##        Tmax_LAI Tmax_LAIsq Psi_Extract Psi_Critic      WUE WUE_decay pRootDisc</span>
<span class="co">## T1_148    0.134     -0.006   -2.600000  -3.816852 3.849903    0.2812         0</span>
<span class="co">## T2_168    0.134     -0.006   -3.001667  -3.001667 1.720883    0.2812         0</span>
<span class="co">## S1_165    0.134     -0.006   -3.455000  -6.950920 3.289704    0.2812         0</span></code></pre>
<p>Belowground parameters can be seen in <code>below</code> and include root distribution as well as maximum root and rhizosphere conductances by soil layer:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">below</span></code></pre></div>
<pre><code><span class="co">##        Z50  Z95 fineRootBiomass coarseRootSoilVolume</span>
<span class="co">## T1_148 400 2000      1574.98321             9.997093</span>
<span class="co">## T2_168 400 2000       721.44857             9.997093</span>
<span class="co">## S1_165 300 1500        13.57757             7.473966</span></code></pre>
<p>Parameters related to plant growth can be seen in <code>paramsGrowth</code> and <code>paramsAllometries</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">paramsGrowth</span></code></pre></div>
<pre><code><span class="co">##           RERleaf   RERsapwood  RERfineroot CCleaf CCsapwood CCfineroot</span>
<span class="co">## T1_148 0.01210607 6.849315e-05 0.0009610199 1.5905      1.47        1.3</span>
<span class="co">## T2_168 0.01757808 6.849315e-05 0.0072846640 1.4300      1.47        1.3</span>
<span class="co">## S1_165 0.02647746 6.849315e-05 0.0072846640 1.5320      1.47        1.3</span>
<span class="co">##        RGRleafmax RGRsapwoodmax RGRfinerootmax    SRsapwood  SRfineroot fHDmin</span>
<span class="co">## T1_148       0.03         0.005            0.1 0.0001261398 0.001897231     40</span>
<span class="co">## T2_168       0.03         0.005            0.1 0.0001261398 0.001897231     40</span>
<span class="co">## S1_165       0.03         0.005            0.1 0.0001261398 0.001897231     NA</span>
<span class="co">##        fHDmax     WoodC</span>
<span class="co">## T1_148    130 0.4979943</span>
<span class="co">## T2_168    100 0.4740096</span>
<span class="co">## S1_165     NA 0.4749178</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">paramsAllometries</span></code></pre></div>
<pre><code><span class="co">##             Aash     Bash      Absh      Bbsh     Acr   B1cr     B2cr</span>
<span class="co">## T1_148 5.8458000 1.494400 0.3596000 0.7138000 1.99500 -0.649 -0.02000</span>
<span class="co">## T2_168 1.8574862 1.885548 0.5238830 0.7337293 1.98539 -0.552 -0.01386</span>
<span class="co">## S1_165 0.1305509 2.408443 0.5147731 0.5311554 1.50600 -0.706 -0.07800</span>
<span class="co">##                B3cr     C1cr     C2cr       Acw    Bcw</span>
<span class="co">## T1_148 -0.000120000 -0.00400 -0.15900 0.6415296 0.7310</span>
<span class="co">## T2_168 -0.000110736 -0.00685 -0.20101 0.5681897 0.7974</span>
<span class="co">## S1_165  0.000180000 -0.00700  0.00000 0.8390000 0.7350</span></code></pre>
<p>Finally, elements starting with <code>internal*</code> contain state variables required to keep track of plant status. For example, the carbon storage levels can be seen in <code>internalCarbon</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">internalCarbon</span></code></pre></div>
<pre><code><span class="co">##        sugarLeaf starchLeaf sugarSapwood starchSapwood</span>
<span class="co">## T1_148 0.4029239 0.00925123    0.5738487      3.231261</span>
<span class="co">## T2_168 0.3585751 0.00925123    1.0741383      3.230196</span>
<span class="co">## S1_165 0.7223526 0.00925123    0.2857655      3.383669</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="executing-the-growth-model">Executing the growth model<a class="anchor" aria-label="anchor" href="#executing-the-growth-model"></a>
</h2>
<p>In this vignette we will use one year of example meteorological data with the following precipitation and temperature seasonal trends:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">G1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/growth.html">growth</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">examplemeteo</span>, latitude <span class="op">=</span> <span class="fl">41.82592</span>, elevation <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Initial plant cohort biomass (g/m2): 8551.44</span>
<span class="co">## Initial soil water content (mm): 291.257</span>
<span class="co">## Initial snowpack content (mm): 0</span>
<span class="co">## Performing daily simulations</span>
<span class="co">## </span>
<span class="co">##  [Year 2001]: ....................................</span>
<span class="co">## </span>
<span class="co">## Final plant biomass (g/m2): 8717.41</span>
<span class="co">## Change in plant biomass (g/m2): 165.967</span>
<span class="co">## Plant biomass balance result (g/m2): 165.967</span>
<span class="co">## Plant biomass balance components:</span>
<span class="co">##   Structural balance (g/m2) 264 Labile balance (g/m2) -98</span>
<span class="co">##   Plant individual balance (g/m2) 166 Mortality loss (g/m2) 0</span>
<span class="co">## Final soil water content (mm): 269.256</span>
<span class="co">## Final snowpack content (mm): 0</span>
<span class="co">## Change in soil water content (mm): -22.0006</span>
<span class="co">## Soil water balance result (mm): -22.0006</span>
<span class="co">## Change in snowpack water content (mm): 0</span>
<span class="co">## Snowpack water balance result (mm): 0</span>
<span class="co">## Water balance components:</span>
<span class="co">##   Precipitation (mm) 513</span>
<span class="co">##   Rain (mm) 462 Snow (mm) 51</span>
<span class="co">##   Interception (mm) 97 Net rainfall (mm) 365</span>
<span class="co">##   Infiltration (mm) 407 Runoff (mm) 9 Deep drainage (mm) 76</span>
<span class="co">##   Soil evaporation (mm) 28 Transpiration (mm) 325</span></code></pre>
<p>While water/carbon balances and growth of leaf/sapwood/root tissues is performed on a daily basis, structural variables are only updated once a year, here coinciding with the end of the simulation.</p>
</div>
<div class="section level2">
<h2 id="plotting-results">Plotting results<a class="anchor" aria-label="anchor" href="#plotting-results"></a>
</h2>
<p>In addition to all the plots that were available for result of simulations with function <code><a href="../reference/spwb.html">spwb()</a></code>, one can display the following information out of the output of function <code><a href="../reference/growth.html">growth()</a></code>:</p>
<div class="section level3">
<h3 id="carbon-balance-components">Carbon balance components<a class="anchor" aria-label="anchor" href="#carbon-balance-components"></a>
</h3>
<p>To inspect components of the plant carbon balance we can first display gross photosynthesis expressed as assimilation relative to biomass:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"GrossPhotosynthesis"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-16-1.png" width="672"> Then we can draw the respiration costs (maintenance and growth) in the same units:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"MaintenanceRespiration"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"GrowthCosts"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-17-2.png" width="672"> Finally we can display the daily negative or positive balance of the plant storage, which determines changes in plant carbon pools:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"LabileCarbonBalance"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="carbon-storage">Carbon storage<a class="anchor" aria-label="anchor" href="#carbon-storage"></a>
</h3>
<p>Carbon assimilation and respiration rates define the dynamics of stored carbon, which in medfate is divided into two organs (leaves and sapwood) and two chemical compounds (soluble sugars and starch). The most important storage compartment is sapwood starch, whose dynamics can be shown using:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"StarchSapwood"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="leaf-and-sapwood-area-changes">Leaf and sapwood area changes<a class="anchor" aria-label="anchor" href="#leaf-and-sapwood-area-changes"></a>
</h3>
<p>Leaf and sapwood area dynamics arising from the interplay between growth and senescence of tissues can be inspected using:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"LeafArea"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"SapwoodArea"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-20-2.png" width="672"> The corresponding daily growth rates can also be displayed:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"LAgrowth"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"SAgrowth"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-21-2.png" width="672"></p>
<p>We can also display the resulting dynamics in diameter at breast height (DBH):</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"DBH"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 365 row(s) containing missing values (geom_path).</span></code></pre>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>Finally, recall that one can interactively create plots using function <code>shinyplot</code>, e.g.:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/shinyplot.html">shinyplot</a></span><span class="op">(</span><span class="va">G1</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

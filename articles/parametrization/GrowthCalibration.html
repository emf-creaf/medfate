<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibration of growth and senescence parameters • medfate</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Calibration of growth and senescence parameters">
<meta name="description" content="Description of a calibration procedure used for growth and senescence parameters
">
<meta property="og:description" content="Description of a calibration procedure used for growth and senescence parameters
">
<meta property="og:image" content="https://emf-creaf.github.io/medfate/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">medfate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../../articles/intro/PackageOverview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../../articles/intro/UnderstandingInputs.html">Understanding model inputs</a></li>
    <li><a class="dropdown-item" href="../../articles/intro/PreparingInputs.html">Preparing model inputs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Running simulations</h6></li>
    <li><a class="dropdown-item" href="../../articles/runmodels/BasicWaterBalance.html">Basic water balance</a></li>
    <li><a class="dropdown-item" href="../../articles/runmodels/AdvancedWaterEnergyBalance.html">Advanced water and energy balance</a></li>
    <li><a class="dropdown-item" href="../../articles/runmodels/ForestGrowth.html">Forest growth</a></li>
    <li><a class="dropdown-item" href="../../articles/runmodels/ForestDynamics.html">Forest dynamics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/medfate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="GrowthCalibration_files/kePrint-0.0.1/kePrint.js"></script><link href="GrowthCalibration_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Calibration of growth and senescence parameters</h1>
                        <h4 data-toc-skip class="author">Miquel De
Cáceres</h4>
            
            <h4 data-toc-skip class="date">2024-09-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/vignettes/parametrization/GrowthCalibration.Rmd" class="external-link"><code>vignettes/parametrization/GrowthCalibration.Rmd</code></a></small>
      <div class="d-none name"><code>GrowthCalibration.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="goals">Goals<a class="anchor" aria-label="anchor" href="#goals"></a>
</h3>
<p>The growth model included in <strong>medfate</strong> implements
processes regulating plant carbon balance and growth. Species-level
parameter values for these processes are obtained from: (a) global
functional trait databases; (b) meta-modelling exercises; (c) model
calibration exercises. The main goal of the current exercise is to
obtain suitable values (via model calibration) for parameters related
with the maintenance respiration costs, formation rates and senescence
rates of sapwood, because these are difficult to obtain using other
means. At the same time, the exercise provides information on the
performance of the model to predict secondary growth at the tree and
stand levels.</p>
</div>
<div class="section level3">
<h3 id="observational-data">Observational data<a class="anchor" aria-label="anchor" href="#observational-data"></a>
</h3>
<p>The calibration data set corresponds to 75 permanent forest plots of
the Spanish National Forest Inventory located in Catalonia. Forest plots
correspond to pure stands whose dominant species are <em>Fagus
sylvatica</em>, <em>Pinus halepensis</em>, <em>Pinus nigra</em>,
<em>Pinus sylvestris</em> or <em>Quercus pubescens</em>. There are 15
plots per each dominant species and each set of 15 plots encompass a
range of climatic aridity. Plot characteristics are described in Rosas
et al. (2019). Dendrochronological series are available for up to 6
trees per plot and were sampled in December 2015. Note that a sixth
species (<em>Quercus ilex</em>) was included in Rosas et al (2019), but
dendrochronological dating is not available.</p>
</div>
<div class="section level3">
<h3 id="target-parameters-for-calibration">Target parameters for calibration<a class="anchor" aria-label="anchor" href="#target-parameters-for-calibration"></a>
</h3>
<p>The model parameters for which we desired good estimates are:</p>
<ol style="list-style-type: lower-alpha">
<li>
<strong>Sapwood daily respiration rate (RERsapwood)</strong> - Used
to modulate maintenance respiration demands of living sapwood tissues
(parenchyma, cambium, phloem, etc.), which in large trees may also
represent a large fraction of maintenance respiration.</li>
<li>
<strong>Sapwood maximum growth rate (RGRcambiummax)</strong> - Used
to modulate tree maximum daily sapwood growth rates (relative to current
cambium perimeter). Actual relative growth rates include temperature and
sink limitations to growth.</li>
<li>
<strong>Sapwood daily senescence rate (SRsapwood)</strong> - Used to
determine the daily proportion of sapwood that becomes heartwood. It
regulates the area of functional sapwood, together with the sapwood
maximum growth rate.</li>
</ol>
<p>In addition, soil stoniness in the target plots had been estimated
from surface stoniness classes. Since soil rock fragment content
(<code>rfc</code>) has a strong influence on soil water capacity, we
decided to include the proportion of rocks in the second soil layer
(between 30 and 100 cm) as a parameter to be calibrated.</p>
</div>
</div>
<div class="section level2">
<h2 id="calibration-procedure">Calibration procedure<a class="anchor" aria-label="anchor" href="#calibration-procedure"></a>
</h2>
<p>For each forest plot in the first data set, we matched each available
dendrochronological series with a forest inventory tree cohort by
finding which tree (in the IFN3 sampling) had the DBH most similar to
that estimated from the dendrochronology at year 2000. Then, we took the
series of annual basal area increments (BAI) as the observations to be
matched by model secondary growth predictions for the matched tree
cohort. For each forest plot of the second data set, we took all
available dendrochronological series between 1990 and 2004. Available
diameter increments (DI) were used to infer DBH at year 1990 and we
transformed DI into annual BAI.</p>
<p>Simulations were performed using daily weather data for each target
plot, obtained via interpolation using package
<strong>meteoland</strong> (2001 - 2015 period or 1990-2004 period,
depending on the data set), and soil physical characteristics where
drawn from SoilGrids data base. Transpiration and photosynthesis
parameters were given values resulting from the <a href="https://emf-creaf.github.io/medfate/articles/parametrization/Metamodelling.html">meta-modelling
exercise</a>, whereas other parameters of the sensitivity analysis were
left to the species-level defaults of <code>SpParamsMED</code>. We
calibrated the four target parameters for the target dominant species of
the target plot using a genetic algorithm (function <code>ga</code> from
package <strong>GA</strong>). Model parameter values were assumed to be
the same for all cohorts of the target species, while the remaining
species in the plot were given default constant parameter values. The
objective function for the genetic algorithm was the average, across
cohorts with observed dendrochronology series, of the mean absolute
error (MAE) resulting from comparing observed and predicted annual BAI
series. Population size for the genetic algorithm was set to 40
individuals. A maximum of 25 iterations of the genetic algorithm were
allowed, and the calibration procedure stopped if the best parameter
combination did not change during 5 consecutive iterations.</p>
The following table shows the range of values explored for each
parameter to be calibrated:
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Minimum
</th>
<th style="text-align:right;">
Maximum
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
RERsapwood
</td>
<td style="text-align:right;">
1.0e-06
</td>
<td style="text-align:right;">
1.0e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
RGRcambiummax
</td>
<td style="text-align:right;">
1.0e-04
</td>
<td style="text-align:right;">
2.0e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
SRsapwood
</td>
<td style="text-align:right;">
1.0e-05
</td>
<td style="text-align:right;">
2.5e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="mailto:rfc@2" class="email">rfc@2</a>
</td>
<td style="text-align:right;">
2.5e+01
</td>
<td style="text-align:right;">
9.5e+01
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="calibration-results">Calibration results<a class="anchor" aria-label="anchor" href="#calibration-results"></a>
</h2>
<div class="section level3">
<h3 id="error-function">Error function<a class="anchor" aria-label="anchor" href="#error-function"></a>
</h3>
<p>The following panel shows the distribution of the final (optimum)
values of the error function (average relative MAE) by dominant
species:</p>
<p><img src="GrowthCalibration_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="parameter-distribution-and-covariance">Parameter distribution and covariance<a class="anchor" aria-label="anchor" href="#parameter-distribution-and-covariance"></a>
</h3>
<p>The following panels show the distribution of calibrated parameter
values by species (gray dashed lines indicate the parameter value limits
used in the calibration procedure):</p>
<p><img src="GrowthCalibration_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>The following table shows mean error and parameter values by species
and overall means:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
value_cal
</th>
<th style="text-align:right;">
RERsapwood_cal
</th>
<th style="text-align:right;">
RGRcambiummax_cal
</th>
<th style="text-align:right;">
SRsapwood_cal
</th>
<th style="text-align:right;">
rfc_cal
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Fagus sylvatica
</td>
<td style="text-align:right;">
43.95563
</td>
<td style="text-align:right;">
5.11e-05
</td>
<td style="text-align:right;">
0.0028215
</td>
<td style="text-align:right;">
0.0001262
</td>
<td style="text-align:right;">
47.72419
</td>
</tr>
<tr>
<td style="text-align:left;">
Pinus halepensis
</td>
<td style="text-align:right;">
46.25125
</td>
<td style="text-align:right;">
5.51e-05
</td>
<td style="text-align:right;">
0.0022197
</td>
<td style="text-align:right;">
0.0001026
</td>
<td style="text-align:right;">
56.32354
</td>
</tr>
<tr>
<td style="text-align:left;">
Pinus nigra
</td>
<td style="text-align:right;">
41.97312
</td>
<td style="text-align:right;">
4.18e-05
</td>
<td style="text-align:right;">
0.0017254
</td>
<td style="text-align:right;">
0.0001391
</td>
<td style="text-align:right;">
72.48055
</td>
</tr>
<tr>
<td style="text-align:left;">
Pinus sylvestris
</td>
<td style="text-align:right;">
40.50649
</td>
<td style="text-align:right;">
6.05e-05
</td>
<td style="text-align:right;">
0.0023457
</td>
<td style="text-align:right;">
0.0001416
</td>
<td style="text-align:right;">
72.13271
</td>
</tr>
<tr>
<td style="text-align:left;">
Quercus pubescens
</td>
<td style="text-align:right;">
39.70155
</td>
<td style="text-align:right;">
4.88e-05
</td>
<td style="text-align:right;">
0.0015056
</td>
<td style="text-align:right;">
0.0001644
</td>
<td style="text-align:right;">
54.51127
</td>
</tr>
<tr>
<td style="text-align:left;">
All
</td>
<td style="text-align:right;">
42.47761
</td>
<td style="text-align:right;">
5.15e-05
</td>
<td style="text-align:right;">
0.0021236
</td>
<td style="text-align:right;">
0.0001348
</td>
<td style="text-align:right;">
60.63445
</td>
</tr>
</tbody>
</table>
<p>Statistically significant differences can be observed between species
for <code>RERsapwood</code> and <code>RGRcambiummax</code>, as shown in
the following ANOVA tables:</p>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: RERsapwood_cal</span></span>
<span><span class="co">##           Df     Sum Sq    Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">## Species    4 2.9480e-09 7.3699e-10  1.3127 0.2738</span></span>
<span><span class="co">## Residuals 70 3.9301e-08 5.6144e-10</span></span></code></pre>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: RGRcambiummax_cal</span></span>
<span><span class="co">##           Df     Sum Sq    Mean Sq F value  Pr(&gt;F)  </span></span>
<span><span class="co">## Species    4 1.6290e-05 4.0726e-06  3.1039 0.02068 *</span></span>
<span><span class="co">## Residuals 70 9.1846e-05 1.3121e-06                  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: SRsapwood_cal</span></span>
<span><span class="co">##           Df     Sum Sq    Mean Sq F value  Pr(&gt;F)  </span></span>
<span><span class="co">## Species    4 3.0774e-08 7.6935e-09  2.3528 0.06226 .</span></span>
<span><span class="co">## Residuals 70 2.2890e-07 3.2700e-09                  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: rfc_cal</span></span>
<span><span class="co">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## Species    4  7429.4 1857.34  5.6629 0.0005235 ***</span></span>
<span><span class="co">## Residuals 70 22959.0  327.99                      </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>Finally, the following panels illustrate the overall lack of
covariance between calibrated parameter values:</p>
<pre><code><span><span class="co">## Warning in get_plot_component(plot, "guide-box"): Multiple components found;</span></span>
<span><span class="co">## returning the first one. To return all, use `return_all = TRUE`.</span></span></code></pre>
<p><img src="GrowthCalibration_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-of-the-basic-and-advanced-sub-models">Comparison of the basic and advanced sub-models<a class="anchor" aria-label="anchor" href="#comparison-of-the-basic-and-advanced-sub-models"></a>
</h2>
<p>Since the calibration exercise had been conducted using the basic
sub-model, it is expected that growth simulations with the advanced
sub-model have larger error rates and, potentially, larger bias. To
check this, we repeated growth simulations using the calibrated
parameters for each plot and the advanced sub-model.</p>
<p>The following figures show the bias and mean absolute error of annual
basal area increments obtained in simulations using the basic and
advanced sub-models, in both cases using the calibrated parameters.</p>
<p><img src="GrowthCalibration_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li>Batllori, E., J. M. Blanco-Moreno, J. M. Ninot, E. Gutiérrez, and E.
Carrillo. 2009. Vegetation patterns at the alpine treeline ecotone: the
influence of tree cover on abrupt change in species composition of
alpine communities. Journal of Vegetation Science 20:814–825.</li>
<li>Batllori, E., and E. Gutiérrez. 2008. Regional tree line dynamics in
response to global change in the Pyrenees. Journal of Ecology
96:1275–1288.</li>
<li>Rosas, T., M. Mencuccini, J. Barba, H. Cochard, S. Saura-Mas, and J.
Martínez-Vilalta. 2019. Adjustments and coordination of hydraulic, leaf
and stem traits along a water availability gradient. New Phytologist
223:632–646.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Initial species parameter table for Spain • medfate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Initial species parameter table for Spain">
<meta property="og:description" content="medfate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../articles/index.html">Articles</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/emf-creaf/medfate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Initial species parameter table for Spain</h1>
                        <h4 data-toc-skip class="author">Miquel De
Cáceres</h4>
            
            <h4 data-toc-skip class="date">2023-04-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/vignettes/parametrization/SpeciesParameterizationSpain.Rmd" class="external-link"><code>vignettes/parametrization/SpeciesParameterizationSpain.Rmd</code></a></small>
      <div class="hidden name"><code>SpeciesParameterizationSpain.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes the procedures used to obtain the initial
species parameter data table that serves to obtain the data frame
<code>SpParamsMED</code> included in package <strong>medfate</strong>.
The taxon entities chosen are intended to cover most of the woody plant
taxa in Spain, as they are reported in the Spanish National Forest
Inventory surveys (<em>Inventario Forestal Nacional</em> or IFN). In
addition, a list of <code>forest</code> objects is also created for each
of three IFN surveys, where species codification follows the parameter
data table.</p>
<blockquote>
<p><strong>IMPORTANT</strong>: The vignette is not self-contained, in
the sense that it cannot be reproduced without access to data sets that
are not included. Nevertheless, it is intended to serve as example of
species parameterization for other regions.</p>
</blockquote>
<div class="section level3">
<h3 id="required-packages">Required packages`<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<p>Installed version of <strong>medfate</strong> should be <strong>ver
2.9</strong> or higher.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"medfate"</span><span class="op">)</span></span></code></pre></div>
<p>If the version at CRAN is older, the package should be installed from
GitHub via <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">remotes::install_github()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"emf-creaf/medfate"</span><span class="op">)</span></span></code></pre></div>
<p>Package <strong>medfateutils</strong> is required for the species
parameterization process, as it includes several functions that
facilitate parsing data sources into parameter values. Package
<strong>medfateutils</strong> is installed only from GitHub:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"emf-creaf/medfateutils"</span><span class="op">)</span></span></code></pre></div>
<p>Package <strong>medfuels</strong> is also needed because it includes
allometric coefficients for Mediterranean shrub species. As before,
package <strong>medfuels</strong> is installed only from GitHub:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"spif-ctfc/medfuels"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we need <strong>IFNread</strong> is also needed in this
vignette to perform some operations on IFN data. As before, package
<strong>IFNread</strong> is installed only from GitHub:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"emf-creaf/IFNread"</span><span class="op">)</span></span></code></pre></div>
<p>Once we have <strong>medfate</strong>, <strong>medfateutils</strong>,
<strong>medfuels</strong> and <strong>IFNread</strong>, we load them and
other common packages that we will employ in this vignette:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/medfate/" class="external-link">medfate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">medfateutils</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">medfuels</span><span class="op">)</span></span>
<span><span class="co"># library(IFNread)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html" class="external-link">openxlsx</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="target-parameters">Target parameters<a class="anchor" aria-label="anchor" href="#target-parameters"></a>
</h3>
<p>The set of species parameters needed to run the models included in
<strong>medfate</strong> are described in a dataframe called
<code>SpParamsDefinition</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SpParamsDefinition"</span><span class="op">)</span></span>
<span><span class="va">SpParamsDefinition</span><span class="op">$</span><span class="va">ParameterName</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] "Name"                  "SpIndex"               "Genus"                </span></span>
<span><span class="co">##   [4] "Order"                 "Family"                "Group"                </span></span>
<span><span class="co">##   [7] "GrowthForm"            "LifeForm"              "LeafShape"            </span></span>
<span><span class="co">##  [10] "LeafSize"              "PhenologyType"         "Hmed"                 </span></span>
<span><span class="co">##  [13] "Hmax"                  "Z50"                   "Z95"                  </span></span>
<span><span class="co">##  [16] "fHDmin"                "fHDmax"                "a_ash"                </span></span>
<span><span class="co">##  [19] "b_ash"                 "a_bsh"                 "b_bsh"                </span></span>
<span><span class="co">##  [22] "a_btsh"                "b_btsh"                "cr"                   </span></span>
<span><span class="co">##  [25] "a_fbt"                 "b_fbt"                 "c_fbt"                </span></span>
<span><span class="co">##  [28] "a_cr"                  "b_1cr"                 "b_2cr"                </span></span>
<span><span class="co">##  [31] "b_3cr"                 "c_1cr"                 "c_2cr"                </span></span>
<span><span class="co">##  [34] "a_cw"                  "b_cw"                  "LeafDuration"         </span></span>
<span><span class="co">##  [37] "t0gdd"                 "Sgdd"                  "Tbgdd"                </span></span>
<span><span class="co">##  [40] "Ssen"                  "Phsen"                 "Tbsen"                </span></span>
<span><span class="co">##  [43] "xsen"                  "ysen"                  "SLA"                  </span></span>
<span><span class="co">##  [46] "LeafDensity"           "WoodDensity"           "FineRootDensity"      </span></span>
<span><span class="co">##  [49] "conduit2sapwood"       "r635"                  "pDead"                </span></span>
<span><span class="co">##  [52] "Al2As"                 "Ar2Al"                 "LeafWidth"            </span></span>
<span><span class="co">##  [55] "SRL"                   "RLD"                   "maxFMC"               </span></span>
<span><span class="co">##  [58] "minFMC"                "LeafPI0"               "LeafEPS"              </span></span>
<span><span class="co">##  [61] "LeafAF"                "StemPI0"               "StemEPS"              </span></span>
<span><span class="co">##  [64] "StemAF"                "SAV"                   "HeatContent"          </span></span>
<span><span class="co">##  [67] "LigninPercent"         "gammaSWR"              "alphaSWR"             </span></span>
<span><span class="co">##  [70] "kPAR"                  "g"                     "Tmax_LAI"             </span></span>
<span><span class="co">##  [73] "Tmax_LAIsq"            "Psi_Extract"           "Exp_Extract"          </span></span>
<span><span class="co">##  [76] "WUE"                   "WUE_par"               "WUE_co2"              </span></span>
<span><span class="co">##  [79] "WUE_vpd"               "Gswmin"                "Gswmax"               </span></span>
<span><span class="co">##  [82] "VCleaf_kmax"           "VCleaf_c"              "VCleaf_d"             </span></span>
<span><span class="co">##  [85] "Kmax_stemxylem"        "VCstem_c"              "VCstem_d"             </span></span>
<span><span class="co">##  [88] "Kmax_rootxylem"        "VCroot_c"              "VCroot_d"             </span></span>
<span><span class="co">##  [91] "Vmax298"               "Jmax298"               "Nleaf"                </span></span>
<span><span class="co">##  [94] "Nsapwood"              "Nfineroot"             "WoodC"                </span></span>
<span><span class="co">##  [97] "RERleaf"               "RERsapwood"            "RERfineroot"          </span></span>
<span><span class="co">## [100] "CCleaf"                "CCsapwood"             "CCfineroot"           </span></span>
<span><span class="co">## [103] "RGRleafmax"            "RGRsapwoodmax"         "RGRcambiummax"        </span></span>
<span><span class="co">## [106] "RGRfinerootmax"        "SRsapwood"             "SRfineroot"           </span></span>
<span><span class="co">## [109] "RSSG"                  "MortalityBaselineRate" "SeedProductionHeight" </span></span>
<span><span class="co">## [112] "ProbRecr"              "MinTempRecr"           "MinMoistureRecr"      </span></span>
<span><span class="co">## [115] "MinFPARRecr"           "RecrTreeDBH"           "RecrTreeHeight"       </span></span>
<span><span class="co">## [118] "RecrShrubHeight"       "RecrTreeDensity"       "RecrShrubCover"       </span></span>
<span><span class="co">## [121] "RecrZ50"               "RecrZ95"               "RespFire"             </span></span>
<span><span class="co">## [124] "RespDist"              "RespClip"</span></span></code></pre>
<p>It is obvious that such a sheer number of parameters cannot be
searched for manually, even for a small number of target species. Hence,
it is important to draw values from allometric and plant trait data
bases. Not all model parameters have their counterpart in
publicly-available databases, and even when using data bases it is
unlikely that one will find appropriate parameter values for all
species. To help with this situation, <strong>medfate</strong> has
<em>inbuilt imputation procedures</em> to estimate missing values for
many parameters before starting model simulations. However, imputed
parameter estimates will normally be worse than estimates coming from
data bases. Hence, we should put a strong effort in finding source
parameter data before relying on inbuilt imputation.</p>
</div>
<div class="section level3">
<h3 id="steps-to-build-a-species-parameter-table">Steps to build a species parameter table<a class="anchor" aria-label="anchor" href="#steps-to-build-a-species-parameter-table"></a>
</h3>
<p>The following sections describe different steps that we used to
obtain the species parameter table, which can be grouped into five main
tasks:</p>
<ol style="list-style-type: decimal">
<li>Initialize the parameter table with target taxonomic entities.</li>
<li>Draw species parameters from forest inventory (IFN in our case)
data.</li>
<li>Populate tree and shrub allometric coefficients from suitable
allometric databases.</li>
<li>Populate plant functional traits from available data bases</li>
</ol>
</div>
<div class="section level3">
<h3 id="source-data-paths">Source data paths<a class="anchor" aria-label="anchor" href="#source-data-paths"></a>
</h3>
<p>Before starting, we define file paths (in my computer) to access
source data for parameter filling. Source data includes forest inventory
(i.e. IFN) data as well as plant trait and allometric data bases:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IFN_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/EMF_datasets/ForestInventories/IFN/"</span></span>
<span><span class="va">IFN_out_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/mcaceres_work/model_initialisation/MEDFATE_Initialisation/IFN/"</span></span>
<span><span class="va">DB_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/mcaceres_work/model_development/medfate_development/MedfateSpeciesParametrization/"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="initialize-species-parameter-table-for-ifn">Initialize species parameter table for IFN<a class="anchor" aria-label="anchor" href="#initialize-species-parameter-table-for-ifn"></a>
</h2>
<p>The first task is to define the target entities that will be
considered functionally distinct in <strong>medfate</strong>
simulations. There is no <em>a priori</em> need to limit such entities
to biological taxa, nor to particular taxonomic ranks. In our case, we
take the species mapping defined in package
<strong>medfateutils</strong> for Spanish IFN:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IFN_species_mapping</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">IFN_species_mapping</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  Name      Codes</span></span>
<span><span class="co">## 1          Abies alba         31</span></span>
<span><span class="co">## 2       Abies pinsapo         32</span></span>
<span><span class="co">## 3         Acacia spp.  7/207/307</span></span>
<span><span class="co">## 4      Acer campestre 76/776/976</span></span>
<span><span class="co">## 5 Acer monspessulanum        276</span></span>
<span><span class="co">## 6        Acer negundo        376</span></span></code></pre>
<p>Once we have IFN species names and codes, as well as the definition
of the IFN biological entities to merge, we can call function
<code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html" class="external-link">initSpParams()</a></code> from package <strong>medfateutils</strong>.
This function also takes the data frame <code>SpParamsDefinition</code>
as argument, from which it takes the set of parameter names to be
filled:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html" class="external-link">initSpParams</a></span><span class="op">(</span>sp_names <span class="op">=</span> <span class="va">IFN_species_mapping</span><span class="op">$</span><span class="va">Name</span>,</span>
<span>                        <span class="va">SpParamsDefinition</span>,</span>
<span>                        fill_taxonomic <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Option <code>fill_taxonomic</code> tells function
<code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html" class="external-link">initSpParams()</a></code> to use package <strong>taxize</strong> to
find taxonomic classification of the species/genus entities. This
provides very useful information for parameterization, but makes the
process of initialization a bit slower.</p>
<p>The result of calling <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html" class="external-link">initSpParams()</a></code> is a data frame
with <code>nrow(SpParams)</code> rows corresponding to target entities
and columns corresponding to the parameters defined in
<code>SpParamsDefinition</code>. Most parameters are missing, obviously,
but <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html" class="external-link">initSpParams()</a></code> already filled taxonomic data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  Name SpIndex  Genus      Order      Family      Group</span></span>
<span><span class="co">## 1          Abies alba       0  Abies    Pinales    Pinaceae Gymnosperm</span></span>
<span><span class="co">## 2       Abies pinsapo       1  Abies    Pinales    Pinaceae Gymnosperm</span></span>
<span><span class="co">## 3         Acacia spp.       2 Acacia    Fabales    Fabaceae Angiosperm</span></span>
<span><span class="co">## 4      Acer campestre       3   Acer Sapindales Sapindaceae Angiosperm</span></span>
<span><span class="co">## 5 Acer monspessulanum       4   Acer Sapindales Sapindaceae Angiosperm</span></span>
<span><span class="co">## 6        Acer negundo       5   Acer Sapindales Sapindaceae Angiosperm</span></span>
<span><span class="co">##   GrowthForm</span></span>
<span><span class="co">## 1         NA</span></span>
<span><span class="co">## 2         NA</span></span>
<span><span class="co">## 3         NA</span></span>
<span><span class="co">## 4         NA</span></span>
<span><span class="co">## 5         NA</span></span>
<span><span class="co">## 6         NA</span></span></code></pre>
<!-- ## Parameters drawn from IFN data -->
<!-- Some plant size parameters, such as maximum height or minimum/maximum values of the height-to-diameter ratio, can be derived from forest inventory data. In addition, it is important that medfate's parameter `GrowthForm` (either "Tree", "Tree/Shrub" or "Shrub") matches the treatment given in forest inventory surveys. Diameters are normally measured in "Tree" entities, whereas shrubs are often measured using cover indices, and some species may be recorded in either way. Thus, the `GrowthForm` parameter should also be derived from forest inventory. -->
<!-- ### Load IFN plot data -->
<!-- We first load IFN tree and shrub data corresponding to the three surveys (tree data is in two different tables in the case of IFN2):  -->
<!-- ```{r load_ifn} -->
<!-- shrubDataIFN2 <-readRDS(paste0(IFN_path,"Products/IFN2/Rdata/shrubDataIFN2_Spain.rds")) -->
<!-- shrubDataIFN2$ID<-as.character(shrubDataIFN2$ID) -->
<!-- shrubDataIFN3 <-readRDS(paste0(IFN_path,"Products/IFN3/Rdata/shrubDataIFN3_Spain.rds")) -->
<!-- shrubDataIFN4 <-readRDS(paste0(IFN_path,"Products/IFN4/Rdata/shrubDataIFN4_Spain.rds")) -->
<!-- piesMayoresDataIFN2<-readRDS(paste0(IFN_path,"Products/IFN2/Rdata/piesMayoresDataIFN2_Spain.rds")) -->
<!-- piesMenoresDataIFN2<-readRDS(paste0(IFN_path,"Products/IFN2/Rdata/piesMenoresDataIFN2_Spain.rds")) -->
<!-- piesMenoresDataIFN2$ID = as.character(piesMenoresDataIFN2$ID) -->
<!-- piesMenoresDataIFN2$Species = as.character(piesMenoresDataIFN2$Species) -->
<!-- treeDataIFN2 = rbind(piesMayoresDataIFN2, piesMenoresDataIFN2) # Add pies menores -->
<!-- treeDataIFN3<-readRDS(paste0(IFN_path,"Products/IFN3/Rdata/treeDataIFN3_Spain.rds")) -->
<!-- treeDataIFN3 = treeDataIFN3[!(treeDataIFN3$OIF3 %in% c("888","999")),] # remove dead trees -->
<!-- regDataIFN3 = readRDS(paste0(IFN_path,"Products/IFN3/Rdata/regDataIFN3_Spain.rds")) -->
<!-- regTreeDataIFN3 = IFNread::extractRegTreeData(regDataIFN3, subsetVars=T) -->
<!-- treeDataIFN3 = rbind(treeDataIFN3[,c("ID","Species","DBH","H","N")], -->
<!--                      regTreeDataIFN3[,c("ID","Species","DBH","H","N")]) -->
<!-- treeDataIFN4<-readRDS(paste0(IFN_path,"Products/IFN4/Rdata/treeDataIFN4_Spain.rds")) -->
<!-- treeDataIFN4 = treeDataIFN4[!(treeDataIFN4$OIF4 %in% c("888","999")),] # remove dead trees -->
<!-- regDataIFN4 = readRDS(paste0(IFN_path,"Products/IFN4/Rdata/regDataIFN4_Spain.rds")) -->
<!-- regTreeDataIFN4 = IFNread::extractRegTreeData(regDataIFN4, subsetVars=T) -->
<!-- treeDataIFN4 = rbind(treeDataIFN4[,c("ID","Species","DBH","H","N")], -->
<!--                      regTreeDataIFN4[,c("ID","Species","DBH","H","N")]) -->
<!-- ``` -->
<!-- ### Merge IFN data -->
<!-- We merge the data sets into two tables, one for shrubs and the other for trees, taking only columns `ID` (plot identification), `Species` (code), `H` (height) and `DBH` (for trees). -->
<!-- ```{r merge_ifn} -->
<!-- shrubDataIFN <-bind_rows(shrubDataIFN2[,c("ID","Species", "H")], -->
<!--                          shrubDataIFN3[,c("ID","Species", "H")], -->
<!--                          shrubDataIFN4[,c("ID","Species", "H")]) -->
<!-- treeDataIFN <-bind_rows(treeDataIFN2[,c("ID","Species", "H", "DBH")], -->
<!--                         treeDataIFN3[,c("ID","Species", "H", "DBH")], -->
<!--                         treeDataIFN4[,c("ID","Species", "H", "DBH")]) -->
<!-- ``` -->
<!-- ### Growth form -->
<!-- To tell **medfate** which target entities are shrubs, trees (or both, since some species occur in both tree and shrub tables), we can simply take the species code vectors: -->
<!-- ```{r growth_form} -->
<!-- shrub_codes <- as.numeric(shrubDataIFN$Species) -->
<!-- tree_codes <- as.numeric(treeDataIFN$Species) -->
<!-- ``` -->
<!-- Before populating parameter `GrowthForm`, we can check how many species appear both as trees and shrubs: -->
<!-- ```{r} -->
<!-- sum(unique(shrub_codes) %in% unique(tree_codes)) -->
<!-- ``` -->
<!-- We can populate column `GrowthForm` of the species parameter table by calling function `populateGrowthForm()` of package **medfateutils**: -->
<!-- ```{r} -->
<!-- SpParams = populateGrowthForm(SpParams,  -->
<!--                               tree_codes, shrub_codes, -->
<!--                               fill_fromGenus = TRUE) -->
<!-- ``` -->
<!-- Some codes (particularly, those excluded above) may not be recognized according to the target entity definition of `SpParams` and are ignored. The option `fill_fromGenus = TRUE` was used to tell function `populateGrowthForm()` to impute growth form of species with missing value from the growth form of other species of the same genus, if homogeneous. Some species may still have missing growth form after the imputation process. We identify them: -->
<!-- ```{r} -->
<!-- missingGrowthFormSpecies = SpParams[is.na(SpParams$GrowthForm), c("Name")] -->
<!-- print(missingGrowthFormSpecies) -->
<!-- ``` -->
<!-- and manually set the growth form for them: -->
<!-- ```{r} -->
<!-- missingTrees<-c( "Dracaena drago", "Pleiomeris canariensis", "Quercus lusitanica", -->
<!--                  "Sideroxylon mirmulans")  -->
<!-- SpParams$GrowthForm[SpParams$Name %in% missingTrees] = "Tree" -->
<!-- missingShrubs<-c( "Dittrichia viscosa", "Periploca laevigata", "Withania frutescens")  -->
<!-- SpParams$GrowthForm[SpParams$Name %in% missingShrubs] = "Shrub" -->
<!-- ``` -->
<!-- We can inspect how many species were deemed "Tree", "Shrub" or "Tree/Shrub". -->
<!-- ```{r} -->
<!-- table(SpParams$GrowthForm, useNA = "ifany") -->
<!-- ``` -->
<!-- ### Maximum/median height -->
<!-- Maximum and median heights for each target entity can be obtained from observed height distributions. Thus, we define species identity and height (in cm) vectors from tree/shrub data: -->
<!-- ```{r maximum_med_height} -->
<!-- species_codes <- c(treeDataIFN$Species, shrubDataIFN$Species) -->
<!-- height_values <- c(treeDataIFN$H, shrubDataIFN$H)*100 # m to cm -->
<!-- ``` -->
<!-- and then call function `populateHeightParams()` to populate parameters `Hmax` and `Hmed`, corresponding to maximum and median heights. -->
<!-- ```{r} -->
<!-- SpParams <- populateHeightParams(SpParams, -->
<!--                                  species_codes, height_values) -->
<!-- ``` -->
<!-- By default, maximum height is defined as the 99\% quantile of the height distribution, whereas median height corresponds to the 50\% quantile.  -->
<!-- Parameters `Hmax` and `Hmed` are strict, meaning that medfate does not have inbuilt imputation procedures for them, so we must complete their columns in the parameter table. We can inspect the missing values for each growth form:  -->
<!-- ```{r} -->
<!-- table(is.na(SpParams$Hmax), SpParams$GrowthForm) -->
<!-- table(is.na(SpParams$Hmed), SpParams$GrowthForm) -->
<!-- ``` -->
<!-- and then use the species with known values for each growth from to impute species averages: -->
<!-- ```{r} -->
<!-- SpParams$Hmax[is.na(SpParams$Hmax) & SpParams$GrowthForm != "Shrub"] = round(mean(SpParams$Hmax[SpParams$GrowthForm != "Shrub"], na.rm=TRUE)) -->
<!-- SpParams$Hmax[is.na(SpParams$Hmax) & SpParams$GrowthForm == "Shrub"] = round(mean(SpParams$Hmax[SpParams$GrowthForm == "Shrub"], na.rm=TRUE)) -->
<!-- SpParams$Hmed[is.na(SpParams$Hmed) & SpParams$GrowthForm != "Shrub"] = round(mean(SpParams$Hmed[SpParams$GrowthForm != "Shrub"], na.rm=TRUE)) -->
<!-- SpParams$Hmed[is.na(SpParams$Hmed) & SpParams$GrowthForm == "Shrub"] = round(mean(SpParams$Hmed[SpParams$GrowthForm == "Shrub"], na.rm=TRUE)) -->
<!-- ``` -->
<!-- The final distribution of `Hmax` (cm) by growth form is: -->
<!-- ```{r} -->
<!-- tapply(SpParams$Hmax, SpParams$GrowthForm, summary) -->
<!-- ``` -->
<!-- and that of `Hmed` (cm) by growth form is: -->
<!-- ```{r} -->
<!-- tapply(SpParams$Hmed, SpParams$GrowthForm, summary) -->
<!-- ``` -->
<!-- ### Diameter/height ratio -->
<!-- Minimum and maximum diameter/height ratios are used in **medfate** to translate diameter growth into height growth. We first assemble three data vectors needed to populate these parameters (heights and diameters in cm): -->
<!-- ```{r HD_ratio} -->
<!-- tree_species_codes <- treeDataIFN$Species -->
<!-- tree_height_values <- treeDataIFN$H*100 # m to cm -->
<!-- tree_diameter_values <- treeDataIFN$DBH -->
<!-- ``` -->
<!-- and then call function `populateTreeDiameterHeightParams()` from package **medfateutils**: -->
<!-- ```{r} -->
<!-- sel <- (tree_diameter_values >1 & tree_diameter_values<7.5  -->
<!--         & tree_height_values >130 & tree_height_values < 2000) -->
<!-- sel[is.na(sel)] = FALSE -->
<!-- SpParams <- populateTreeDiameterHeightParams(SpParams, -->
<!--                                              tree_species_codes[sel],  -->
<!--                                              tree_height_values[sel], -->
<!--                                              tree_diameter_values[sel],  -->
<!--                                              quantile_fHDmax = 0.99) -->
<!-- ``` -->
<!-- This function fills parameters `fHDmin` and `fHDmax`, corresponding to the minimum and maximum values of the height-to-diameter ratio. The 5\% and 95\% quantile values are used for these parameters, respectively, by default.  -->
<!-- Missing values may occur after imputation:   -->
<!-- ```{r} -->
<!-- table(is.na(SpParams$fHDmin), SpParams$GrowthForm) -->
<!-- table(is.na(SpParams$fHDmax), SpParams$GrowthForm) -->
<!-- ``` -->
<!-- Since `fHDmin` and `fHDmax` are strict parameters, we use shrub and tree averages to fill the remaining cases: -->
<!-- ```{r} -->
<!-- SpParams$fHDmax[is.na(SpParams$fHDmax) & SpParams$GrowthForm != "Shrub"] = round(mean(SpParams$fHDmax, na.rm=TRUE)) -->
<!-- SpParams$fHDmin[is.na(SpParams$fHDmin) & SpParams$GrowthForm != "Shrub"] = round(mean(SpParams$fHDmin, na.rm=TRUE)) -->
<!-- ``` -->
<!-- The final distributions of `fHDmax` and `fHDmin` are: -->
<!-- ```{r} -->
<!-- summary(SpParams[SpParams$GrowthForm != "Shrub" ,c("fHDmax", "fHDmin")]) -->
<!-- ``` -->
</div>
<div class="section level2">
<h2 id="allometric-coefficients">Allometric coefficients<a class="anchor" aria-label="anchor" href="#allometric-coefficients"></a>
</h2>
<p>Allometric equations are used in <strong>medfate</strong> to provide
initial estimates of foliar biomass and leaf area of plant cohorts,
which are key variables in simulations of forest functioning.</p>
<div class="section level3">
<h3 id="shrub-allometric-equations">Shrub allometric equations<a class="anchor" aria-label="anchor" href="#shrub-allometric-equations"></a>
</h3>
<p>Shrub allometric equations in <strong>medfate</strong> are of the
form <span class="math inline">\(y = a\cdot x ^b\)</span>, with <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> being allometric coefficients. We will
draw shrub allometric coefficient from data included in package
<strong>medfuels</strong>. First, we begin by loading from this package
a data set that describes the shrub type for a number of Mediterranean
species. Shrub types in <strong>medfuels</strong> are a combination of
Raunkiaer life form and resprouting strategy. Whenever species level
coefficients will be missing, we will impute allometric coefficients
according to the shrub type specified in <strong>medfuels</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"species_groups"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  name  Genus        Species Subsp      author shrub type</span></span>
<span><span class="co">## 1          Abies alba  Abies           alba  &lt;NA&gt;       Mill.         MP</span></span>
<span><span class="co">## 2   Acacia farnesiana Acacia     farnesiana  &lt;NA&gt; (L.) Willd.         MP</span></span>
<span><span class="co">## 3      Acer campestre   Acer      campestre  &lt;NA&gt;          L.         MP</span></span>
<span><span class="co">## 4 Acer monspessulanum   Acer monspessulanum  &lt;NA&gt;          L.         MP</span></span>
<span><span class="co">## 5        Acer negundo   Acer        negundo  &lt;NA&gt;          L.         MP</span></span>
<span><span class="co">## 6         Acer opalus   Acer         opalus  &lt;NA&gt;       Mill.         MP</span></span></code></pre>
<p>Here we manually correct the name and authority of some synonyms:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia"</span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"rosmarinus"</span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Schleid."</span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia rosmarinus"</span></span>
<span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora"</span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"fruticosa"</span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"(L.) Griseb."</span></span>
<span><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora fruticosa"</span></span></code></pre></div>
<p>We will first populate allometric coefficients <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> for the relationship between height and
projected area. Allometric coefficients are in the following tables for
species:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sp_params_area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sp_params_area</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              minH maxH            a        b gamma_disp</span></span>
<span><span class="co">## Arbutus unedo           90.000000  500 6.283998e-01 1.880442  0.1594922</span></span>
<span><span class="co">## Arctostaphylos uva-ursi  7.666667   16 1.154919e+02 1.569399  0.5396529</span></span>
<span><span class="co">## Buxus sempervirens      24.000000  510 9.734499e-01 1.807175  0.3316027</span></span>
<span><span class="co">## Cistus albidus          27.000000  170 6.034537e-01 1.906005  0.2332449</span></span>
<span><span class="co">## Cistus laurifolius      40.000000  170 2.738292e-04 3.574434  0.8550142</span></span>
<span><span class="co">## Cistus monspeliensis    40.000000  168 6.996899e-02 2.364163  0.9066119</span></span>
<span><span class="co">##                                 R2</span></span>
<span><span class="co">## Arbutus unedo           0.72787509</span></span>
<span><span class="co">## Arctostaphylos uva-ursi 0.03446717</span></span>
<span><span class="co">## Buxus sempervirens      0.80308030</span></span>
<span><span class="co">## Cistus albidus          0.46454158</span></span>
<span><span class="co">## Cistus laurifolius      0.52647368</span></span>
<span><span class="co">## Cistus monspeliensis    0.25220391</span></span></code></pre>
<p>and for shrub types:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"group_params_area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">group_params_area</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     minH maxH          a        b gamma_disp        R2</span></span>
<span><span class="co">## Ch    11  135 24.5887659 1.166177  0.7793030 0.5407145</span></span>
<span><span class="co">## MP    16  510  5.8457525 1.494416  1.9963546 0.3641660</span></span>
<span><span class="co">## NPF   16  390  1.9168225 1.692854  0.8382893 0.5264243</span></span>
<span><span class="co">## NPR   12  280  3.6933876 1.684477  1.1908252 0.2582100</span></span>
<span><span class="co">## NPS   18  195  0.1375519 2.283623  0.6547104 0.4777715</span></span>
<span><span class="co">## NP    12  390  1.0082888 1.869964  1.1923015 0.4241801</span></span></code></pre>
<p>We are now ready to use function
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateShrubAllometriesFromMedfuels()</a></code> from package
<strong>medfateutils</strong>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateShrubAllometriesFromMedfuels</a></span><span class="op">(</span><span class="va">SpParams</span>, </span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a_ash"</span> <span class="op">=</span> <span class="st">"a"</span>,<span class="st">"b_ash"</span> <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span>
<span>                                             <span class="va">sp_params_area</span>, </span>
<span>                                             <span class="va">group_params_area</span>, </span>
<span>                                             <span class="va">species_groups</span><span class="op">)</span></span></code></pre></div>
<p>We can do the same for the relationship between shrub volume and
biomass of fine fuels:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sp_params_fine"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"group_params_fine"</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateShrubAllometriesFromMedfuels</a></span><span class="op">(</span><span class="va">SpParams</span>, </span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a_bsh"</span> <span class="op">=</span> <span class="st">"a"</span>,<span class="st">"b_bsh"</span> <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span>
<span>                                             <span class="va">sp_params_fine</span>, </span>
<span>                                             <span class="va">group_params_fine</span>, </span>
<span>                                             <span class="va">species_groups</span><span class="op">)</span></span></code></pre></div>
<p>and for the relationship between shrub volume and total biomass:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sp_params_total"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"group_params_total"</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateShrubAllometriesFromMedfuels</a></span><span class="op">(</span><span class="va">SpParams</span>, </span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a_btsh"</span> <span class="op">=</span> <span class="st">"a"</span>,<span class="st">"b_btsh"</span> <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span>
<span>                                             <span class="va">sp_params_total</span>, </span>
<span>                                             <span class="va">group_params_total</span>, </span>
<span>                                             <span class="va">species_groups</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shrub-crown-ratio-and-fraction-of-dead-material">Shrub crown ratio and fraction of dead material<a class="anchor" aria-label="anchor" href="#shrub-crown-ratio-and-fraction-of-dead-material"></a>
</h3>
<p>Although values not included in <strong>medfuels</strong>, we can use
the same strategy to populate the fraction of dead material
(<code>pDead</code> or <span class="math inline">\(P_{dead}\)</span>)
and the crown ratio (<code>cr</code>) for shrubs from a trait database.
First we load the data frame:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shrub_pdead_cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/ShrubAllometries/Shrub_Pdead_CR.txt"</span><span class="op">)</span>, </span>
<span>                             sep<span class="op">=</span><span class="st">"\t"</span>, dec<span class="op">=</span><span class="st">","</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">Name</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="st">"Name"</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Expected 2 pieces. Additional pieces discarded in 26 rows [1, 2, 3, 4, 5, 6, 7,</span></span>
<span><span class="co">## 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 6 rows [28, 29, 30, 31,</span></span>
<span><span class="co">## 32, 33].</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shrub_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cr <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">CR.mean</span>,</span>
<span>                       pDead <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Pdead.mean</span>,</span>
<span>                       row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span></span>
<span><span class="va">shrub_data</span></span></code></pre></div>
<pre><code><span><span class="co">##                                    cr       pDead</span></span>
<span><span class="co">## Arbutus unedo               0.7339058 0.018494232</span></span>
<span><span class="co">## Arctostaphylos uva-ursi     1.0000000 0.023333333</span></span>
<span><span class="co">## Buxus sempervirens          0.8662708 0.005992095</span></span>
<span><span class="co">## Cistus albidus              0.6184939 0.074359228</span></span>
<span><span class="co">## Cistus laurifolius          0.7593714 0.067326043</span></span>
<span><span class="co">## Cistus monspeliensis        0.6855493 0.022440078</span></span>
<span><span class="co">## Cistus salviifolius         0.6894033 0.052122299</span></span>
<span><span class="co">## Cytisus oromediterraneus    1.0000000          NA</span></span>
<span><span class="co">## Cytisus scoparius           0.6653998 0.000000000</span></span>
<span><span class="co">## Cytisophyllum sessilifolium 0.4900602 0.000000000</span></span>
<span><span class="co">## Erica arborea               0.6954551 0.042631022</span></span>
<span><span class="co">## Erica multiflora            0.5738137 0.069654328</span></span>
<span><span class="co">## Erica scoparia              0.6846741 0.076279648</span></span>
<span><span class="co">## Genista scorpius            0.6477187          NA</span></span>
<span><span class="co">## Lavandula stoechas          0.6055558 0.051301667</span></span>
<span><span class="co">## Ligustrum vulgare           0.7470863 0.006618840</span></span>
<span><span class="co">## Phillyrea latifolia                NA          NA</span></span>
<span><span class="co">## Pistacia lentiscus          0.5561571          NA</span></span>
<span><span class="co">## Quercus coccifera           0.8032817          NA</span></span>
<span><span class="co">## Quercus ilex                       NA          NA</span></span>
<span><span class="co">## Rosa canina                        NA          NA</span></span>
<span><span class="co">## Rosmarinus officinalis      0.7111922          NA</span></span>
<span><span class="co">## Spartium junceum            0.5988686 0.112755122</span></span>
<span><span class="co">## Thymus vulgaris             1.0000000          NA</span></span>
<span><span class="co">## Ulex parviflorus            0.4196456          NA</span></span>
<span><span class="co">## Viburnum lantana            0.7467853 0.000000000</span></span>
<span><span class="co">## Viburnum tinus              0.5601560 0.044541738</span></span>
<span><span class="co">## Ch                          0.8075882 0.051301667</span></span>
<span><span class="co">## MP                          0.7185810 0.017105050</span></span>
<span><span class="co">## NPF                         0.5974499 0.043182606</span></span>
<span><span class="co">## NPR                         0.8358759 0.076279648</span></span>
<span><span class="co">## NPS                         0.6701570 0.053689663</span></span>
<span><span class="co">## NP                          0.6629622 0.050990585</span></span></code></pre>
<p>We then split the data frame into a table for species and a table for
shrub types, and call function
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateShrubAllometriesFromMedfuels()</a></code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_params_allom</span> <span class="op">=</span> <span class="va">shrub_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="va">group_params_allom</span> <span class="op">=</span> <span class="va">shrub_data</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">33</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateShrubAllometriesFromMedfuels</a></span><span class="op">(</span><span class="va">SpParams</span>, </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"cr"</span> <span class="op">=</span> <span class="st">"cr"</span>, <span class="st">"pDead"</span> <span class="op">=</span> <span class="st">"pDead"</span><span class="op">)</span>,</span>
<span>                        <span class="va">sp_params_allom</span>, </span>
<span>                        <span class="va">group_params_allom</span>, </span>
<span>                        <span class="va">species_groups</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tree-allometries">Tree allometries<a class="anchor" aria-label="anchor" href="#tree-allometries"></a>
</h3>
<p>Tree allometric models for foliar biomass were calibrated from field
data obtained in IEFC, a forest inventory conducted in Catalonia
(<em>Inventari Ecològic i Forestal de Catalunya</em>) more or less
during the same years as the Spanish IFN3. We begin by loading the table
containing regression coefficients:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fb_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_FB_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fb_models</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      a_fbt    b_fbt        c_fbt        r2   n Units</span></span>
<span><span class="co">## Abies           0.17058616 1.378225           NA 0.6463064 179 kg/cm</span></span>
<span><span class="co">## Acer            0.02253127 1.484118 -0.003428136 0.4435353  21 kg/cm</span></span>
<span><span class="co">## Alnus glutinosa 0.02977975 1.323745 -0.008657684 0.6196341  35 kg/cm</span></span>
<span><span class="co">## Arbutus unedo   0.10412957 1.333633 -0.011657605 0.4697923  50 kg/cm</span></span>
<span><span class="co">## Betula pendula  0.03458325 1.273168 -0.008987736 0.6857783 144 kg/cm</span></span>
<span><span class="co">## Castanea sativa 0.15693123 1.187538 -0.037201263 0.6139703  86 kg/cm</span></span>
<span><span class="co">##                          Source</span></span>
<span><span class="co">## Abies           Calculated IEFC</span></span>
<span><span class="co">## Acer            Calculated IEFC</span></span>
<span><span class="co">## Alnus glutinosa Calculated IEFC</span></span>
<span><span class="co">## Arbutus unedo   Calculated IEFC</span></span>
<span><span class="co">## Betula pendula  Calculated IEFC</span></span>
<span><span class="co">## Castanea sativa Calculated IEFC</span></span></code></pre>
<p>And we simply use function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateTreeAllometries()</a></code>
from package <strong>medfateutils</strong> to copy the coefficients onto
<code>SpParams</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fb_models</span>, <span class="st">"foliarbiomass"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Assignments species: 0 genus: 0 family: 0 order:0 group: 0</span></span></code></pre>
<p>Note that some assignments for species not present in the source
table were done using allometric coefficients that had been defined in
the source table at the genus level.</p>
<p>Crown width and crown ratio coefficients were obtained from the
literature and are loaded here:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, </span>
<span>                                 sheet<span class="op">=</span> <span class="st">"Tree_CR_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cr_models</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     a_cr     b_1cr     b_2cr        b_3cr     c_1cr    c_2cr</span></span>
<span><span class="co">## Abies alba       2.36476 -0.763000 -0.022850  0.000074049 -0.010180 -0.27004</span></span>
<span><span class="co">## Fagus sylvatica  3.85373 -0.743000 -0.024680  0.000135686  0.000000 -0.38434</span></span>
<span><span class="co">## Pinus nigra      2.26205  0.000000 -0.019340  0.000000000 -0.013730 -0.44909</span></span>
<span><span class="co">## Pinus sylvestris 1.50576 -0.706481 -0.078039  0.000182000 -0.007262  0.00000</span></span>
<span><span class="co">## Quercus          1.98539 -0.552000 -0.013860 -0.000110736 -0.006850 -0.20101</span></span>
<span><span class="co">## Abies            2.36476 -0.763000 -0.022850  0.000074049 -0.010180 -0.27004</span></span>
<span><span class="co">##                                       Source</span></span>
<span><span class="co">## Abies alba       Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## Fagus sylvatica  Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## Pinus nigra      Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## Pinus sylvestris     Dominguez et al. (2006)</span></span>
<span><span class="co">## Quercus          Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## Abies                             Abies alba</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cw_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, </span>
<span>                                 sheet<span class="op">=</span> <span class="st">"Tree_CW_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cw_models</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                       a_cw   b_cw                           Source</span></span>
<span><span class="co">## Abies alba       1.0963648 0.5380    Hasenauer (1997) - Abies alba</span></span>
<span><span class="co">## Acer             1.5189207 0.5285     Hasenauer (1997) - Acer spp.</span></span>
<span><span class="co">## Castanea sativa  1.3065630 0.5856             Condés &amp; Sterba 2005</span></span>
<span><span class="co">## Fagus sylvatica  0.8386180 0.7347             Condés &amp; Sterba 2005</span></span>
<span><span class="co">## Fraxinus         1.1951838 0.5665 Hasenauer (1997) - Fraxinus spp.</span></span>
<span><span class="co">## Pinus halepensis 0.6415296 0.7310             Condés &amp; Sterba 2005</span></span></code></pre>
<p>We use the same function to populate the corresponding columns in
<code>SpParams</code>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cr_models</span>, <span class="st">"crownratio"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Assignments species: 0 genus: 0 family: 0 order:0 group: 0</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateAllometries.html" class="external-link">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cw_models</span>, <span class="st">"crownwidth"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Assignments species: 0 genus: 0 family: 0 order:0 group: 0</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="parameters-drawn-from-plant-trait-databases">Parameters drawn from plant trait databases<a class="anchor" aria-label="anchor" href="#parameters-drawn-from-plant-trait-databases"></a>
</h2>
<p>Although we used specific functions to map most of the parameters so
far, package <strong>medfateutils</strong> offers a generic function,
called <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code>, to help mapping plant traits from
data bases into model parameters. In this section we will extensively
use this function to fill a large number of parameters from TRY <span class="citation">(Kattge et al. 2011)</span> and other plant trait data
bases available to us.</p>
<div class="section level3">
<h3 id="trait-mapping-from-try">Trait mapping from TRY<a class="anchor" aria-label="anchor" href="#trait-mapping-from-try"></a>
</h3>
<p>The TRY database <span class="citation">(Kattge et al. 2011)</span>
is a primary source for plant traits. We created a list of TRY trait
definitions that could be mapped to <strong>medfate</strong> parameters.
The following table shows the mapping:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_mapping</span> <span class="op">=</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TraitCorrespondence.xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">TRY_mapping</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">TRY_mapping</span><span class="op">$</span><span class="va">Used</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">TRY_mapping</span><span class="op">$</span><span class="va">Used</span><span class="op">==</span><span class="st">"YES"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, </span>
<span>             row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="11%">
<col width="82%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">ParameterName</th>
<th align="left">TRYtrait</th>
<th align="right">TraitID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">LeafSize</td>
<td align="left">Leaf area (in case of compound leaves: leaf, petiole
included)</td>
<td align="right">3110</td>
</tr>
<tr class="even">
<td align="left">LeafShape</td>
<td align="left">Leaf type</td>
<td align="right">43</td>
</tr>
<tr class="odd">
<td align="left">LifeForm</td>
<td align="left">Life form</td>
<td align="right">343</td>
</tr>
<tr class="even">
<td align="left">PhenologyType</td>
<td align="left">Leaf phenology type</td>
<td align="right">37</td>
</tr>
<tr class="odd">
<td align="left">Z95</td>
<td align="left">Rooting depth</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">LeafDuration</td>
<td align="left">Leaf lifespan (longevity)</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">SLA</td>
<td align="left">Leaf area per leaf dry mass (specific leaf area)</td>
<td align="right">3117</td>
</tr>
<tr class="even">
<td align="left">LeafDensity</td>
<td align="left">Leaf density (leaf tissue density, leaf dry mass per
leaf volume)</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="left">WoodDensity</td>
<td align="left">Wood density (stem dry mass per stem fresh volume)</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Al2As</td>
<td align="left">Stem sapwood cross-sectional area per supported leaf
surface area (Huber value)</td>
<td align="right">171</td>
</tr>
<tr class="odd">
<td align="left">LeafWidth</td>
<td align="left">Leaf width</td>
<td align="right">145</td>
</tr>
<tr class="even">
<td align="left">SRL</td>
<td align="left">Fine root length per fine root dry mass (specific fine
root length, SRL)</td>
<td align="right">614</td>
</tr>
<tr class="odd">
<td align="left">LeafPI0</td>
<td align="left">Leaf water &amp; osmotic potential: leaf osmotic
potential at full turgor</td>
<td align="right">188</td>
</tr>
<tr class="even">
<td align="left">LeafEPS</td>
<td align="left">Leaf elastic modulus</td>
<td align="right">190</td>
</tr>
<tr class="odd">
<td align="left">LigninPercent</td>
<td align="left">Leaf lignin content per leaf dry mass</td>
<td align="right">87</td>
</tr>
<tr class="even">
<td align="left">WUE</td>
<td align="left">Leaf photosynthesis rate per leaf transpiration
(photosynthetic WUE)</td>
<td align="right">134</td>
</tr>
<tr class="odd">
<td align="left">VCleaf_kmax</td>
<td align="left">Leaf hydraulic conductance</td>
<td align="right">748</td>
</tr>
<tr class="even">
<td align="left">VCstem_c</td>
<td align="left">Xylem hydraulic vulnerability, xylem cavitation
vulnerability, embolism vulnerability, (P20, P50, P8</td>
<td align="right">719</td>
</tr>
<tr class="odd">
<td align="left">VCstem_d</td>
<td align="left">Xylem hydraulic vulnerability, xylem cavitation
vulnerability, embolism vulnerability, (P20, P50, P8</td>
<td align="right">719</td>
</tr>
<tr class="even">
<td align="left">Nleaf</td>
<td align="left">Leaf nitrogen (N) content per leaf dry mass</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">Nsapwood</td>
<td align="left">Wood nitrogen (N) content per wood dry mass</td>
<td align="right">1229</td>
</tr>
<tr class="even">
<td align="left">Nfineroot</td>
<td align="left">Fine root nitrogen (N) content per fine root dry
mass</td>
<td align="right">475</td>
</tr>
<tr class="odd">
<td align="left">Vmax298</td>
<td align="left">Leaf photosynthesis carboxylation capacity (Vcmax) per
leaf area (Farquhar model)</td>
<td align="right">186</td>
</tr>
<tr class="even">
<td align="left">Jmax298</td>
<td align="left">Leaf photosynthesis electron transport capacity (Jmax)
per leaf area (Farquhar model)</td>
<td align="right">269</td>
</tr>
<tr class="odd">
<td align="left">WoodC</td>
<td align="left">Stem carbon (C) content per stem dry mass</td>
<td align="right">407</td>
</tr>
<tr class="even">
<td align="left">RERleaf</td>
<td align="left">Leaf respiration rate in the dark per leaf dry
mass</td>
<td align="right">41</td>
</tr>
<tr class="odd">
<td align="left">RERsapwood</td>
<td align="left">Stem respiration rate per stem dry mass</td>
<td align="right">519</td>
</tr>
<tr class="even">
<td align="left">RSSG</td>
<td align="left">Shade tolerance</td>
<td align="right">603</td>
</tr>
</tbody>
</table>
<p>We then queried TRY for public data regarding the list of TraitIDs
and split the result into one database for each trait, using the TRY
TraitID as file name. Data for these plant traits will be progressively
loaded as required in the following subsections.</p>
</div>
<div class="section level3">
<h3 id="additional-trait-databases">Additional trait databases<a class="anchor" aria-label="anchor" href="#additional-trait-databases"></a>
</h3>
<p>Additional plant trait databases can be used for parameter
estimation. We begin by loading several trait data bases, that drawn
from literature publications or assembled by ourselves. One of them is
HydraTRY <span class="citation">(Mencuccini et al. 2019;
Sanchez‐Martinez et al. 2020)</span>, which contains hydraulic plant
traits:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_hydratry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/HydraTRY/HydraTRY.xlsx"</span><span class="op">)</span></span>
<span><span class="va">hydratry</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="va">fn_hydratry</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p>Plant hydraulic traits can also be found in <span class="citation">Martin-StPaul, Delzon, and Cochard (2017)</span>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_martin_stpaul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/MartinStPaul_et_al_2017/DataBase.xlsx"</span><span class="op">)</span></span>
<span><span class="va">martin_stpaul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="va">fn_martin_stpaul</span>, sheet<span class="op">=</span><span class="st">"ALL"</span><span class="op">)</span></span>
<span><span class="va">martin_stpaul</span><span class="op">&lt;-</span><span class="va">martin_stpaul</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span>, <span class="st">"P12"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>and <span class="citation">Choat et al. (2012)</span>:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_choat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/Choat_et_al_2012/nature11688-s2.xls"</span><span class="op">)</span></span>
<span><span class="va">choat</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_choat</span><span class="op">)</span></span>
<span><span class="va">choat</span> <span class="op">&lt;-</span><span class="va">choat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span>, <span class="st">"P88"</span><span class="op">)</span><span class="op">]</span> <span class="co"># Remove unit row</span></span></code></pre></div>
<p><span class="citation">Bartlett, Scoffoni, and Sack (2012)</span>
provides values for leaf pressure-volume curves:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_bartlett</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Bartlett_et_al_2012/Bartlett_2012_ELE_data.xlsx"</span><span class="op">)</span></span>
<span><span class="va">bartlett</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="va">fn_bartlett</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><span class="citation">Duursma et al. (2018)</span> is a good source
of minimum stomatal conductance:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_duursma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Duursma_et_al_2018/gmindatabase.csv"</span><span class="op">)</span></span>
<span><span class="va">duursma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv2</a></span><span class="op">(</span><span class="va">fn_duursma</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span></span></code></pre></div>
<p>whereas <span class="citation">Hoshika et al. (2018)</span> provides
maximum stomatal conductance values:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_hoshika</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Hoshika_et_al_2018/Hoshika_et_al_2018.xlsx"</span><span class="op">)</span></span>
<span><span class="va">hoshika</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="va">fn_hoshika</span><span class="op">)</span> </span>
<span><span class="va">hoshika</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">hoshika</span><span class="op">$</span><span class="va">Species</span>,pattern <span class="op">=</span> <span class="st">"_"</span>, replacement <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<p>BROT2 database <span class="citation">(Tavşanoǧlu and Pausas
2018)</span> is particularly useful for Mediterranean plants, containing
many anatomical, phenological and morphological traits:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_brot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/BROT2/BROT2_dat.csv"</span><span class="op">)</span></span>
<span><span class="va">brot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv2</a></span><span class="op">(</span><span class="va">fn_brot2</span><span class="op">)</span></span></code></pre></div>
<p>Another source of data is the Global wood density database <span class="citation">(Zanne et al. 2009)</span>:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_gwdd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/GlobalWoodDensityDatabase/GlobalWoodDensityDatabase.xls"</span><span class="op">)</span></span>
<span><span class="va">gwdd</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_gwdd</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>and <span class="citation">Yebra et al. (2019)</span> provides
estimates of fine fuel moisture content for a large number of species
worldwide:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_yebra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/LFMC_Yebra_et_al_2019/Globe-LFMC-v2.xlsx"</span><span class="op">)</span></span>
<span><span class="va">fmc_yebra</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="va">fn_yebra</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Finally, <span class="citation">Morris et al. (2016)</span> provides
fractions of parenchymatic tissue within sapwood:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_morris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, </span>
<span>                       <span class="st">"TraitDatabases/Morris_et_al_2016/nph13737-sup-0002-tables1.xlsx"</span><span class="op">)</span></span>
<span><span class="va">morris</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="va">fn_morris</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>We complemented the formed data bases with our own compilation of
plant traits, including leaf phenology:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/LeafPhenology/LeafPhenology.xlsx"</span><span class="op">)</span></span>
<span><span class="va">budburst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_pheno</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">senescence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_pheno</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>flammability traits:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_flam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FuelAttributes/FuelAttributes.xlsx"</span><span class="op">)</span></span>
<span><span class="va">flam</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_flam</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>the ratio of leaf dry mass to fine fuel dry mass:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_ffr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FineFuelRatio/FineFuelRatio.xlsx"</span><span class="op">)</span></span>
<span><span class="va">ffr</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_ffr</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>minimum/maximum fuel moisture contents:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_fmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FMC/FMC.xlsx"</span><span class="op">)</span></span>
<span><span class="va">fmc_field</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_fmc</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fmc_bib</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_fmc</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>and construction costs:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fn_lcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/ConstructionCosts/LeafConstructionCosts.xlsx"</span><span class="op">)</span></span>
<span><span class="va">lcc_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_lcc</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fn_scc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/ConstructionCosts/SapwoodConstructionCosts.xlsx"</span><span class="op">)</span></span>
<span><span class="va">scc_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_scc</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fn_fcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/ConstructionCosts/FineRootConstructionCosts.xlsx"</span><span class="op">)</span></span>
<span><span class="va">fcc_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">fn_fcc</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plantleaf-classification">Plant/leaf classification<a class="anchor" aria-label="anchor" href="#plantleaf-classification"></a>
</h3>
<p>Plant and leaf classification parameters (i.e. plant life form, leaf
phenology, leaf size class, leaf form) are strict in
<strong>medfate</strong>, meaning they need to be provided for all
target entities.</p>
<div class="section level4">
<h4 id="life-form">Life form<a class="anchor" aria-label="anchor" href="#life-form"></a>
</h4>
<p>A large number of life form records can be found in TRY. We load TRY
life form data (TraitID = 343) first:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_life_form</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_343.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Since life form descriptions in TRY are not standardized, we
standardize life form values into six categories:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ch"</span>, <span class="st">"CH"</span>, <span class="st">"Cha"</span>, <span class="st">"chamaephyte"</span>, <span class="st">"Chamaephytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Chamaephyte"</span></span>
<span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cryptophytes"</span>, <span class="st">"cryptophyte"</span>,</span>
<span>                               <span class="st">"G"</span>, <span class="st">"geophyte"</span>, <span class="st">"Geophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Cryptophyte"</span></span>
<span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ep"</span>, <span class="st">"epiphyte"</span>,<span class="st">"Epiphytes"</span>, <span class="st">"liana"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Epiphyte"</span></span>
<span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"hemicryptophyte"</span>, <span class="st">"Hemicryptophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hemicryptophyte"</span></span>
<span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydrophyte"</span>, <span class="st">"Hydrophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hydrophyte"</span></span>
<span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mega- meso- and micro- phanerophyte"</span>,</span>
<span>                               <span class="st">"Phanerophyte (mega-,meso-, nano-)"</span>,</span>
<span>                               <span class="st">"Mega-, meso- and microphanerophyte"</span>,</span>
<span>                               <span class="st">"megaphanerophyte"</span>, <span class="st">"Megaphanerophyte"</span>,</span>
<span>                               <span class="st">"Micro-phanerophytes"</span>, <span class="st">"Nanophanerophyt"</span>,</span>
<span>                               <span class="st">"nanophanerophyte"</span>, <span class="st">"Nanophanerophyte"</span>,</span>
<span>                               <span class="st">"phanerophyte"</span>, <span class="st">"Phanerophytes"</span>, <span class="st">"shrub"</span>, <span class="st">"tree"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Phanerophyte"</span></span>
<span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"therophyte"</span>, <span class="st">"Therophyte (annual land plant)"</span>, <span class="st">"Therophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Therophyte"</span></span></code></pre></div>
<p>And we exclude a number of records by focusing on these
categories:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_life_form</span><span class="op">&lt;-</span><span class="va">TRY_life_form</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chamaephyte"</span>, <span class="st">"Cryptophyte"</span>,</span>
<span>                                                               <span class="st">"Epiphyte"</span>, <span class="st">"Hemicryptophyte"</span>, <span class="st">"Hydrophyte"</span>,</span>
<span>                                                               <span class="st">"Phanerophyte"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We can now call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> to parse TRY
values:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_life_form</span>,</span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LifeForm"</span> <span class="op">=</span> <span class="st">"OrigValueStr"</span><span class="op">)</span>,</span>
<span>                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [OrigValueStr -&gt; LifeForm] species: 81 conspecific: 115 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 21 missing trait values (9.7 %) after populating with input data.</span></span></code></pre>
<p>Check which species have missing values:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LifeForm"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                         Name LifeForm</span></span>
<span><span class="co">## 14  Ampelodesmos mauritanica     &lt;NA&gt;</span></span>
<span><span class="co">## 15             Anagyris spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 18      Apollonias barbujana     &lt;NA&gt;</span></span>
<span><span class="co">## 21   Arctostaphylos uva-ursi     &lt;NA&gt;</span></span>
<span><span class="co">## 55               Corema spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 103          Genistella spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 104    Gleditsia triacanthos     &lt;NA&gt;</span></span>
<span><span class="co">## 106            Halimium spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 107    Heberdenia bahamensis     &lt;NA&gt;</span></span>
<span><span class="co">## 126           Lithodora spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 139   Paliurus spina-christi     &lt;NA&gt;</span></span>
<span><span class="co">## 144             Phlomis spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 146         Picconia excelsa     &lt;NA&gt;</span></span>
<span><span class="co">## 160   Pleiomeris canariensis     &lt;NA&gt;</span></span>
<span><span class="co">## 177              Retama spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 192     Securinega tinctoria     &lt;NA&gt;</span></span>
<span><span class="co">## 193           Sideritis spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 202              Teline spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 212               Vella spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 214          Visnea mocanera     &lt;NA&gt;</span></span>
<span><span class="co">## 217           Zizyphus lotus     &lt;NA&gt;</span></span></code></pre>
<p>Since <code>LifeForm</code> is a strict parameter, we need to fill
missing values manually:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Arctostaphylos uva-ursi"</span>, <span class="st">"Corema spp."</span>, <span class="st">"Genistella spp."</span>, </span>
<span>                                       <span class="st">"Halimium spp."</span>, <span class="st">"Lithodora spp."</span>, <span class="st">"Phlomis spp."</span>,</span>
<span>                                       <span class="st">"Sideritis spp."</span>, <span class="st">"Vella spp."</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Chamaephyte"</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ampelodesmos mauritanica"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hemicryptophyte"</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Anagyris spp."</span>, <span class="st">"Apollonias barbujana"</span>, <span class="st">"Gleditsia triacanthos"</span>,</span>
<span>                                       <span class="st">"Heberdenia bahamensis"</span>, <span class="st">"Picconia excelsa"</span>, <span class="st">"Pleiomeris canariensis"</span>,</span>
<span>                                       <span class="st">"Paliurus spina-christi"</span>, <span class="st">"Retama spp."</span>, <span class="st">"Securinega tinctoria"</span>,</span>
<span>                                       <span class="st">"Teline spp."</span>,</span>
<span>                                       <span class="st">"Visnea mocanera"</span>, <span class="st">"Zizyphus lotus"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Phanerophyte"</span></span></code></pre></div>
<p>Show the number of taxa for each life form in the species parameter
table is:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##     Chamaephyte     Cryptophyte Hemicryptophyte    Phanerophyte </span></span>
<span><span class="co">##              47               1              16             153</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-shape">Leaf shape<a class="anchor" aria-label="anchor" href="#leaf-shape"></a>
</h4>
<p>A large number of leaf shape records can be found in TRY (its name in
the data base is “Leaf type”). We begin by loading TRY leaf form data
(TraitID = 43):</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_leaf_shape</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_43.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Since leaf shape descriptions in TRY are not standardized, we
standardize leaf shape values into five categories:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"broadleaved"</span>, <span class="st">"broad-leaved"</span>, <span class="st">"B"</span>, <span class="st">"broadleaf"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Broad"</span></span>
<span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"needleleaved"</span>, <span class="st">"needle-leaved"</span>,<span class="st">"needle"</span>,<span class="st">"needle-leaf"</span>, <span class="st">"N"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Needle"</span></span>
<span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scale-shaped"</span>, <span class="st">"scale"</span>, <span class="st">"scale-like"</span>, <span class="st">"scale-leaf"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span></span>
<span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"narrowleaved"</span>, <span class="st">"linear"</span>, <span class="st">"Cylindrical"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Linear"</span></span>
<span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"photosynthetic stem"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Spines"</span></span>
<span><span class="va">TRY_leaf_shape</span><span class="op">&lt;-</span><span class="va">TRY_leaf_shape</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Broad"</span>, <span class="st">"Needle"</span>, <span class="st">"Scale"</span>, <span class="st">"Linear"</span>, <span class="st">"Spines"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_leaf_shape</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafShape"</span><span class="op">)</span></span></code></pre></div>
<p>Leaf shape data is also available from database BROT2 <span class="citation">(Tavşanoǧlu and Pausas 2018)</span>. We also
standardize BROT2 leaf shape values into the same five categories:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_LeafShape</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafShape"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"Needle-like"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Needle"</span></span>
<span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"Scale-like"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafShape"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we merge the two source data sets and call
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> to parse leaf shape values:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LeafShape_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span>,</span>
<span>                       <span class="va">TRY_leaf_shape</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafShape_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafShape"</span> <span class="op">=</span> <span class="st">"LeafShape"</span><span class="op">)</span>,</span>
<span>                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Equisetum &lt;d7&gt;dycei'</span></span>
<span><span class="co">## to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 65297 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 66528 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 66529 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Carex &lt;d7&gt;</span></span>
<span><span class="co">## pannewitziana' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 69192 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Calamagrostis &lt;d7&gt;</span></span>
<span><span class="co">## acutiflora' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 69360 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Eriochrysis &lt;d7&gt;</span></span>
<span><span class="co">## concepcionensis' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Musa &lt;d7&gt;</span></span>
<span><span class="co">## paradisiaca' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Leucanthemum</span></span>
<span><span class="co">## &lt;d7&gt;superbum' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Vasconcellea &lt;d7&gt;</span></span>
<span><span class="co">## heilbornii cv.. babaco' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Tilia &lt;d7&gt;moltkei'</span></span>
<span><span class="co">## to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Copa&lt;ed&gt;fera' to a</span></span>
<span><span class="co">## wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Ing&lt;e1&gt;' to a wide</span></span>
<span><span class="co">## string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate</span></span>
<span><span class="co">## 'Shorea&lt;a0&gt;anthoshorea' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Reynoldsia</span></span>
<span><span class="co">## sandwicensis&lt;a0&gt;&lt;a0&gt;&lt;a0&gt;' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Xylosma</span></span>
<span><span class="co">## hawaiiense&lt;a0&gt;&lt;a0&gt;&lt;a0&gt;' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Citrus</span></span>
<span><span class="co">## &lt;d7&gt;aurantiifolia' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [LeafShape -&gt; LeafShape] species: 127 conspecific: 88 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 2 missing trait values (0.9 %) after populating with input data.</span></span></code></pre>
<p>Show which species have missing values:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LeafShape"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                       Name LeafShape</span></span>
<span><span class="co">## 103        Genistella spp.      &lt;NA&gt;</span></span>
<span><span class="co">## 203 Tetraclinis articulata      &lt;NA&gt;</span></span></code></pre>
<p>and, like before, we need to fill missing values manually:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genistella spp."</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Broad"</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tetraclinis articulata"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span></span></code></pre></div>
<p>The final number of taxa for each leaf shape in the species parameter
table is:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Broad Linear Needle  Scale </span></span>
<span><span class="co">##    185      1     26      5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-size">Leaf size<a class="anchor" aria-label="anchor" href="#leaf-size"></a>
</h4>
<p>Parameter <code>LeafSize</code> of <strong>medfate</strong> is
categorical, and describes the size of leaves as “Small”, “Medium” or
“Large”. TRY includes a trait called “Leaf area”, that contains leaf
area in mm2. We load TRY leaf area data using:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_leaf_area</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_3110.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_leaf_area</span> <span class="op">&lt;-</span> <span class="va">TRY_leaf_area</span><span class="op">[</span><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">ErrorRisk</span> <span class="op">&lt;</span> <span class="fl">4</span>,<span class="op">]</span></span></code></pre></div>
<p>and classify TRY leaf area values into th`e three leaf size
categories:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">LeafSize</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">StdValue</span><span class="op">)</span>, </span>
<span>                             breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">225</span>, <span class="fl">2025</span>,<span class="fl">100000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">TRY_LeafSize</span><span class="op">&lt;-</span><span class="va">TRY_leaf_area</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_LeafSize</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Species"</span></span></code></pre></div>
<p>Database BROT2 <span class="citation">(Tavşanoǧlu and Pausas
2018)</span> contains both leaf area measurements and categorical leaf
size data. We thus split BROT2 data into leaf area values and leaf size
strings:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafArea"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Trait"</span>, <span class="st">"Data"</span>, <span class="st">"Units"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_LeafSize</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Units</span><span class="op">==</span><span class="st">"[5]"</span>,<span class="op">]</span></span>
<span><span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Units</span><span class="op">==</span><span class="st">"mm2"</span>,<span class="op">]</span></span></code></pre></div>
<p>We then reclassify BROT2 leaf size data into three categories</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"very small"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"small"</span></span>
<span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"very large"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"large"</span></span>
<span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">brot2_LeafSize</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafSize</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafSize"</span><span class="op">)</span></span></code></pre></div>
<p>and classify BRO2 leaf area values into three categories, as we did
with TRY values:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">LeafSize</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>, </span>
<span>                              breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">225</span>, <span class="fl">2025</span>,<span class="fl">100000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_LeafArea</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Species"</span></span></code></pre></div>
<p>We can now merge the three source data tables and call
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> to parse leaf size values:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LeafSize_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span>,</span>
<span>                      <span class="va">brot2_LeafArea</span>,</span>
<span>                      <span class="va">TRY_LeafSize</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafSize_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafSize"</span> <span class="op">=</span> <span class="st">"LeafSize"</span><span class="op">)</span>,</span>
<span>                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LeafSize -&gt; LeafSize] species: 80 conspecific: 108 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 29 missing trait values (13.4 %) after populating with input data.</span></span></code></pre>
<p>Show species with missing values:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                            Name LeafSize</span></span>
<span><span class="co">## 10             Adenocarpus spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 14     Ampelodesmos mauritanica     &lt;NA&gt;</span></span>
<span><span class="co">## 15                Anagyris spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 18         Apollonias barbujana     &lt;NA&gt;</span></span>
<span><span class="co">## 34                  Cedrus spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 37     Chamaecyparis lawsoniana     &lt;NA&gt;</span></span>
<span><span class="co">## 40   Chamaespartium tridentatum     &lt;NA&gt;</span></span>
<span><span class="co">## 56          Coriaria myrtifolia     &lt;NA&gt;</span></span>
<span><span class="co">## 63  Cytisophyllum sessilifolium     &lt;NA&gt;</span></span>
<span><span class="co">## 77          Daboecia cantabrica     &lt;NA&gt;</span></span>
<span><span class="co">## 81               Dracaena drago     &lt;NA&gt;</span></span>
<span><span class="co">## 94                Erinacea spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 103             Genistella spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 104       Gleditsia triacanthos     &lt;NA&gt;</span></span>
<span><span class="co">## 107       Heberdenia bahamensis     &lt;NA&gt;</span></span>
<span><span class="co">## 120          Kleinia neriifolia     &lt;NA&gt;</span></span>
<span><span class="co">## 139      Paliurus spina-christi     &lt;NA&gt;</span></span>
<span><span class="co">## 146            Picconia excelsa     &lt;NA&gt;</span></span>
<span><span class="co">## 160      Pleiomeris canariensis     &lt;NA&gt;</span></span>
<span><span class="co">## 163       Pseudotsuga menziesii     &lt;NA&gt;</span></span>
<span><span class="co">## 179           Rhododendron spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 192        Securinega tinctoria     &lt;NA&gt;</span></span>
<span><span class="co">## 196            Sophora japonica     &lt;NA&gt;</span></span>
<span><span class="co">## 198               Spartium spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 202                 Teline spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 205                  Thuja spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 212                  Vella spp.     &lt;NA&gt;</span></span>
<span><span class="co">## 214             Visnea mocanera     &lt;NA&gt;</span></span>
<span><span class="co">## 217              Zizyphus lotus     &lt;NA&gt;</span></span></code></pre>
<p>As before, we need to fill missing values manually:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Apollonias barbujana"</span>,</span>
<span>                                       <span class="st">"Ampelodesmos mauritanica"</span>,</span>
<span>                                       <span class="st">"Dracaena drago"</span>, <span class="st">"Heberdenia bahamensis"</span>,</span>
<span>                                       <span class="st">"Picconia excelsa"</span>, <span class="st">"Pleiomeris canariensis"</span>,</span>
<span>                                       <span class="st">"Visnea mocanera"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Large"</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Anagyris spp."</span>,<span class="st">"Coriaria myrtifolia"</span>, </span>
<span>                                       <span class="st">"Gleditsia triacanthos"</span>, <span class="st">"Securinega tinctoria"</span>,</span>
<span>                                       <span class="st">"Kleinia neriifolia"</span>, <span class="st">"Rhododendron spp."</span>,</span>
<span>                                       <span class="st">"Sophora japonica"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Medium"</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Adenocarpus spp."</span>, </span>
<span>                                       <span class="st">"Cedrus spp."</span>,</span>
<span>                                       <span class="st">"Chamaecyparis lawsoniana"</span>,</span>
<span>                                       <span class="st">"Chamaespartium tridentatum"</span>,</span>
<span>                                       <span class="st">"Cytisophyllum sessilifolium"</span>,</span>
<span>                                       <span class="st">"Daboecia cantabrica"</span>,</span>
<span>                                       <span class="st">"Erinacea spp."</span>, <span class="st">"Genistella spp."</span>,</span>
<span>                                       <span class="st">"Paliurus spina-christi"</span>, <span class="st">"Pseudotsuga menziesii"</span>,</span>
<span>                                       <span class="st">"Spartium spp."</span>, <span class="st">"Teline spp."</span>,  <span class="st">"Thuja spp."</span>, <span class="st">"Vella spp."</span>,</span>
<span>                                       <span class="st">"Zizyphus lotus"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Small"</span></span></code></pre></div>
<p>The final number of taxa for each leaf size in the species parameter
table is:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Large Medium  Small </span></span>
<span><span class="co">##     53     75     89</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="phenology-type">Phenology type<a class="anchor" aria-label="anchor" href="#phenology-type"></a>
</h4>
<p>A large number of leaf phenology type records can be found in TRY
(TraitID 37). We load TRY leaf phenology type data first:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_phenology</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_37.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>As with several previous parameters, leaf phenology type strings need
to be standardized. Five phenology categories are used in
<strong>medfate</strong>, four of which can be mapped with TRY
strings:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"evergreen"</span>, <span class="st">"E"</span>, <span class="st">"EV"</span>, <span class="st">"always summer green"</span>,</span>
<span>                               <span class="st">"Evergreen broad-leaved"</span>, <span class="st">"Evergreen scale-like"</span>,</span>
<span>                               <span class="st">"Evergreen needle-leaved"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span></span>
<span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deciduous"</span>, <span class="st">"D"</span>, <span class="st">"Deciduous broad-leaved"</span>, <span class="st">"Deciduous"</span>,</span>
<span>                               <span class="st">"Nonevergreen"</span>, <span class="st">"winter deciduous"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span></span>
<span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"semi-deciduous"</span>,</span>
<span>                               <span class="st">"semi-evergreen"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-semideciduous"</span></span>
<span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drought semi-deciduous"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drought-semideciduous"</span></span>
<span><span class="va">TRY_phenology</span><span class="op">&lt;-</span><span class="va">TRY_phenology</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"progressive-evergreen"</span>,</span>
<span>                                                               <span class="st">"oneflush-evergreen"</span>, </span>
<span>                                                               <span class="st">"winter-semideciduous"</span>,</span>
<span>                                                               <span class="st">"winter-deciduous"</span>,</span>
<span>                                                               <span class="st">"drought-semideciduous"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">TRY_phenology</span><span class="op">&lt;-</span><span class="va">TRY_phenology</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_phenology</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafPhenology"</span><span class="op">)</span></span></code></pre></div>
<p>Leaf phenology types are also available in BROT2 <span class="citation">(Tavşanoǧlu and Pausas 2018)</span>, so we select them
and map the existing values into <strong>medfate</strong>
categories:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_LeafPhenology</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafPhenology"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"drought semi-deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drought-semideciduous"</span></span>
<span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"evergreen"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span></span>
<span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"winter deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span></span>
<span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"winter semi-deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-semideciduous"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_LeafPhenology</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafPhenology"</span><span class="op">)</span></span></code></pre></div>
<p>We can now merge the two source data sets and call
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> to parse leaf phenology types:</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LeafPhenology_data</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafPhenology</span>,</span>
<span>                          <span class="va">TRY_phenology</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafPhenology_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PhenologyType"</span> <span class="op">=</span> <span class="st">"LeafPhenology"</span><span class="op">)</span>,</span>
<span>                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LeafPhenology -&gt; PhenologyType] species: 119 conspecific: 94 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 4 missing trait values (1.8 %) after populating with input data.</span></span></code></pre>
<p>We show which target entities have missing values after
imputation:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"PhenologyType"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                       Name PhenologyType</span></span>
<span><span class="co">## 103        Genistella spp.          &lt;NA&gt;</span></span>
<span><span class="co">## 160 Pleiomeris canariensis          &lt;NA&gt;</span></span>
<span><span class="co">## 192   Securinega tinctoria          &lt;NA&gt;</span></span>
<span><span class="co">## 212             Vella spp.          &lt;NA&gt;</span></span></code></pre>
<p>And since leaf phenology type is a strict parameter, we need to
manually fill missing values :</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vella spp."</span>, <span class="st">"Genistella spp."</span>, <span class="st">"Securinega tinctoria"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pleiomeris canariensis"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span></span></code></pre></div>
<p>The final number of taxa for each phenology type in the species
parameter table are:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## drought-semideciduous    oneflush-evergreen      winter-deciduous </span></span>
<span><span class="co">##                     4                   124                    89</span></span></code></pre>
<p>A notable problem observed is that there are no winter-semideciduous
species, as they are frequently recorded simply as winter-deciduous.</p>
</div>
</div>
<div class="section level3">
<h3 id="plant-size">Plant size<a class="anchor" aria-label="anchor" href="#plant-size"></a>
</h3>
<p>We already populated some plant size parameters from forest inventory
data. Here we draw values for parameters that are not normally measured
in forest inventory data (for obvious reasons), such as maximum rooting
depth.</p>
<div class="section level4">
<h4 id="maximum-rooting-depth">Maximum rooting depth<a class="anchor" aria-label="anchor" href="#maximum-rooting-depth"></a>
</h4>
<p>TRY trait ‘Rooting depth’ (ID 6) contains measurements of rooting
depth for multiple species. We first load this dataset:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Z95</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_6.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We filter those entries that we consider correspond to maximum
rooting depths, which we will map to parameter <code>Z95</code> (depth
corresponding to 95% of fine roots):</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Z95</span> <span class="op">&lt;-</span><span class="va">TRY_Z95</span><span class="op">[</span><span class="va">TRY_Z95</span><span class="op">$</span><span class="va">OriglName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Max Rooting Depth (m)"</span>,</span>
<span>                                           <span class="st">"Rooting depth"</span>,</span>
<span>                                           <span class="st">"Rooting depth (m)"</span>,</span>
<span>                                           <span class="st">"Rooting depth_max"</span>,</span>
<span>                                           <span class="st">"RootDepth"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">TRY_Z95</span> <span class="op">&lt;-</span> <span class="va">TRY_Z95</span><span class="op">[</span><span class="va">TRY_Z95</span><span class="op">$</span><span class="va">ErrorRisk</span> <span class="op">&lt;</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_Z95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Z95"</span><span class="op">)</span></span></code></pre></div>
<p>Rooting depth values are also available from BROT2 <span class="citation">(Tavşanoǧlu and Pausas 2018)</span> (some of these
records are also in TRY). As before, we assume values to correspond to
parameter <code>Z95</code>.</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_Z95</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RootDepth"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_Z95</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">brot2_Z95</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_Z95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Z95"</span><span class="op">)</span></span></code></pre></div>
<p>We then merge the two data sets, trim rooting values to lie within
the interval [15 cm, 10 m] and call the populating function, while
transforming units from m to mm:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Z95_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TRY_Z95</span>,</span>
<span>                 <span class="va">brot2_Z95</span><span class="op">)</span></span>
<span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span>, <span class="fl">0.15</span><span class="op">)</span> <span class="co"># Minimum of 15 cm depth</span></span>
<span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># Maximum of 10 m depth</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Z95_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z95"</span> <span class="op">=</span> <span class="st">"Z95"</span><span class="op">)</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z95"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Z95 -&gt; Z95] species: 46 conspecific: 117 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 54 missing trait values (24.9 %) after populating with input data.</span></span></code></pre>
<p>Show species with missing values, grouped by growth form:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt; table of extent 2 x 0 &gt;</span></span></code></pre>
<p>Since <code>Z95</code> is a strict parameter, we fill missing values
with growth form averages:</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The distribution of <span class="math inline">\(Z95\)</span> values
for shrub species and non-shrub species can be shown using:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z95"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##      NA      NA      NA     NaN      NA      NA     217</span></span></code></pre>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z95"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##      NA      NA      NA     NaN      NA      NA     217</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="leaf-phenology">Leaf phenology<a class="anchor" aria-label="anchor" href="#leaf-phenology"></a>
</h3>
<div class="section level4">
<h4 id="budburst-and-senescence">Budburst and senescence<a class="anchor" aria-label="anchor" href="#budburst-and-senescence"></a>
</h4>
<p>Most parameters regulating leaf phenological phases (i.e. bud
dormancy, budburst, senescence, bud formation, …) require calibration
exercises using observed weather data and phenological records.</p>
<p>We compiled a data base with published leaf budburst models <span class="citation">(Vitasse et al. 2011; Asse et al. 2020)</span>:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">budburst</span></span></code></pre></div>
<pre><code><span><span class="co">##                Species      PhenologyType t0gdd Tbgdd  Sgdd   N Accepted</span></span>
<span><span class="co">## 1           Abies alba oneflush-evergreen  72.9  1.08 455.4  14        Y</span></span>
<span><span class="co">## 2  Acer pseudoplatanus   winter-deciduous  82.6  3.22 199.3  16        Y</span></span>
<span><span class="co">## 3       Betula pendula   winter-deciduous   1.0  4.90  72.0 146        Y</span></span>
<span><span class="co">## 4     Corylus avellana   winter-deciduous   1.0  7.12  21.0 128        Y</span></span>
<span><span class="co">## 5      Fagus sylvatica   winter-deciduous  98.4  0.00 201.9  30        Y</span></span>
<span><span class="co">## 6   Fraxinus excelsior   winter-deciduous  30.5  0.00 562.3  18        N</span></span>
<span><span class="co">## 7   Fraxinus excelsior   winter-deciduous   1.0  5.68 121.0 149        Y</span></span>
<span><span class="co">## 8      Ilex aquifolium oneflush-evergreen  79.7  0.00 539.4  18        Y</span></span>
<span><span class="co">## 9        Larix decidua   winter-deciduous   1.0  9.60   3.0 159        Y</span></span>
<span><span class="co">## 10         Picea abies oneflush-evergreen   1.0  2.96 290.0 112        Y</span></span>
<span><span class="co">## 11     Quercus petraea   winter-deciduous  54.5  4.34 240.7  42        Y</span></span>
<span><span class="co">##                    Ref</span></span>
<span><span class="co">## 1  Vitasse et al. 2011</span></span>
<span><span class="co">## 2  Vitasse et al. 2011</span></span>
<span><span class="co">## 3     Asse et al. 2020</span></span>
<span><span class="co">## 4     Asse et al. 2020</span></span>
<span><span class="co">## 5  Vitasse et al. 2011</span></span>
<span><span class="co">## 6  Vitasse et al. 2011</span></span>
<span><span class="co">## 7     Asse et al. 2020</span></span>
<span><span class="co">## 8  Vitasse et al. 2011</span></span>
<span><span class="co">## 9     Asse et al. 2020</span></span>
<span><span class="co">## 10    Asse et al. 2020</span></span>
<span><span class="co">## 11 Vitasse et al. 2011</span></span></code></pre>
<p>and leaf senescence models <span class="citation">(Delpierre et al.
2009; Vitasse et al. 2011)</span>:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">senescence</span></span></code></pre></div>
<pre><code><span><span class="co">##               Species Phsen Tbsen xsen ysen    Ssen   N Accepted</span></span>
<span><span class="co">## 1 Acer pseudoplatanus  11.0  10.0    1    0     1.2  16        Y</span></span>
<span><span class="co">## 2     Fagus sylvatica  14.5  32.2    1    2  1206.0  30        N</span></span>
<span><span class="co">## 3     Fagus sylvatica  12.5  25.0    2    2  5160.0  79        Y</span></span>
<span><span class="co">## 4     Quercus petraea  12.5  28.5    2    2 10178.0 106        Y</span></span>
<span><span class="co">## 5     Quercus petraea  12.8  27.5    2    0 11913.0  42        N</span></span>
<span><span class="co">##                     Ref</span></span>
<span><span class="co">## 1   Vitasse et al. 2011</span></span>
<span><span class="co">## 2   Vitasse et al. 2011</span></span>
<span><span class="co">## 3 Delpierre et al. 2009</span></span>
<span><span class="co">## 4 Delpierre et al. 2009</span></span>
<span><span class="co">## 5   Vitasse et al. 2011</span></span></code></pre>
<p>Note that some species are repeated. Since we cannot average model
parameters, due to parameter correlation, in cases of more than one
model by species we selected the one based on a larger sample size
(table column <code>N</code>), and codified the result in a table column
called <code>Accepted</code>. We use the leaf budburst model data base
to populate leaf phenology parameters:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">budburst</span><span class="op">[</span><span class="va">budburst</span><span class="op">$</span><span class="va">Accepted</span><span class="op">==</span><span class="st">"Y"</span>,<span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t0gdd"</span> <span class="op">=</span> <span class="st">"t0gdd"</span>,</span>
<span>                                             <span class="st">"Tbgdd"</span> <span class="op">=</span> <span class="st">"Tbgdd"</span>,</span>
<span>                                             <span class="st">"Sgdd"</span> <span class="op">=</span> <span class="st">"Sgdd"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                           erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [t0gdd -&gt; t0gdd] species: 6 conspecific: 21 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 190 missing trait values (87.6 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [Tbgdd -&gt; Tbgdd] species: 6 conspecific: 21 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 190 missing trait values (87.6 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [Sgdd -&gt; Sgdd] species: 6 conspecific: 21 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 190 missing trait values (87.6 %) after populating with input data.</span></span></code></pre>
<p>Similarly, we use the senescence model database to fill the
parameters regulating leaf senescence:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">senescence</span><span class="op">[</span><span class="va">senescence</span><span class="op">$</span><span class="va">Accepted</span><span class="op">==</span><span class="st">"Y"</span>,<span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phsen"</span> <span class="op">=</span> <span class="st">"Phsen"</span>,</span>
<span>                                             <span class="st">"Tbsen"</span> <span class="op">=</span> <span class="st">"Tbsen"</span>,</span>
<span>                                             <span class="st">"Ssen"</span> <span class="op">=</span> <span class="st">"Ssen"</span>,</span>
<span>                                             <span class="st">"xsen"</span> <span class="op">=</span> <span class="st">"xsen"</span>,</span>
<span>                                             <span class="st">"ysen"</span> <span class="op">=</span> <span class="st">"ysen"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                           erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Phsen -&gt; Phsen] species: 3 conspecific: 16 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 198 missing trait values (91.2 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [Tbsen -&gt; Tbsen] species: 3 conspecific: 16 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 198 missing trait values (91.2 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [Ssen -&gt; Ssen] species: 3 conspecific: 16 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 198 missing trait values (91.2 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [xsen -&gt; xsen] species: 3 conspecific: 16 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 198 missing trait values (91.2 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [ysen -&gt; ysen] species: 3 conspecific: 16 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 198 missing trait values (91.2 %) after populating with input data.</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-duration">Leaf duration<a class="anchor" aria-label="anchor" href="#leaf-duration"></a>
</h4>
<p>Leaf lifespan is available from TRY for many species (TraitID 12). We
load records for this trait, which is already standardized into month
units:</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_LeafDuration</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_12.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_LeafDuration</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafDuration</span><span class="op">[</span><span class="va">TRY_LeafDuration</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_LeafDuration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafDuration"</span><span class="op">)</span></span></code></pre></div>
<p>Leaf lifespan is also available from BROT2 <span class="citation">(Tavşanoǧlu and Pausas 2018)</span>, also in number of
months:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"LL"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafDuration"</span></span>
<span><span class="va">brot2_LeafDuration</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafLifespan"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_LeafDuration</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">brot2_LeafDuration</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_LeafDuration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafDuration"</span><span class="op">)</span></span></code></pre></div>
<p>We then merge the two data sources and call function
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> to map leaf lifespan to parameter
<code>LeafDuration</code> (<span class="math inline">\(LD\)</span>), and
we specify a transformation of units from months to years:</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LeafDuration_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafDuration"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                         <span class="va">TRY_LeafDuration</span>,</span>
<span>                         <span class="va">brot2_LeafDuration</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafDuration_data</span>, </span>
<span>                                trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafDuration"</span> <span class="op">=</span> <span class="st">"LeafDuration"</span><span class="op">)</span>,</span>
<span>                                scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafDuration"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">12</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                                taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LeafDuration -&gt; LeafDuration] species: 62 conspecific: 101 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 54 missing trait values (24.9 %) after populating with input data.</span></span></code></pre>
<p>In this case, and the following ones, the trait is not strict, so
that we do not need to manually fill missing values.</p>
</div>
</div>
<div class="section level3">
<h3 id="morphology-and-anatomy">Morphology and anatomy<a class="anchor" aria-label="anchor" href="#morphology-and-anatomy"></a>
</h3>
<p>In this subsection we map several plant morphological and anatomical
traits into model parameters. All such traits in
<strong>medfate</strong> are imputable, so that missing values do not
need to be handled here.</p>
<div class="section level4">
<h4 id="specific-leaf-area">Specific leaf area<a class="anchor" aria-label="anchor" href="#specific-leaf-area"></a>
</h4>
<p>Specific leaf area (<span class="math inline">\(SLA\)</span>), in
mm2/mg or m2/kg, is available from several databases. We load records
from TRY (TraitID = 3117), which are already standardized:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_SLA</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_3117.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_SLA</span> <span class="op">&lt;-</span> <span class="va">TRY_SLA</span><span class="op">[</span><span class="va">TRY_SLA</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_SLA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"SLA"</span><span class="op">)</span></span></code></pre></div>
<p>We also select SLA records from BROT2 <span class="citation">(Tavşanoǧlu and Pausas 2018)</span>, already in the
same units as TRY.</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_SLA</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SLA"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_SLA</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">brot2_SLA</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_SLA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"SLA"</span><span class="op">)</span></span></code></pre></div>
<p>And we merge these two sources with SLA values coming from database
HydraTRY <span class="citation">(Mencuccini et al. 2019;
Sanchez‐Martinez et al. 2020)</span>. The whole set is used to call
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> and populate <span class="math inline">\(SLA\)</span> parameter values without any
transformation:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SLA_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"SLA"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                 <span class="va">TRY_SLA</span>,</span>
<span>                 <span class="va">brot2_SLA</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">SLA_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SLA"</span> <span class="op">=</span> <span class="st">"SLA"</span><span class="op">)</span> ,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [SLA -&gt; SLA] species: 102 conspecific: 102 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 13 missing trait values (6 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SLA"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##   2.419   7.060  11.035  12.298  16.559  31.165      13</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-density">Leaf density<a class="anchor" aria-label="anchor" href="#leaf-density"></a>
</h4>
<p>Leaf density (leaf dry mass per leaf volume, in <span class="math inline">\(g \cdot cm^{-3}\)</span>) is available in TRY
(TraitID = 48). Since we do not have other data sources we directly use
this data set to populate parameter <code>LeafDensity</code> (<span class="math inline">\(LD\)</span>):</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_LeafDensity</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_48.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_LeafDensity</span><span class="op">&lt;-</span> <span class="va">TRY_LeafDensity</span><span class="op">[</span><span class="va">TRY_LeafDensity</span><span class="op">$</span><span class="va">ErrorRisk</span> <span class="op">&lt;</span> <span class="fl">3</span>,, drop<span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span> </span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_LeafDensity</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafDensity"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; LeafDensity] species: 57 conspecific: 92 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 68 missing trait values (31.3 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafDensity"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.1048  0.2640  0.3668  0.3658  0.4408  0.7961      68</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="wood-density">Wood density<a class="anchor" aria-label="anchor" href="#wood-density"></a>
</h4>
<p>Wood density (stem dry mass per fresh stem volume, in <span class="math inline">\(g \cdot cm^{-3}\)</span>) is available in TRY
(TraitID = 4):</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_WoodDensity</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_4.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_WoodDensity</span> <span class="op">&lt;-</span> <span class="va">TRY_WoodDensity</span><span class="op">[</span><span class="va">TRY_WoodDensity</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_WoodDensity</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></span></code></pre></div>
<p>Wood density records are also available from the ‘Global Wood Density
Database’ <span class="citation">(Zanne et al. 2009)</span>:</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gwdd_WoodDensity</span><span class="op">&lt;-</span><span class="va">gwdd</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Binomial"</span>, <span class="st">"Wood density (g/cm^3), oven dry mass/fresh volume"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gwdd_WoodDensity</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></span></code></pre></div>
<p>Wood density is also part of HydraTRY database <span class="citation">(Mencuccini et al. 2019; Sanchez‐Martinez et al.
2020)</span>:</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"WD"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"WoodDensity"</span></span></code></pre></div>
<p>and we can also find wood density estimates in BROT2 <span class="citation">(Tavşanoǧlu and Pausas 2018)</span>:</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_WoodDensity</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"StemDensity"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">brot2_WoodDensity</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">brot2_WoodDensity</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brot2_WoodDensity</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></span></code></pre></div>
<p>We merge all these four sources and call
<code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code>:</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WoodDensity_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"WoodDensity"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                        <span class="va">TRY_WoodDensity</span>,</span>
<span>                        <span class="va">brot2_WoodDensity</span>,</span>
<span>                        <span class="va">gwdd_WoodDensity</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">WoodDensity_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WoodDensity"</span> <span class="op">=</span> <span class="st">"WoodDensity"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Tilia &lt;d7&gt;moltkei'</span></span>
<span><span class="co">## to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 20207 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Tilia &lt;d7&gt;moltkei'</span></span>
<span><span class="co">## to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 38868 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [WoodDensity -&gt; WoodDensity] species: 81 conspecific: 103 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 33 missing trait values (15.2 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WoodDensity"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.1832  0.4694  0.5775  0.5588  0.6500  0.9786      33</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="fine-fuel-ratio">Fine fuel ratio<a class="anchor" aria-label="anchor" href="#fine-fuel-ratio"></a>
</h4>
<p>The fine fuel ratio, i.e. the ratio between dry mass of leaves and
the dry mass of leaves and branchlets (&lt; 6.35 mm), is a parameter
that is harder to get from trait data bases. Here we use our own
compilation of values to populate parameter <code>r635</code> (<span class="math inline">\(r_{6.35}\)</span>):</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ffr</span><span class="op">)</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r635"</span> <span class="op">=</span> <span class="st">"r635"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [r635 -&gt; r635] species: 30 conspecific: 63 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 124 missing trait values (57.1 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r635"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##   1.258   1.869   2.475   2.583   2.743   5.674     124</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="fraction-of-dead-material">Fraction of dead material<a class="anchor" aria-label="anchor" href="#fraction-of-dead-material"></a>
</h4>
<p>The fraction of standing dead biomass (<span class="math inline">\(P_{dead}\)</span>) was already populated for
shrubs in the section devoted to allometries, although several target
entities still have missing values:</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">pDead</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## TRUE </span></span>
<span><span class="co">##  217</span></span></code></pre>
<p>We tried to reduce some of these missing values with data from BROT2
<span class="citation">(Tavşanoǧlu and Pausas 2018)</span>. We first
select “DeadFuel” records from this data base:</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brot2_DF</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DeadFuel"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Trait"</span>, <span class="st">"Data"</span>, <span class="st">"Units"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Units</span><span class="op">==</span><span class="st">"%"</span><span class="op">)</span></span>
<span><span class="va">brot2_DF</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">brot2_DF</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span></code></pre></div>
<p>and populate the species parameter table, while transforming
percentages into the [0-1] interval:</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">brot2_DF</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pDead"</span> <span class="op">=</span> <span class="st">"Data"</span><span class="op">)</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pDead"</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">100</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Taxon"</span>,</span>
<span>                           erase_previous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Data -&gt; pDead] species: 23 conspecific: 59 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 135 missing trait values (62.2 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pDead"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">## 0.00020 0.09294 0.14365 0.15271 0.22562 0.60500     135</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-area-to-sapwood-area-ratio">Leaf area to sapwood area ratio<a class="anchor" aria-label="anchor" href="#leaf-area-to-sapwood-area-ratio"></a>
</h4>
<p>The leaf area to sapwood area ratio <code>Al2As</code> is also known
as the inverse of the Huber value. This trait can be found in the TRY
database (TraitID = 171):</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Al2As</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_171.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Since either <code>Al2As</code> or the Huber value may have been
recorded, we need to carefully inspect what was actually measured, and
which measurement units were used:</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Huber value"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Huber value"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"leaf.area.per.sapwood.area"</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"leaf.area.per.sapwood.area"</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span></span>
<span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Sapwood: leaf area ratio"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Sapwood: leaf area ratio"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"The ratio of leaf area attached per unit sapwood cross-section area (m2 cm-2)"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"The ratio of leaf area attached per unit sapwood cross-section area (m2 cm-2)"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at base of living crown, m2/cm2"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at base of living crown, m2/cm2"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at breast height, m2/cm2"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at breast height, m2/cm2"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">TRY_Al2As</span> <span class="op">&lt;-</span> <span class="va">TRY_Al2As</span><span class="op">[</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">ErrorRisk</span> <span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Al2As"</span><span class="op">)</span></span></code></pre></div>
<p>We use a summary of the data to check the range of values and median
ones, which should make sense according to our knowledge of this
variable:</p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">TRY_Al2As</span><span class="op">$</span><span class="va">Al2As</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##     638    2926    6390    7194    9035   23795</span></span></code></pre>
<p>Huber values are also available from HydraTRY <span class="citation">(Mencuccini et al. 2019; Sanchez‐Martinez et al.
2020)</span>, so we transform them into <code>Al2As</code>:</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hydratry_Al2As</span> <span class="op">&lt;-</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"Hv"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">hydratry_Al2As</span><span class="op">$</span><span class="va">Hv</span><span class="op">&lt;-</span> <span class="fl">10000</span><span class="op">/</span><span class="va">hydratry_Al2As</span><span class="op">$</span><span class="va">Hv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry_Al2As</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Al2As"</span><span class="op">)</span></span></code></pre></div>
<p>Now we are ready to merge the two datasets and perform the population
of the species parameter table:</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hv_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TRY_Al2As</span>,</span>
<span>               <span class="va">hydratry_Al2As</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Hv_data</span>,</span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Al2As"</span> <span class="op">=</span> <span class="st">"Al2As"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Al2As -&gt; Al2As] species: 24 conspecific: 79 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 114 missing trait values (52.5 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Al2As"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##   570.1  2045.0  3186.6  4459.4  5129.5 23795.0     114</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="fraction-of-conduits-within-sapwood">Fraction of conduits within sapwood<a class="anchor" aria-label="anchor" href="#fraction-of-conduits-within-sapwood"></a>
</h4>
<p>We used the database of <span class="citation">Morris et al.
(2016)</span> as primary source to populate the fraction of sapwood
corresponding to tracheids or vessels (the remaining being axial or
radial parenchyma):</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">morris</span><span class="op">[</span><span class="va">morris</span><span class="op">$</span><span class="va">Organ</span><span class="op">==</span><span class="st">"stem"</span>,<span class="op">]</span>,</span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conduit2sapwood"</span> <span class="op">=</span> <span class="st">"Radial.and.Axial.Parenchyma.(%)"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species.name"</span>,</span>
<span>                           scalar_functions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"conduit2sapwood"</span><span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Radial.and.Axial.Parenchyma.(%) -&gt; conduit2sapwood] species: 17 conspecific: 56 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 144 missing trait values (66.4 %) after populating with input data.</span></span></code></pre>
<p>Note that we had to transform the values in the data base, which
refer to the percentage of radial/axial parenchymatic tissue. The
distribution of parameter values is:</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conduit2sapwood"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.4858  0.6899  0.8274  0.7953  0.9236  0.9451     144</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-width">Leaf width<a class="anchor" aria-label="anchor" href="#leaf-width"></a>
</h4>
<p>Leaf width (<span class="math inline">\(LW\)</span> in cm) records
can be obtained from TRY (TraitID = 145), so we directly use this data
source to populate the trait without transformation:</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_LW</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_145.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_LW</span><span class="op">[</span><span class="va">TRY_LW</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>,<span class="op">]</span>,</span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafWidth"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Jasminum</span></span>
<span><span class="co">## meyeri&lt;fb&gt;johannis' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 5790 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Jasminum</span></span>
<span><span class="co">## meyeri&lt;fb&gt;johannis' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 5791 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; LeafWidth] species: 51 conspecific: 109 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 57 missing trait values (26.3 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafWidth"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.0500  0.3394  1.6223  2.9171  4.5000 17.1538      57</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="specific-root-length">Specific root length<a class="anchor" aria-label="anchor" href="#specific-root-length"></a>
</h4>
<p>Finally, specific fine root length (<span class="math inline">\(SRL\)</span>) is the fine root length per fine
root dry mass and can also be retrieved from TRY (TraitID = 614):</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_SRL</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_614.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_SRL</span><span class="op">[</span><span class="va">TRY_SRL</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>,<span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRL"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; SRL] species: 8 conspecific: 54 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 155 missing trait values (71.4 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SRL"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##   522.1  1497.0  3621.2  4327.7  4398.8 32534.1     155</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tissue-moisture">Tissue moisture<a class="anchor" aria-label="anchor" href="#tissue-moisture"></a>
</h3>
<p>Plant tissue moisture parameters in <strong>medfate</strong> include
those specifying maximum/minimum moisture content in leaves/branchlets
as well as parameters describing the pressure-volume curve of leaves and
stem tissues.</p>
<div class="section level4">
<h4 id="minimummaximum-fuel-moisture-content">Minimum/maximum fuel moisture content<a class="anchor" aria-label="anchor" href="#minimummaximum-fuel-moisture-content"></a>
</h4>
<p>Fuel moisture content is usually defined as the mass of water per dry
mass of fuel tissue. We used the database of <span class="citation">Yebra et al. (2019)</span> as primary source of fuel
moisture content. We first update the name of some species in the data
base:</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fmc_yebra</span><span class="op">$</span><span class="va">Species.collected</span><span class="op">[</span><span class="va">fmc_yebra</span><span class="op">$</span><span class="va">Species.collected</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Salvia officinalis"</span></span></code></pre></div>
<p>and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> to determine parameters
<code>minFMC</code> (<span class="math inline">\(FMC_{min}\)</span>) and
<code>maxFMC</code> (<span class="math inline">\(FMC_{max}\)</span>)
using the 5% and 95% lowest quantile values, respectively:</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fmc_yebra</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minFMC"</span> <span class="op">=</span> <span class="st">"LFMC.value"</span><span class="op">)</span>,</span>
<span>                           summary_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>,probs<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,</span>
<span>                           summary_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species.collected"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LFMC.value -&gt; minFMC] species: 34 conspecific: 81 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 102 missing trait values (47 %) after populating with input data.</span></span></code></pre>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fmc_yebra</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"maxFMC"</span> <span class="op">=</span> <span class="st">"LFMC.value"</span><span class="op">)</span>,</span>
<span>                           summary_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>,probs<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,</span>
<span>                           summary_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species.collected"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LFMC.value -&gt; maxFMC] species: 34 conspecific: 81 genus: 0 family: 0 order: 0 group: 0</span></span>
<span><span class="co">## 102 missing trait values (47 %) after populating with input data.</span></span></code></pre>
<p>We now complement these values with additional data assembled by
ourselves, from publications or field work:</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FMC_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fmc_field</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species name"</span>, <span class="st">"MinFMC_DW"</span>, <span class="st">"MaxFMC_DW"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                  <span class="va">fmc_bib</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species name"</span>, <span class="st">"MinFMC_DW"</span>, <span class="st">"MaxFMC_DW"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">FMC_data</span><span class="op">$</span><span class="va">`Species name`</span><span class="op">[</span><span class="va">FMC_data</span><span class="op">$</span><span class="va">`Species name`</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Salvia officinalis"</span></span></code></pre></div>
<p>Note that the call to <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> includes
<code>erase_previous = FALSE</code> to avoid overwriting values on those
estimated from <span class="citation">Yebra et al. (2019)</span>:</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">FMC_data</span><span class="op">)</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minFMC"</span> <span class="op">=</span> <span class="st">"MinFMC_DW"</span>,</span>
<span>                                             <span class="st">"maxFMC"</span> <span class="op">=</span> <span class="st">"MaxFMC_DW"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species name"</span>, erase_previous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [MinFMC_DW -&gt; minFMC] species: 9 conspecific: 8 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 85 missing trait values (39.2 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [MaxFMC_DW -&gt; maxFMC] species: 9 conspecific: 8 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 85 missing trait values (39.2 %) after populating with input data.</span></span></code></pre>
<p>The distribution of <span class="math inline">\(FMC_{min}\)</span>
and <span class="math inline">\(FMC_{max}\)</span> parameter values
is:</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minFMC"</span>, <span class="st">"maxFMC"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      minFMC           maxFMC     </span></span>
<span><span class="co">##  Min.   :  8.15   Min.   : 68.0  </span></span>
<span><span class="co">##  1st Qu.: 56.08   1st Qu.:122.8  </span></span>
<span><span class="co">##  Median : 73.89   Median :151.1  </span></span>
<span><span class="co">##  Mean   : 72.96   Mean   :164.0  </span></span>
<span><span class="co">##  3rd Qu.: 82.93   3rd Qu.:184.1  </span></span>
<span><span class="co">##  Max.   :204.32   Max.   :460.7  </span></span>
<span><span class="co">##  NA's   :85       NA's   :85</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="leaf-pressure-volume-curve">Leaf pressure-volume curve<a class="anchor" aria-label="anchor" href="#leaf-pressure-volume-curve"></a>
</h4>
<p>Leaf osmotic potential at full turgor (<code>LeafPI0</code> or <span class="math inline">\(\pi_{0,leaf}\)</span>) and leaf elastic modulus
(<code>LeafEPS</code> or <span class="math inline">\(\epsilon_{leaf}\)</span>) describe leaf
pressure-volume curves. These traits can be obtained from TRY <span class="citation">(Kattge et al. 2011)</span> and <span class="citation">Bartlett, Scoffoni, and Sack (2012)</span>. We begin by
changing the column names of this second database:</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"πo.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafPI0"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"ε.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafEPS"</span></span></code></pre></div>
<p>we then load TRY data for <span class="math inline">\(\pi_{0,leaf}\)</span> (TraitID = 188):</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_LeafPI0</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_188.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_LeafPI0</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafPI0</span><span class="op">[</span><span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_LeafPI0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span></span>
<span><span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">LeafPI0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">LeafPI0</span> </span></code></pre></div>
<p>and TRY data for <span class="math inline">\(\epsilon_{leaf}\)</span>
(TraitID = 190):</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_LeafEPS</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_190.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_LeafEPS</span><span class="op">$</span><span class="va">StdValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">)</span> </span>
<span><span class="va">TRY_LeafEPS</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafEPS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span></span></code></pre></div>
<p>We then fill <span class="math inline">\(\pi_{0,leaf}\)</span> with
the TRY and <span class="citation">Bartlett, Scoffoni, and Sack
(2012)</span> data sources merged:</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LeafPI0_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TRY_LeafPI0</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                     <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafPI0_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafPI0"</span> <span class="op">=</span> <span class="st">"LeafPI0"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LeafPI0 -&gt; LeafPI0] species: 16 conspecific: 60 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 141 missing trait values (65 %) after populating with input data.</span></span></code></pre>
<p>And we do the same for <span class="math inline">\(\epsilon_{leaf}\)</span>:</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LeafEPS_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                     <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafEPS_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafEPS"</span> <span class="op">=</span> <span class="st">"LeafEPS"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [LeafEPS -&gt; LeafEPS] species: 15 conspecific: 55 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 147 missing trait values (67.7 %) after populating with input data.</span></span></code></pre>
<p>Finally, we use <span class="citation">Bartlett, Scoffoni, and Sack
(2012)</span> to provide suitable values for the fraction of apoplastic
tissue (<code>LeafAF</code> or <span class="math inline">\(f_{apo,leaf}\)</span>):</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">bartlett</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafAF"</span> <span class="op">=</span> <span class="st">"af"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [af -&gt; LeafAF] species: 12 conspecific: 25 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 180 missing trait values (82.9 %) after populating with input data.</span></span></code></pre>
<p>The statistical distributions of the three parameters is summarized
below:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeafPI0"</span>, <span class="st">"LeafEPS"</span>, <span class="st">"LeafAF"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     LeafPI0          LeafEPS           LeafAF      </span></span>
<span><span class="co">##  Min.   :-2.740   Min.   : 3.417   Min.   :0.0800  </span></span>
<span><span class="co">##  1st Qu.:-1.912   1st Qu.: 5.920   1st Qu.:0.1340  </span></span>
<span><span class="co">##  Median :-1.591   Median : 8.919   Median :0.2189  </span></span>
<span><span class="co">##  Mean   :-1.543   Mean   :11.646   Mean   :0.2316  </span></span>
<span><span class="co">##  3rd Qu.:-1.250   3rd Qu.:15.053   3rd Qu.:0.3525  </span></span>
<span><span class="co">##  Max.   :-0.720   Max.   :48.750   Max.   :0.4000  </span></span>
<span><span class="co">##  NA's   :141      NA's   :147      NA's   :180</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="fuel-flammability">Fuel flammability<a class="anchor" aria-label="anchor" href="#fuel-flammability"></a>
</h3>
<p>Fuel flammability properties are needed to predict potential fire
behavior on forest stands on the basis of its composition and
structure.</p>
<div class="section level4">
<h4 id="heat-content-and-surface-area-to-volume-ratio">Heat content and surface area to volume ratio<a class="anchor" aria-label="anchor" href="#heat-content-and-surface-area-to-volume-ratio"></a>
</h4>
<p>We compiled in a database bibliographic values of calorific heat
value (<span class="math inline">\(h\)</span>, in <span class="math inline">\(J \cdot kg^{-1}\)</span>) and the surface area to
volume ratio (<span class="math inline">\(\sigma\)</span>, in <span class="math inline">\(m^2 \cdot m^{-3}\)</span>) for different
Mediterranean plant species. We use this data set to populate the
corresponding <strong>medfate</strong> parameters:</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">flam</span><span class="op">)</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HeatContent"</span> <span class="op">=</span> <span class="st">"High calorific value [J/kg]"</span>,</span>
<span>                                             <span class="st">"SAV"</span> <span class="op">=</span> <span class="st">"SurfaceAreaVolume[m2/m3]"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species name"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [High calorific value [J/kg] -&gt; HeatContent] species: 28 conspecific: 56 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 133 missing trait values (61.3 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [SurfaceAreaVolume[m2/m3] -&gt; SAV] species: 20 conspecific: 43 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 154 missing trait values (71 %) after populating with input data.</span></span></code></pre>
<p>The statistical distributions of the two parameters is summarized
below:</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HeatContent"</span>, <span class="st">"SAV"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   HeatContent         SAV       </span></span>
<span><span class="co">##  Min.   :18700   Min.   : 1120  </span></span>
<span><span class="co">##  1st Qu.:19779   1st Qu.: 4073  </span></span>
<span><span class="co">##  Median :20466   Median : 4630  </span></span>
<span><span class="co">##  Mean   :20868   Mean   : 5097  </span></span>
<span><span class="co">##  3rd Qu.:21400   3rd Qu.: 6860  </span></span>
<span><span class="co">##  Max.   :24600   Max.   :10200  </span></span>
<span><span class="co">##  NA's   :133     NA's   :154</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="lignin-content">Lignin content<a class="anchor" aria-label="anchor" href="#lignin-content"></a>
</h4>
<p>The lignin content per dry mass of leaves is included in TRY (TraitID
= 87) with standardized units mg/g. To parse this trait into
<code>LigninPercent</code> (<span class="math inline">\(LI\)</span>) we
simply divide values by 10.</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Lignin</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_87.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Lignin</span><span class="op">[</span><span class="va">TRY_Lignin</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>,<span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">10</span><span class="op">}</span><span class="op">)</span>, <span class="co">#mg/g to % </span></span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; LigninPercent] species: 2 conspecific: 46 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 169 missing trait values (77.9 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##   6.032  12.590  16.153  19.003  25.809  28.975     169</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="transpirationphotosynthesis-graniers-model">Transpiration/photosynthesis (Granier’s model)<a class="anchor" aria-label="anchor" href="#transpirationphotosynthesis-graniers-model"></a>
</h3>
<p>The three following subsections provide suitable values for
parameters regulating transpiration and photosynthesis under the Granier
transpiration model.</p>
<div class="section level4">
<h4 id="water-potential-determining-stomatal-closure">Water potential determining stomatal closure<a class="anchor" aria-label="anchor" href="#water-potential-determining-stomatal-closure"></a>
</h4>
<p>Parameter <span class="math inline">\(\Psi_{extract}\)</span>
(<code>Psi_Extract</code>) is the water potential at which transpiration
is 50% of its maximum, for a given species. We decided to populate
values for this parameter using the water potential corresponding to
turgor loss point (<span class="math inline">\(\Psi_{tlp}\)</span>),
which is available in <span class="citation">Bartlett, Scoffoni, and
Sack (2012)</span> and HydraTRY <span class="citation">(Mencuccini et
al. 2019; Sanchez‐Martinez et al. 2020)</span>:</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"πtlp.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ptlp"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"PItlp"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ptlp"</span></span></code></pre></div>
<p>However, we did not take <span class="math inline">\(\Psi_{tlp}\)</span> directly as a value for <span class="math inline">\(\Psi_{extract}\)</span> but assumed that <span class="math inline">\(\Psi_{tlp}\)</span> corresponded to 5% of maximum
transpiration. Using <span class="math inline">\(\Psi_{tlp}\)</span> and
the equation that relates <span class="math inline">\(\Psi_{extract}\)</span> with relative whole plant
transpiration <span class="math inline">\(\Psi_{extract}\)</span> is
<span class="math inline">\(\Psi_{extract} =
\left[ln(0.5)/ln(0.05)\right]^{(1/r)} \cdot \Psi_{tlp}\)</span>, where
<span class="math inline">\(r = 3\)</span>. The mapping is done by
calling <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> on a merged dataset:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ptlp_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                  <span class="va">hydratry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                  <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Ptlp_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Psi_Extract"</span> <span class="op">=</span> <span class="st">"Ptlp"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Psi_Extract"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Ptlp -&gt; Psi_Extract] species: 38 conspecific: 60 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 119 missing trait values (54.8 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Psi_Extract"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">## -2.6091 -1.8310 -1.4086 -1.5011 -1.2084 -0.6262     119</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="critical-water-potential">Critical water potential<a class="anchor" aria-label="anchor" href="#critical-water-potential"></a>
</h4>
<p>Parameter <span class="math inline">\(\Psi_{critic}\)</span>
(<code>Psi_Critic</code>) is the water potential corresponding to 50% of
loss of hydraulic conductance in the stem, also known as <span class="math inline">\(\Psi_{50}\)</span>. This trait can be found in
three data bases <span class="citation">(Martin-StPaul, Delzon, and
Cochard 2017; Choat et al. 2012; Mencuccini et al. 2019;
Sanchez‐Martinez et al. 2020)</span>:</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P50_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                 <span class="va">choat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                 <span class="va">hydratry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">P50_data</span><span class="op">$</span><span class="va">P50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">P50_data</span><span class="op">$</span><span class="va">P50</span><span class="op">)</span></span></code></pre></div>
<p>TRY also contains data from xylem vulnerability curves, which mostly
overlaps other data sources, but from which we can perhaps obtain
additional <span class="math inline">\(\Psi_{50}\)</span> records <span class="citation">(Pausas et al. 2016; Manzoni et al. 2013)</span>:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_VC</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_719.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">VC_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Reference P50"</span>,</span>
<span>            <span class="st">"Xylem water potential at which 50% of conductivity is lost (P50)"</span>,</span>
<span>            <span class="st">"Stem P50"</span><span class="op">)</span></span>
<span><span class="va">TRY_P50</span> <span class="op">&lt;-</span> <span class="va">TRY_VC</span><span class="op">[</span><span class="va">TRY_VC</span><span class="op">$</span><span class="va">DataName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">VC_str</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TRY_P50</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span></span></code></pre></div>
<p>We convert string <span class="math inline">\(\Psi_{50}\)</span>
records to numeric values and change the sign of positive values:</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: NAs introduced by coercion</span></span></code></pre>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_P50</span> <span class="op">&lt;-</span> <span class="va">TRY_P50</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">TRY_P50</span><span class="op">$</span><span class="va">P50</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span></code></pre></div>
<p>And we can now merge TRY data with the other sources:</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P50_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">P50_data</span>, <span class="va">TRY_P50</span><span class="op">)</span></span></code></pre></div>
<p>The mapping is done by calling <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code> on a
merged dataset:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">P50_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Psi_Critic"</span> <span class="op">=</span> <span class="st">"P50"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [P50 -&gt; Psi_Critic] species: 62 conspecific: 85 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 70 missing trait values (32.3 %) after populating with input data.</span></span></code></pre>
<p>We want to ensure that <span class="math inline">\(\Psi_{critic} \leq
\Psi_{extract}\)</span> by using:</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span><span class="op">$</span><span class="va">Psi_Critic</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Psi_Critic</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">Psi_Extract</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Psi_Critic"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's </span></span>
<span><span class="co">## -10.2174  -5.1166  -3.4276  -3.8453  -2.4627  -0.4269       66</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="transpirationphotosynthesis-sperrys-model">Transpiration/photosynthesis (Sperry’s model)<a class="anchor" aria-label="anchor" href="#transpirationphotosynthesis-sperrys-model"></a>
</h3>
<p>Simulations with the Sperry’s transpiration model require many
species-specific parameters, several of them unavailable in plant trait
data bases. Here we make an effort to provide suitable values for some
of them, particularly stem hydraulic efficiency and vulnerability.
Others are estimated in <strong>medfate</strong> via inbuilt imputation
or scaling procedures, as described in medfate’s reference book.</p>
<div class="section level4">
<h4 id="minimummaximum-stomatal-conductance">Minimum/maximum stomatal conductance<a class="anchor" aria-label="anchor" href="#minimummaximum-stomatal-conductance"></a>
</h4>
<p>Minimum and maximum values of leaf conductance to water vapor (<span class="math inline">\(G_{swmin}\)</span> and <span class="math inline">\(G_{swmax}\)</span>) can be drawn from databases of
<span class="citation">Duursma et al. (2018)</span> and <span class="citation">Hoshika et al. (2018)</span>, respectively. We first
populate <span class="math inline">\(G_{swmin}\)</span> using data from
<span class="citation">Duursma et al. (2018)</span>, while changing the
units from <span class="math inline">\(mmol\cdot s^{-1} \cdot
m^{-2}\)</span> to <span class="math inline">\(mol\cdot s^{-1} \cdot
m^{-2}\)</span>:</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">duursma</span><span class="op">$</span><span class="va">gmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">duursma</span><span class="op">$</span><span class="va">gmin</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">duursma</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Gswmin"</span> <span class="op">=</span> <span class="st">"gmin"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Gswmin"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Mapping [gmin -&gt; Gswmin] species: 18 conspecific: 50 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 149 missing trait values (68.7 %) after populating with input data.</span></span></code></pre>
<p>We then populate <span class="math inline">\(G_{swmax}\)</span> using
data from <span class="citation">Hoshika et al. (2018)</span> without
any change in units:</p>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">hoshika</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Gswmax"</span> <span class="op">=</span> <span class="st">"gmax.(mol.m-2.s-1)"</span><span class="op">)</span> ,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [gmax.(mol.m-2.s-1) -&gt; Gswmax] species: 17 conspecific: 34 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 166 missing trait values (76.5 %) after populating with input data.</span></span></code></pre>
<p>The statistical distributions of the two parameters is summarized
below:</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gswmin"</span>, <span class="st">"Gswmax"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Gswmin            Gswmax      </span></span>
<span><span class="co">##  Min.   :0.00034   Min.   :0.0480  </span></span>
<span><span class="co">##  1st Qu.:0.00302   1st Qu.:0.1941  </span></span>
<span><span class="co">##  Median :0.00394   Median :0.2427  </span></span>
<span><span class="co">##  Mean   :0.00486   Mean   :0.2823  </span></span>
<span><span class="co">##  3rd Qu.:0.00600   3rd Qu.:0.3375  </span></span>
<span><span class="co">##  Max.   :0.01392   Max.   :0.8000  </span></span>
<span><span class="co">##  NA's   :149       NA's   :166</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="stem-maximum-hydraulic-conductivity">Stem maximum hydraulic conductivity<a class="anchor" aria-label="anchor" href="#stem-maximum-hydraulic-conductivity"></a>
</h4>
<p>Stem maximum hydraulic conductivity (<span class="math inline">\(K_{stem, max, ref}\)</span>) is an important
parameter used in <strong>medfate</strong> to estimate stem maximum
conductance, which defines plant hydraulic efficiency. Here we populate
some values from HydraTRY <span class="citation">(Mencuccini et al.
2019; Sanchez‐Martinez et al. 2020)</span>:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">hydratry</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kmax_stemxylem"</span> <span class="op">=</span> <span class="st">"Ks"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [Ks -&gt; Kmax_stemxylem] species: 34 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 107 missing trait values (49.3 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kmax_stemxylem"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.0722  0.3350  0.5380  1.4260  1.6930 15.6400     107</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="stem-hydraulic-vulnerability">Stem hydraulic vulnerability<a class="anchor" aria-label="anchor" href="#stem-hydraulic-vulnerability"></a>
</h4>
<p>Stem hydraulic vulnerability is described in <strong>medfate</strong>
using Weibull-type curves, which are described using two parameters.
Trait databases normally report vulnerability using water potential
corresponding to different levels of conductance loss, i.e. <span class="math inline">\(\Psi_{12}\)</span>, <span class="math inline">\(\Psi_{50}\)</span>, <span class="math inline">\(\Psi_{88}\)</span>, etc. Here we first estimate
Weibull coefficients from <span class="citation">Martin-StPaul, Delzon,
and Cochard (2017)</span> data on <span class="math inline">\(\Psi_{12}\)</span>, <span class="math inline">\(\Psi_{50}\)</span>:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_c</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_d</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P12</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">weib</span> <span class="op">=</span> <span class="fu"><a href="../../reference/hydraulics_conductancefunctions.html">hydraulics_psi2Weibull</a></span><span class="op">(</span>psi50 <span class="op">=</span> <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                                  psi12 <span class="op">=</span> <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P12</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"d"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>and we do something similar from <span class="citation">Choat et al.
(2012)</span> data on <span class="math inline">\(\Psi_{50}\)</span>,
<span class="math inline">\(\Psi_{88}\)</span>:</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">)</span></span>
<span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">)</span></span>
<span><span class="va">choat</span><span class="op">$</span><span class="va">VCstem_c</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">choat</span><span class="op">$</span><span class="va">VCstem_d</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">choat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">weib</span> <span class="op">=</span> <span class="fu"><a href="../../reference/hydraulics_conductancefunctions.html">hydraulics_psi2Weibull</a></span><span class="op">(</span>psi50 <span class="op">=</span> <span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                                  psi88 <span class="op">=</span> <span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">choat</span><span class="op">$</span><span class="va">VCstem_c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">choat</span><span class="op">$</span><span class="va">VCstem_d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"d"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We then merge the two data sets and populate Weibull coefficients
using <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits()</a></code>:</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VC_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                <span class="va">choat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">VC_data</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"VCstem_c"</span> <span class="op">=</span> <span class="st">"VCstem_c"</span>,</span>
<span>                                                <span class="st">"VCstem_d"</span> <span class="op">=</span> <span class="st">"VCstem_d"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [VCstem_c -&gt; VCstem_c] species: 51 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 90 missing trait values (41.5 %) after populating with input data.</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [VCstem_d -&gt; VCstem_d] species: 51 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 90 missing trait values (41.5 %) after populating with input data.</span></span></code></pre>
<p>The statistical distributions of the stem vulnerability parameters is
summarized below:</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     VCstem_c          VCstem_d       </span></span>
<span><span class="co">##  Min.   : 0.7318   Min.   :-11.3043  </span></span>
<span><span class="co">##  1st Qu.: 3.2806   1st Qu.: -6.6971  </span></span>
<span><span class="co">##  Median : 6.1031   Median : -4.1265  </span></span>
<span><span class="co">##  Mean   : 6.1744   Mean   : -5.0821  </span></span>
<span><span class="co">##  3rd Qu.: 8.0219   3rd Qu.: -3.6800  </span></span>
<span><span class="co">##  Max.   :19.4287   Max.   : -0.6767  </span></span>
<span><span class="co">##  NA's   :90        NA's   :90</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="photosynthetic-capacity">Photosynthetic capacity<a class="anchor" aria-label="anchor" href="#photosynthetic-capacity"></a>
</h4>
<p>TRY offers <span class="math inline">\(V_{max}\)</span> values
(TraitID = 186), which we take as estimates for
<strong>medfate</strong>’s <span class="math inline">\(V_{max298}\)</span> the maximum Rubisco
carboxilation rate at 25 degrees Celsius:</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Vmax298</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_186.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Vmax298</span><span class="op">[</span><span class="va">TRY_Vmax298</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vmax298"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; Vmax298] species: 23 conspecific: 87 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 107 missing trait values (49.3 %) after populating with input data.</span></span></code></pre>
<p>The same happens with TRY’s <span class="math inline">\(J_{max}\)</span> values (TraitID = 269), which we
take as estimates for <strong>medfate</strong>’s <span class="math inline">\(J_{max298}\)</span> the maximum electron transport
rate at 25 degrees Celsius:</p>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Jmax298</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_269.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Jmax298</span><span class="op">[</span><span class="va">TRY_Jmax298</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Jmax298"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; Jmax298] species: 20 conspecific: 70 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 127 missing trait values (58.5 %) after populating with input data.</span></span></code></pre>
<p>The statistical distributions of the two parameters is summarized
below:</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vmax298"</span>, <span class="st">"Jmax298"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Vmax298           Jmax298      </span></span>
<span><span class="co">##  Min.   :  9.755   Min.   : 44.00  </span></span>
<span><span class="co">##  1st Qu.: 37.023   1st Qu.: 77.54  </span></span>
<span><span class="co">##  Median : 55.010   Median :105.24  </span></span>
<span><span class="co">##  Mean   : 56.508   Mean   :110.15  </span></span>
<span><span class="co">##  3rd Qu.: 66.433   3rd Qu.:140.34  </span></span>
<span><span class="co">##  Max.   :123.460   Max.   :199.37  </span></span>
<span><span class="co">##  NA's   :107       NA's   :127</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="carbon-balance-and-growth">Carbon balance and growth<a class="anchor" aria-label="anchor" href="#carbon-balance-and-growth"></a>
</h3>
<p>Carbon balance and growth simulations require many parameters some of
which are hard to measure experimentally.</p>
<div class="section level4">
<h4 id="maintenance-respiration-rates">Maintenance respiration rates<a class="anchor" aria-label="anchor" href="#maintenance-respiration-rates"></a>
</h4>
<p>Baseline maintenance respiration rates for each tissue (leaf, sapwood
and fine roots) are species-specific parameters in the model. Here we
first leaf dark respiration rates per leaf mass values from TRY (TraitID
= 41):</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_RERleaf</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_41.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_RERleaf</span> <span class="op">&lt;-</span> <span class="va">TRY_RERleaf</span><span class="op">[</span><span class="va">TRY_RERleaf</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We now call the population function, while transforming units of
micro mol C g-1 s-1 to g gluc g-1 d-1:</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_RERleaf</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RERleaf"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RERleaf"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fl">24.0</span><span class="op">*</span><span class="fl">3600.0</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">6.0</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1e-6</span><span class="op">)</span><span class="op">*</span><span class="fl">180.156</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; RERleaf] species: 16 conspecific: 60 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 141 missing trait values (65 %) after populating with input data.</span></span></code></pre>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RERleaf"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">## 0.00664 0.01475 0.02670 0.02955 0.03701 0.07585     141</span></span></code></pre>
<p>Sapwood respiration is much harder to measure and database values are
not retrieved at present.</p>
</div>
<div class="section level4">
<h4 id="nitrogen-content-of-tissues">Nitrogen content of tissues<a class="anchor" aria-label="anchor" href="#nitrogen-content-of-tissues"></a>
</h4>
<p>The model allows estimating leaf and fine root respiration rates from
nitrogen concentration. Hence it is useful to draw this latter parameter
from trait databases. Sapwood respiration rates are given a default
value when missing, but we also draw sapwood N concentrations. Here we
first extract nitrogen concentration per leaf mass values from TRY
(TraitID = 14):</p>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Nleaf</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_14.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_Nleaf</span> <span class="op">&lt;-</span> <span class="va">TRY_Nleaf</span><span class="op">[</span><span class="va">TRY_Nleaf</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We now call the population function:</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Nleaf</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nleaf"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 11185 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 16962 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 17072 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 17073 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): input string 17074 is invalid</span></span></code></pre>
<pre><code><span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span>
<span></span>
<span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span>
<span></span>
<span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span>
<span></span>
<span><span class="co">## Warning in strsplit(trait_taxa, " "): unable to translate 'Sorghum &lt;d7&gt;</span></span>
<span><span class="co">## drummondii' to a wide string</span></span></code></pre>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; Nleaf] species: 94 conspecific: 100 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 23 missing trait values (10.6 %) after populating with input data.</span></span></code></pre>
<p>And we do the same for sapwood and fine roots (TraitIDs = 1229 and
475, respectively):</p>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_Nsapwood</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_1229.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_Nfineroot</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_475.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_Nsapwood</span> <span class="op">&lt;-</span> <span class="va">TRY_Nsapwood</span><span class="op">[</span><span class="va">TRY_Nsapwood</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">TRY_Nfineroot</span> <span class="op">&lt;-</span> <span class="va">TRY_Nfineroot</span><span class="op">[</span><span class="va">TRY_Nfineroot</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Nsapwood</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nsapwood"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; Nsapwood] species: 5 conspecific: 33 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 179 missing trait values (82.5 %) after populating with input data.</span></span></code></pre>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Nfineroot</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nfineroot"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; Nfineroot] species: 15 conspecific: 79 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 123 missing trait values (56.7 %) after populating with input data.</span></span></code></pre>
<p>The statistical distributions of the three parameters is summarized
below:</p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nleaf"</span>, <span class="st">"Nsapwood"</span> ,<span class="st">"Nfineroot"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Nleaf           Nsapwood        Nfineroot     </span></span>
<span><span class="co">##  Min.   : 6.491   Min.   : 0.450   Min.   : 4.750  </span></span>
<span><span class="co">##  1st Qu.:13.994   1st Qu.: 1.435   1st Qu.: 9.736  </span></span>
<span><span class="co">##  Median :19.351   Median : 3.482   Median :12.131  </span></span>
<span><span class="co">##  Mean   :20.103   Mean   : 3.852   Mean   :12.334  </span></span>
<span><span class="co">##  3rd Qu.:24.034   3rd Qu.: 5.662   3rd Qu.:13.720  </span></span>
<span><span class="co">##  Max.   :50.900   Max.   :12.534   Max.   :25.860  </span></span>
<span><span class="co">##  NA's   :23       NA's   :179      NA's   :123</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="wood-carbon-content">Wood carbon content<a class="anchor" aria-label="anchor" href="#wood-carbon-content"></a>
</h4>
<p>Stem carbon content per stem dry mass is given by TRY (TraitID = 407)
and can be easily mapped, after transforming units from mg/g to g/g:</p>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_WoodC</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_407.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_WoodC</span><span class="op">[</span><span class="va">TRY_WoodC</span><span class="op">$</span><span class="va">ErrorRisk</span><span class="op">&lt;</span><span class="fl">3</span>,<span class="op">]</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WoodC"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WoodC"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">}</span><span class="op">)</span>, </span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [StdValue -&gt; WoodC] species: 25 conspecific: 61 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 131 missing trait values (60.4 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WoodC"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.4150  0.4749  0.4838  0.4851  0.5029  0.5233     131</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="construction-costs">Construction costs<a class="anchor" aria-label="anchor" href="#construction-costs"></a>
</h4>
<p>Tissue construction costs are parsed from our own trait compilation
from different sources:</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">lcc_data</span><span class="op">)</span>, </span>
<span>                            trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCleaf"</span> <span class="op">=</span> <span class="st">"CC (g glu g−1)"</span><span class="op">)</span>,</span>
<span>                            taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [CC (g glu g−1) -&gt; CCleaf] species: 50 conspecific: 67 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 100 missing trait values (46.1 %) after populating with input data.</span></span></code></pre>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">scc_data</span><span class="op">)</span>, </span>
<span>                            trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCsapwood"</span> <span class="op">=</span> <span class="st">"CC (g glu g−1)"</span><span class="op">)</span>,</span>
<span>                            taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [CC (g glu g−1) -&gt; CCsapwood] species: 0 conspecific: 14 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 203 missing trait values (93.5 %) after populating with input data.</span></span></code></pre>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fcc_data</span><span class="op">)</span>, </span>
<span>                            trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCfineroot"</span> <span class="op">=</span> <span class="st">"CC (g glu g−1)"</span><span class="op">)</span>,</span>
<span>                            taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [CC (g glu g−1) -&gt; CCfineroot] species: 0 conspecific: 14 genus: 0 family: 0 order: 0 group: 0</span></span>
<span><span class="co">## 203 missing trait values (93.5 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values is:</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCleaf"</span>, <span class="st">"CCsapwood"</span>, <span class="st">"CCfineroot"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      CCleaf        CCsapwood       CCfineroot   </span></span>
<span><span class="co">##  Min.   :1.223   Min.   :1.370   Min.   :1.250  </span></span>
<span><span class="co">##  1st Qu.:1.478   1st Qu.:1.370   1st Qu.:1.250  </span></span>
<span><span class="co">##  Median :1.528   Median :1.470   Median :1.300  </span></span>
<span><span class="co">##  Mean   :1.553   Mean   :1.427   Mean   :1.279  </span></span>
<span><span class="co">##  3rd Qu.:1.601   3rd Qu.:1.470   3rd Qu.:1.300  </span></span>
<span><span class="co">##  Max.   :1.819   Max.   :1.470   Max.   :1.300  </span></span>
<span><span class="co">##  NA's   :100     NA's   :203     NA's   :203</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="relative-starch-for-sapwood-growth">Relative starch for sapwood growth<a class="anchor" aria-label="anchor" href="#relative-starch-for-sapwood-growth"></a>
</h4>
<p>Relative starch for sapwood growth (<span class="math inline">\(RSSG\)</span>) is a threshold indicating when
sapwood formation is possible. For relative starch levels below this
threshold sapwood growth is not possible, so that carbon is saved for
maintenance and replacement of leaves/fine roots. This parameter is
related to shade tolerance, because a high <span class="math inline">\(RSSG\)</span> allows the plant to survive with low
carbon assimilation at the cost of not growing.</p>
<p>Shadow tolerance is available at TRY (TraitID = 603), but data is in
several scales depending on the data set. We selected data set 49, which
corresponds to <span class="citation">Niinemets and Valladares
(2006)</span> and describes shade tolerance in a scale from 1 to 5:</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_ShadeTol</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_603.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TRY_ShadeTol</span> <span class="op">&lt;-</span> <span class="va">TRY_ShadeTol</span><span class="op">[</span><span class="va">TRY_ShadeTol</span><span class="op">$</span><span class="va">DatasetID</span><span class="op">==</span><span class="fl">49</span>,<span class="op">]</span></span></code></pre></div>
<p>We estimated <span class="math inline">\(RSSG\)</span> as a linear
function of shade tolerance, with 1 corresponding to 25% of relative
starch and 5 corresponding to 95%:</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TRY_ShadeTol</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">TRY_ShadeTol</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">)</span></span>
<span><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html" class="external-link">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_ShadeTol</span>, </span>
<span>                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RSSG"</span> <span class="op">=</span> <span class="st">"OrigValueStr"</span><span class="op">)</span>,</span>
<span>                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RSSG"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.25</span><span class="op">+</span><span class="fl">0.70</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, </span>
<span>                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mapping [OrigValueStr -&gt; RSSG] species: 47 conspecific: 82 genus: 0 family: 0 order: 0 group: 0</span></span></code></pre>
<pre><code><span><span class="co">## 88 missing trait values (40.6 %) after populating with input data.</span></span></code></pre>
<p>The distribution of parameter values after estimation is:</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RSSG"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  0.3200  0.4093  0.6350  0.6411  0.9337  0.9500      88</span></span></code></pre>
<!-- ```{r save_SpParams, eval = params$spparams_rebuild, include = FALSE} -->
<!--   wb <- openxlsx::createWorkbook() -->
<!--   openxlsx::addWorksheet(wb, "InitialSpParamsMED") -->
<!--   openxlsx::writeDataTable(wb, "InitialSpParamsMED", SpParams) -->
<!--   openxlsx::saveWorkbook(wb,"../../data-raw/InitialSpParamsMED.xlsx", overwrite=TRUE) -->
<!-- ``` -->
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Asse2020" class="csl-entry">
Asse, Daphné, Christophe F. Randin, Marc Bonhomme, Anne Delestrade, and
Isabelle Chuine. 2020. <span>“<span class="nocase">Process-based models
outcompete correlative models in projecting spring phenology of trees in
a future warmer climate</span>.”</span> <em>Agricultural and Forest
Meteorology</em> 285-286 (January): 107931. <a href="https://doi.org/10.1016/j.agrformet.2020.107931" class="external-link">https://doi.org/10.1016/j.agrformet.2020.107931</a>.
</div>
<div id="ref-Bartlett2012" class="csl-entry">
Bartlett, Megan K, Christine Scoffoni, and Lawren Sack. 2012.
<span>“<span class="nocase">The determinants of leaf turgor loss point
and prediction of drought tolerance of species and biomes: a global
meta-analysis</span>.”</span> <em>Ecology Letters</em> 15 (5): 393–405.
<a href="https://doi.org/10.1111/j.1461-0248.2012.01751.x" class="external-link">https://doi.org/10.1111/j.1461-0248.2012.01751.x</a>.
</div>
<div id="ref-Choat2012" class="csl-entry">
Choat, Brendan, Steven Jansen, Tim J Brodribb, Hervé Cochard, Sylvain
Delzon, Radika Bhaskar, Sandra J Bucci, et al. 2012. <span>“<span class="nocase">Global convergence in the vulnerability of forests to
drought</span>.”</span> <em>Nature</em> 491 (7426): 752–55. <a href="https://doi.org/10.1038/nature11688" class="external-link">https://doi.org/10.1038/nature11688</a>.
</div>
<div id="ref-Delpierre2009" class="csl-entry">
Delpierre, N., E. Dufrêne, K. Soudani, E. Ulrich, S. Cecchini, J. Boé,
and C. François. 2009. <span>“<span class="nocase">Modelling interannual
and spatial variability of leaf senescence for three deciduous tree
species in France</span>.”</span> <em>Agricultural and Forest
Meteorology</em> 149 (6-7): 938–48. <a href="https://doi.org/10.1016/j.agrformet.2008.11.014" class="external-link">https://doi.org/10.1016/j.agrformet.2008.11.014</a>.
</div>
<div id="ref-Duursma2018" class="csl-entry">
Duursma, Remko A., Christopher J. Blackman, Rosana Lopéz, Nicolas K.
Martin-StPaul, Hervé Cochard, and Belinda E. Medlyn. 2018. <span>“<span class="nocase">On the minimum leaf conductance: its role in models of
plant water use, and ecological and environmental
controls</span>.”</span> <em>New Phytologist</em>, no. September. <a href="https://doi.org/10.1111/nph.15395" class="external-link">https://doi.org/10.1111/nph.15395</a>.
</div>
<div id="ref-Hoshika2018" class="csl-entry">
Hoshika, Yasutomo, Yutaka Osada, Alessandra de Marco, Josep Peñuelas,
and Elena Paoletti. 2018. <span>“<span class="nocase">Global diurnal and
nocturnal parameters of stomatal conductance in woody plants and major
crops</span>.”</span> <em>Global Ecology and Biogeography</em> 27 (2):
257–75. <a href="https://doi.org/10.1111/geb.12681" class="external-link">https://doi.org/10.1111/geb.12681</a>.
</div>
<div id="ref-Kattge2011" class="csl-entry">
Kattge, J., S. Díaz, S. Lavorel, I. C. Prentice, P. Leadley, G. Bönisch,
E. Garnier, et al. 2011. <span>“<span class="nocase">TRY - a global
database of plant traits</span>.”</span> <em>Global Change Biology</em>
17 (9): 2905–35. <a href="https://doi.org/10.1111/j.1365-2486.2011.02451.x" class="external-link">https://doi.org/10.1111/j.1365-2486.2011.02451.x</a>.
</div>
<div id="ref-Manzoni2013" class="csl-entry">
Manzoni, Stefano, Giulia Vico, Amilcare Porporato, and Gabriel Katul.
2013. <span>“<span class="nocase">Biological constraints on water
transport in the soil-plant-atmosphere system</span>.”</span>
<em>Advances in Water Resources</em> 51: 292–304. <a href="https://doi.org/10.1016/j.advwatres.2012.03.016" class="external-link">https://doi.org/10.1016/j.advwatres.2012.03.016</a>.
</div>
<div id="ref-Martin-StPaul2017" class="csl-entry">
Martin-StPaul, Nicolas, Sylvain Delzon, and Hervé Cochard. 2017.
<span>“<span class="nocase">Plant resistance to drought depends on
timely stomatal closure</span>.”</span> <em>Ecology Letters</em> 20
(11): 1437–47. <a href="https://doi.org/10.1111/ele.12851" class="external-link">https://doi.org/10.1111/ele.12851</a>.
</div>
<div id="ref-Mencuccini2019" class="csl-entry">
Mencuccini, Maurizio, Teresa Rosas, Lucy Rowland, Brendan Choat, Hans
Cornelissen, Steven Jansen, Koen Kramer, et al. 2019. <span>“<span class="nocase">Leaf economics and plant hydraulics drive leaf : wood
area ratios</span>.”</span> <em>New Phytologist</em>. <a href="https://doi.org/10.1111/nph.15998" class="external-link">https://doi.org/10.1111/nph.15998</a>.
</div>
<div id="ref-Morris2016" class="csl-entry">
Morris, Hugh, Lenka Plavcová, Patrick Cvecko, Esther Fichtler, Mark A.
F. Gillingham, Hugo I. Martínez-Cabrera, Daniel J. Mcglinn, et al. 2016.
<span>“<span class="nocase">A global analysis of parenchyma tissue
fractions in secondary xylem of seed plants</span>.”</span> <em>New
Phytologist</em> 209 (4): 1553–65. <a href="https://doi.org/10.1111/nph.13737" class="external-link">https://doi.org/10.1111/nph.13737</a>.
</div>
<div id="ref-Niinemets2006" class="csl-entry">
Niinemets, Ü, and F Valladares. 2006. <span>“<span class="nocase">Tolerance to shade, drought, and waterlogging of
temperate northern hemisphere trees and shrubs</span>.”</span>
<em>Ecological Monographs</em> 76 (4): 521–47. <a href="http://www.esajournals.org/doi/full/10.1890/0012-9615(2006)076%5B0521:TTSDAW%5D2.0.CO;2" class="external-link">http://www.esajournals.org/doi/full/10.1890/0012-9615(2006)076[0521:TTSDAW]2.0.CO;2</a>.
</div>
<div id="ref-Pausas2016" class="csl-entry">
Pausas, Juli G., R. Brandon Pratt, Jon E. Keeley, Anna L. Jacobsen,
Aaron R. Ramirez, Alberto Vilagrosa, Susana Paula, Iolana N.
Kaneakua-Pia, and Stephen D. Davis. 2016. <span>“<span class="nocase">Towards understanding resprouting at the global
scale</span>.”</span> <em>New Phytologist</em> 209 (3): 945–54. <a href="https://doi.org/10.1111/nph.13644" class="external-link">https://doi.org/10.1111/nph.13644</a>.
</div>
<div id="ref-SanchezMartinez2020" class="csl-entry">
Sanchez‐Martinez, Pablo, Jordi Martínez‐Vilalta, Kyle G. Dexter, Ricardo
A. Segovia, and Maurizio Mencuccini. 2020. <span>“<span class="nocase">Adaptation and coordinated evolution of plant hydraulic
traits</span>.”</span> Edited by Elsa Cleland. <em>Ecology Letters</em>
23 (11): 1599–1610. <a href="https://doi.org/10.1111/ele.13584" class="external-link">https://doi.org/10.1111/ele.13584</a>.
</div>
<div id="ref-Tavsanoglu2018" class="csl-entry">
Tavşanoǧlu, Çaǧatay, and Juli G. Pausas. 2018. <span>“<span class="nocase">A functional trait database for Mediterranean Basin
plants</span>.”</span> <em>Scientific Data</em> 5: 1–18. <a href="https://doi.org/10.1038/sdata.2018.135" class="external-link">https://doi.org/10.1038/sdata.2018.135</a>.
</div>
<div id="ref-Vitasse2011" class="csl-entry">
Vitasse, Yann, Christophe François, Nicolas Delpierre, Eric Dufrêne,
Antoine Kremer, Isabelle Chuine, and Sylvain Delzon. 2011. <span>“<span class="nocase">Assessing the effects of climate change on the phenology
of European temperate trees</span>.”</span> <em>Agricultural and Forest
Meteorology</em> 151 (7): 969–80. <a href="https://doi.org/10.1016/j.agrformet.2011.03.003" class="external-link">https://doi.org/10.1016/j.agrformet.2011.03.003</a>.
</div>
<div id="ref-Yebra2019" class="csl-entry">
Yebra, Marta, Gianluca Scortechini, Abdulbaset Badi, María Eugenia
Beget, Matthias M. Boer, Ross Bradstock, Emilio Chuvieco, et al. 2019.
<span>“<span class="nocase">Globe-LFMC, a global plant water status
database for vegetation ecophysiology and wildfire
applications</span>.”</span> <em>Scientific Data</em> 6 (1): 155. <a href="https://doi.org/10.1038/s41597-019-0164-9" class="external-link">https://doi.org/10.1038/s41597-019-0164-9</a>.
</div>
<div id="ref-Zanne2009" class="csl-entry">
Zanne, A. E., G. Lopez-Gonzalez, D. A. Coomes, J. Ilic, S. Jansen, S. L.
Lewis, R. B. Miller, N. G. Swenson, M. C. Wiemann, and J. Chave. 2009.
<span>“<span class="nocase">Global wood density database</span>.”</span>
<a href="http://datadryad.org/handle/10255/dryad.235" class="external-link">http://datadryad.org/handle/10255/dryad.235</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Forest growth • medfate</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Forest growth">
<meta name="description" content="medfate">
<meta property="og:description" content="medfate">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label=""><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">medfate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../../articles/intro/PackageOverview.html">Package overview</a>
    <a class="dropdown-item" href="../../articles/intro/UnderstandingInputs.html">Understanding model inputs</a>
    <a class="dropdown-item" href="../../articles/intro/PreparingInputs.html">Preparing model inputs</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Running simulation models</h6>
    <a class="dropdown-item" href="../../articles/runmodels/BasicWaterBalance.html">Basic water balance</a>
    <a class="dropdown-item" href="../../articles/runmodels/AdvancedWaterEnergyBalance.html">Advanced water and energy balance</a>
    <a class="dropdown-item" href="../../articles/runmodels/ForestGrowth.html">Forest growth</a>
    <a class="dropdown-item" href="../../articles/runmodels/ForestDynamics.html">Forest dynamics</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Model analysis and parametrization</h6>
    <a class="dropdown-item" href="../../articles/modelanalysis/SensitivityCalibration.html">Sensitivity analysis and calibration</a>
    <a class="dropdown-item" href="../../articles/parametrization/Metamodelling.html">Meta-modelling exercise</a>
    <a class="dropdown-item" href="../../articles/parametrization/GrowthCalibration.html">Calibration of growth and senescence parameters</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Model performance evaluation</h6>
    <a class="dropdown-item" href="../../articles/evaluation/StandLevelEvaluation.html">Evaluation in experimental plots</a>
    <a class="dropdown-item" href="../../articles/evaluation/RegionalLevelEvaluation.html">Evaluation of regional-level forest dynamics with forest inventory data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Application examples</h6>
    <a class="dropdown-item" href="../../articles/workedexamples/FontBlanche.html">Soil and plant water balances at Font-Blanche</a>
    <a class="dropdown-item" href="../../articles/workedexamples/PlantWaterPools.html">Water pools and species interactions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/emf-creaf/medfate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Forest growth</h1>
                        <h4 data-toc-skip class="author">Miquel De
Caceres</h4>
            
            <h4 data-toc-skip class="date">2024-07-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/HEAD/vignettes/runmodels/ForestGrowth.Rmd" class="external-link"><code>vignettes/runmodels/ForestGrowth.Rmd</code></a></small>
      <div class="d-none name"><code>ForestGrowth.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-this-vignette">About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h2>
<p>This document describes how to run the growth model of
<code>medfate</code>, described in De Cáceres et al. (2023) and
implemented in function <code><a href="../../reference/growth.html">growth()</a></code>. All the details of the
model design and formulation can be found at the corresponding chapters
of the <a href="https://emf-creaf.github.io/medfatebook/index.html">medfate
book</a>.</p>
<p>Because the forest growth model builds on the water balance model,
the reader is assumed here to be familiarized with <code><a href="../../reference/spwb.html">spwb()</a></code>.
If not, we recommend reading vignette <a href="https://emf-creaf.github.io/medfate/articles/runmodels/BasicWaterBalance.html"><em>Basic
water balance</em></a> before this one.</p>
</div>
<div class="section level2">
<h2 id="preparing-model-inputs">Preparing model inputs<a class="anchor" aria-label="anchor" href="#preparing-model-inputs"></a>
</h2>
<p>Model inputs are explained in greater detail in vignettes <a href="https://emf-creaf.github.io/medfate/articles/intro/UnderstandingInputs.html"><em>Understanding
model inputs</em></a> and <a href="https://emf-creaf.github.io/medfate/articles/intro/PreparingInputs.html"><em>Preparing
model inputs</em></a>. Here we briefly review the different steps
required to run function <code><a href="../../reference/growth.html">growth()</a></code>.</p>
<div class="section level3">
<h3 id="soil-vegetation-meteorology-and-species-data">Soil, vegetation, meteorology and species data<a class="anchor" aria-label="anchor" href="#soil-vegetation-meteorology-and-species-data"></a>
</h3>
<p>Soil physical characteristics needs to be specified using a
<code>data frame</code> with soil layers in rows and physical attributes
in columns. Soil physical attributes can be initialized to default
values, for a given number of layers, using function
<code><a href="../../reference/defaultSoilParams.html">defaultSoilParams()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplesoil</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/defaultSoilParams.html">defaultSoilParams</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">examplesoil</span></span></code></pre></div>
<pre><code><span><span class="co">##   widths clay sand om nitrogen  bd rfc</span></span>
<span><span class="co">## 1    300   25   25 NA       NA 1.5  25</span></span>
<span><span class="co">## 2    700   25   25 NA       NA 1.5  45</span></span>
<span><span class="co">## 3   1000   25   25 NA       NA 1.5  75</span></span>
<span><span class="co">## 4   2000   25   25 NA       NA 1.5  95</span></span></code></pre>
<p>As explained in the package overview, models included in
<code>medfate</code> were primarily designed to be ran on <strong>forest
inventory plots</strong>. Here we use the example forest object provided
with the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exampleforest</span><span class="op">)</span></span>
<span><span class="va">exampleforest</span></span></code></pre></div>
<pre><code><span><span class="co">## $treeData</span></span>
<span><span class="co">##            Species   N   DBH Height Z50  Z95</span></span>
<span><span class="co">## 1 Pinus halepensis 168 37.55    800 100  600</span></span>
<span><span class="co">## 2     Quercus ilex 384 14.60    660 300 1000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $shrubData</span></span>
<span><span class="co">##             Species Cover Height Z50  Z95</span></span>
<span><span class="co">## 1 Quercus coccifera  3.75     80 200 1000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $herbCover</span></span>
<span><span class="co">## [1] 10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $herbHeight</span></span>
<span><span class="co">## [1] 20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $seedBank</span></span>
<span><span class="co">## [1] Species Percent</span></span>
<span><span class="co">## &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "forest" "list"</span></span></code></pre>
<p>Importantly, a data frame with daily weather for the period to be
simulated is required. Here we use the default data frame included with
the package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">examplemeteo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        dates MinTemperature MaxTemperature Precipitation MinRelativeHumidity</span></span>
<span><span class="co">## 1 2001-01-01     -0.5934215       6.287950      4.869109            65.15411</span></span>
<span><span class="co">## 2 2001-01-02     -2.3662458       4.569737      2.498292            57.43761</span></span>
<span><span class="co">## 3 2001-01-03     -3.8541036       2.661951      0.000000            58.77432</span></span>
<span><span class="co">## 4 2001-01-04     -1.8744860       3.097705      5.796973            66.84256</span></span>
<span><span class="co">## 5 2001-01-05      0.3288287       7.551532      1.884401            62.97656</span></span>
<span><span class="co">## 6 2001-01-06      0.5461322       7.186784     13.359801            74.25754</span></span>
<span><span class="co">##   MaxRelativeHumidity Radiation WindSpeed</span></span>
<span><span class="co">## 1           100.00000  12.89251  2.000000</span></span>
<span><span class="co">## 2            94.71780  13.03079  7.662544</span></span>
<span><span class="co">## 3            94.66823  16.90722  2.000000</span></span>
<span><span class="co">## 4            95.80950  11.07275  2.000000</span></span>
<span><span class="co">## 5           100.00000  13.45205  7.581347</span></span>
<span><span class="co">## 6           100.00000  12.84841  6.570501</span></span></code></pre>
<p>The weather variables required by the <code><a href="../../reference/growth.html">growth()</a></code> function
depend on the complexity of the water balance simulations underlying
growth (i.e. on the control parameter <code>transpirationMode</code>,
see below).</p>
<p>Finally, all simulations in <code>medfate</code> require a data frame
with species parameter values, for which we load using defaults for
Catalonia (NE Spain):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SpParamsMED"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulation-control">Simulation control<a class="anchor" aria-label="anchor" href="#simulation-control"></a>
</h3>
<p>Apart from data inputs, the behaviour of simulation models can be
controlled using a set of global parameters. The default
parameterization is obtained using function
<code><a href="../../reference/defaultControl.html">defaultControl()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="../../reference/defaultControl.html">defaultControl</a></span><span class="op">(</span><span class="st">"Granier"</span><span class="op">)</span></span></code></pre></div>
<p>Here we will run growth simulations using the basic water balance
model (i.e. <code>transpirationMode = "Granier"</code>). The complexity
of the soil water balance calculations can be changed by using
<code>"Sperry"</code> as input to <code><a href="../../reference/defaultControl.html">defaultControl()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="growth-input-object">Growth input object<a class="anchor" aria-label="anchor" href="#growth-input-object"></a>
</h3>
<p>A last object, called <code>growthInput</code>, needs to be created
before calling the simulation function. This is analogous to
<code>spwbInput</code> and consists in the compilation of soil and
cohort-level parameters needed for simulations. The object can be
obtained by using function <code><a href="../../reference/modelInput.html">growthInput()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/modelInput.html">growthInput</a></span><span class="op">(</span><span class="va">exampleforest</span>, <span class="va">examplesoil</span>, <span class="va">SpParamsMED</span>, <span class="va">control</span><span class="op">)</span></span></code></pre></div>
<p>All the input information for forest data and species parameter
values can be inspected by printing different elements of the input
object, whose names are:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "control"                     "soil"                       </span></span>
<span><span class="co">##  [3] "snowpack"                    "canopy"                     </span></span>
<span><span class="co">##  [5] "herbLAI"                     "herbLAImax"                 </span></span>
<span><span class="co">##  [7] "cohorts"                     "above"                      </span></span>
<span><span class="co">##  [9] "below"                       "belowLayers"                </span></span>
<span><span class="co">## [11] "paramsPhenology"             "paramsAnatomy"              </span></span>
<span><span class="co">## [13] "paramsInterception"          "paramsTranspiration"        </span></span>
<span><span class="co">## [15] "paramsWaterStorage"          "paramsGrowth"               </span></span>
<span><span class="co">## [17] "paramsMortalityRegeneration" "paramsAllometries"          </span></span>
<span><span class="co">## [19] "internalPhenology"           "internalWater"              </span></span>
<span><span class="co">## [21] "internalCarbon"              "internalAllocation"         </span></span>
<span><span class="co">## [23] "internalMortality"           "internalFCCS"</span></span></code></pre>
<p>As with <code>spwbInput</code> objects, information about the cohort
species is found in element <code>cohorts</code> (i.e. code, species and
name):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">cohorts</span></span></code></pre></div>
<pre><code><span><span class="co">##         SP              Name</span></span>
<span><span class="co">## T1_148 148  Pinus halepensis</span></span>
<span><span class="co">## T2_168 168      Quercus ilex</span></span>
<span><span class="co">## S1_165 165 Quercus coccifera</span></span></code></pre>
<p>Element <code>above</code> contains the above-ground structure data
that we already know, but with an additional columns that describes the
estimated initial amount of <em>sapwood area</em>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">above</span></span></code></pre></div>
<pre><code><span><span class="co">##         SP        N   DBH Cover   H        CR          SA   LAI_live</span></span>
<span><span class="co">## T1_148 148 168.0000 37.55    NA 800 0.6605196 383.4520992 0.84874773</span></span>
<span><span class="co">## T2_168 168 384.0000 14.60    NA 660 0.6055642  47.0072886 0.70557382</span></span>
<span><span class="co">## S1_165 165 749.4923    NA  3.75  80 0.8032817   0.9753929 0.03062604</span></span>
<span><span class="co">##        LAI_expanded LAI_dead    Loading</span></span>
<span><span class="co">## T1_148   0.84874773        0 0.32447403</span></span>
<span><span class="co">## T2_168   0.70557382        0 0.20102636</span></span>
<span><span class="co">## S1_165   0.03062604        0 0.01407945</span></span></code></pre>
<p>Elements starting with <code>params*</code> contain cohort-specific
model parameters. Some of them were already presented in previous
vignettes (<a href="https://emf-creaf.github.io/medfate/articles/runmodels/BasicWaterBalance.html"><em>Basic
water balance</em></a> and <a href="https://emf-creaf.github.io/medfate/articles/runmodels/AdvancedWaterEnergyBalance.html"><em>Advanced
water/energy balance</em></a>). An important set of new cohort-specific
parameters for the forest growth model are
<code>paramsGrowth</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">paramsGrowth</span></span></code></pre></div>
<pre><code><span><span class="co">##           RERleaf RERsapwood  RERfineroot CCleaf CCsapwood CCfineroot</span></span>
<span><span class="co">## T1_148 0.01210607   5.15e-05 0.0009610199 1.5905      1.47        1.3</span></span>
<span><span class="co">## T2_168 0.01757808   5.15e-05 0.0072846640 1.4300      1.47        1.3</span></span>
<span><span class="co">## S1_165 0.02647746   5.15e-05 0.0072846640 1.5320      1.47        1.3</span></span>
<span><span class="co">##        RGRleafmax RGRsapwoodmax RGRcambiummax RGRfinerootmax SRsapwood</span></span>
<span><span class="co">## T1_148       0.09            NA   0.003410814            0.1  0.000135</span></span>
<span><span class="co">## T2_168       0.09            NA   0.001554011            0.1  0.000135</span></span>
<span><span class="co">## S1_165       0.09         0.002            NA            0.1  0.000135</span></span>
<span><span class="co">##         SRfineroot      RSSG fHDmin fHDmax     WoodC</span></span>
<span><span class="co">## T1_148 0.001897231 0.3725000     80    160 0.4979943</span></span>
<span><span class="co">## T2_168 0.001897231 0.9500000     40    100 0.4740096</span></span>
<span><span class="co">## S1_165 0.001897231 0.7804035     NA     NA 0.4749178</span></span></code></pre>
<p>which includes maximum growth rates, senescence rates and maintenance
respiration rages. Another important set of parameters is given in
<code>paramsAllometries</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">paramsAllometries</span></span></code></pre></div>
<pre><code><span><span class="co">##              Afbt     Bfbt        Cfbt      Aash     Bash      Absh      Bbsh</span></span>
<span><span class="co">## T1_148 0.07607828 1.462411 -0.02280106        NA       NA        NA        NA</span></span>
<span><span class="co">## T2_168 0.07848713 1.497670 -0.01470000 1.8574862 1.885548 0.5238830 0.7337293</span></span>
<span><span class="co">## S1_165         NA       NA          NA 0.1305509 2.408443 0.5147731 0.5311554</span></span>
<span><span class="co">##        BTsh     Acr   B1cr     B2cr         B3cr     C1cr     C2cr       Acw</span></span>
<span><span class="co">## T1_148   NA 1.99500 -0.649 -0.02000 -0.000120000 -0.00400 -0.15900 0.6415296</span></span>
<span><span class="co">## T2_168    2 1.98539 -0.552 -0.01386 -0.000110736 -0.00685 -0.20101 0.5681897</span></span>
<span><span class="co">## S1_165    2      NA     NA       NA           NA       NA       NA        NA</span></span>
<span><span class="co">##           Bcw       Abt       Bbt</span></span>
<span><span class="co">## T1_148 0.7310 0.5535741 1.1848613</span></span>
<span><span class="co">## T2_168 0.7974 0.5622245 0.9626839</span></span>
<span><span class="co">## S1_165     NA        NA        NA</span></span></code></pre>
<p>Note that in the previous models, allometries were already used to
estimate above-ground structural parameters, but these were static
during simulations.</p>
<p>Elements starting with <code>internal*</code> contain state variables
required to keep track of plant status. For example, the metabolic and
storage carbon levels can be seen in <code>internalCarbon</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">internalCarbon</span></span></code></pre></div>
<pre><code><span><span class="co">##        sugarLeaf starchLeaf sugarSapwood starchSapwood</span></span>
<span><span class="co">## T1_148 0.4029239 0.00925123    0.5738487      3.276375</span></span>
<span><span class="co">## T2_168 0.3585751 0.00925123    1.0741383      3.280965</span></span>
<span><span class="co">## S1_165 0.7223526 0.00925123    0.2857655      3.445161</span></span></code></pre>
<p>and <code>internalAllocation</code> stores the carbon allocation
targets:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">internalAllocation</span></span></code></pre></div>
<pre><code><span><span class="co">##        allocationTarget leafAreaTarget sapwoodAreaTarget fineRootBiomassTarget</span></span>
<span><span class="co">## T1_148         1317.523     50.5206982       383.4520992            1381.89095</span></span>
<span><span class="co">## T2_168         3908.823     18.3743183        47.0072886             546.69314</span></span>
<span><span class="co">## S1_165         4189.325      0.4086238         0.9753929              10.58569</span></span>
<span><span class="co">##        crownBudPercent</span></span>
<span><span class="co">## T1_148             100</span></span>
<span><span class="co">## T2_168             100</span></span>
<span><span class="co">## S1_165             100</span></span></code></pre>
<p>Additional <code>internal*</code> elements are
<code>internalMortality</code>, used to keep track of dead individuals;
and <code>internalRings</code>, which stores state variables used to
model sink limitations on wood formation.</p>
</div>
</div>
<div class="section level2">
<h2 id="executing-the-growth-model">Executing the growth model<a class="anchor" aria-label="anchor" href="#executing-the-growth-model"></a>
</h2>
<p>Having all the input information we are ready to call function
<code><a href="../../reference/growth.html">growth()</a></code>, which has the same parameter names as
<code><a href="../../reference/spwb.html">spwb()</a></code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G1</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/growth.html">growth</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">examplemeteo</span>, latitude <span class="op">=</span> <span class="fl">41.82592</span>, elevation <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package 'meteoland' [ver. 2.2.1]</span></span></code></pre>
<pre><code><span><span class="co">## Initial plant cohort biomass (g/m2): 6110.86</span></span>
<span><span class="co">## Initial plant water content (mm): 7.05859</span></span>
<span><span class="co">## Initial soil water content (mm): 290.875</span></span>
<span><span class="co">## Initial snowpack content (mm): 0</span></span>
<span><span class="co">## Performing daily simulations</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Year 2001:....................................</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Final plant biomass (g/m2): 6274.27</span></span>
<span><span class="co">## Change in plant biomass (g/m2): 163.412</span></span>
<span><span class="co">## Plant biomass balance result (g/m2): 163.412</span></span>
<span><span class="co">## Plant biomass balance components:</span></span>
<span><span class="co">##   Structural balance (g/m2) 79 Labile balance (g/m2) 94</span></span>
<span><span class="co">##   Plant individual balance (g/m2) 173 Mortality loss (g/m2) 10</span></span>
<span><span class="co">## Final plant water content (mm): 7.07876</span></span>
<span><span class="co">## Final soil water content (mm): 278.326</span></span>
<span><span class="co">## Final snowpack content (mm): 0</span></span>
<span><span class="co">## Change in plant water content (mm): 0.0201684</span></span>
<span><span class="co">## Plant water balance result (mm): -0.00116899</span></span>
<span><span class="co">## Change in soil water content (mm): -12.5489</span></span>
<span><span class="co">## Soil water balance result (mm): -12.5489</span></span>
<span><span class="co">## Change in snowpack water content (mm): 0</span></span>
<span><span class="co">## Snowpack water balance result (mm): -7.10543e-15</span></span>
<span><span class="co">## Water balance components:</span></span>
<span><span class="co">##   Precipitation (mm) 513 Rain (mm) 462 Snow (mm) 51</span></span>
<span><span class="co">##   Interception (mm) 92 Net rainfall (mm) 370</span></span>
<span><span class="co">##   Infiltration (mm) 398 Infiltration excess (mm) 23 Saturation excess (mm) 0 Capillarity rise (mm) 0</span></span>
<span><span class="co">##   Soil evaporation (mm) 31  Herbaceous transpiration (mm) 14 Woody plant transpiration (mm) 185</span></span>
<span><span class="co">##   Plant extraction from soil (mm) 185  Plant water balance (mm) -0 Hydraulic redistribution (mm) 1</span></span>
<span><span class="co">##   Runoff (mm) 23 Deep drainage (mm) 182</span></span></code></pre>
<p>At the end of daily simulations, the <code><a href="../../reference/growth.html">growth()</a></code> function
displays information regarding the carbon and water balance, which is
mostly useful to check that balances are closed.</p>
<p>Function <code><a href="../../reference/growth.html">growth()</a></code> returns an object of class with the
same name, actually a list:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">G1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "growth" "list"</span></span></code></pre>
<p>If we inspect its elements, we realize that some of them are the same
as returned by <code><a href="../../reference/spwb.html">spwb()</a></code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">G1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "latitude"            "topography"          "weather"            </span></span>
<span><span class="co">##  [4] "growthInput"         "growthOutput"        "WaterBalance"       </span></span>
<span><span class="co">##  [7] "CarbonBalance"       "BiomassBalance"      "Soil"               </span></span>
<span><span class="co">## [10] "Snow"                "Stand"               "Plants"             </span></span>
<span><span class="co">## [13] "LabileCarbonBalance" "PlantBiomassBalance" "PlantStructure"     </span></span>
<span><span class="co">## [16] "GrowthMortality"</span></span></code></pre>
<p>Some elements are common with the output of <code><a href="../../reference/spwb.html">spwb()</a></code>. In
particular, <code>growthInput</code> contains a copy of the input
object, whereas <code>growthOutput</code> contains the same object, but
with values of state variables at the end of simulation. The new list
elements, with respect to the output of function <code><a href="../../reference/spwb.html">spwb()</a></code>,
are <code>LabileCarbonBalance</code> (components of the labile carbon
balance), <code>PlantBiomassBalance</code> (plant- and cohort-level
biomass balance), <code>PlantStructure</code> (daily series of
structural variables) and <code>GrowthMortality</code> (daily growth and
mortality rates).</p>
</div>
<div class="section level2">
<h2 id="inspecting-model-outputs">Inspecting model outputs<a class="anchor" aria-label="anchor" href="#inspecting-model-outputs"></a>
</h2>
<p>Users can extract, summarize or inspect the output of
<code><a href="../../reference/growth.html">growth()</a></code> simulations as done for simulations with
<code><a href="../../reference/spwb.html">spwb()</a></code>.</p>
<div class="section level3">
<h3 id="extracting-output">Extracting output<a class="anchor" aria-label="anchor" href="#extracting-output"></a>
</h3>
<p>Function <code><a href="../../reference/extract.html">extract()</a></code> allow extracting model outputs in
form of data frame:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/extract.html">extract</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"forest"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "date"                    "PET"                    </span></span>
<span><span class="co">##  [3] "Precipitation"           "Rain"                   </span></span>
<span><span class="co">##  [5] "Snow"                    "NetRain"                </span></span>
<span><span class="co">##  [7] "Snowmelt"                "Infiltration"           </span></span>
<span><span class="co">##  [9] "InfiltrationExcess"      "SaturationExcess"       </span></span>
<span><span class="co">## [11] "Runoff"                  "DeepDrainage"           </span></span>
<span><span class="co">## [13] "CapillarityRise"         "Evapotranspiration"     </span></span>
<span><span class="co">## [15] "Interception"            "SoilEvaporation"        </span></span>
<span><span class="co">## [17] "HerbTranspiration"       "PlantExtraction"        </span></span>
<span><span class="co">## [19] "Transpiration"           "HydraulicRedistribution"</span></span>
<span><span class="co">## [21] "LAI"                     "LAIherb"                </span></span>
<span><span class="co">## [23] "LAIlive"                 "LAIexpanded"            </span></span>
<span><span class="co">## [25] "LAIdead"                 "Cm"                     </span></span>
<span><span class="co">## [27] "LgroundPAR"              "LgroundSWR"             </span></span>
<span><span class="co">## [29] "SWE"</span></span></code></pre>
<p>These data frames are easy handle in R or can be written into text
files for post-processing with other programs.</p>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>Several plots are available, in addition to all the plots that were
available to display the results of <code><a href="../../reference/spwb.html">spwb()</a></code> simulations.
Some of them are illustrated in the following subsections:</p>
<p>To inspect components of the plant carbon balance we can first
display daily gross photosynthesis expressed as the carbon fixation
relative to dry biomass:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"GrossPhotosynthesis"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-18-1.png" width="672">
Then we can draw the maintenance respiration costs (which include the
sum of leaf, sapwood and fine root respiration) in the same units:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"MaintenanceRespiration"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-19-1.png" width="672">
Finally we can display the daily negative or positive balance of the
plant storage, which determines changes in plant carbon pools:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"LabileCarbonBalance"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p>Carbon assimilation and respiration rates define the dynamics of
stored carbon. The most important storage compartment is sapwood starch,
whose dynamics can be shown using:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"StarchSapwood"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>Leaf and sapwood area dynamics arising from the interplay between
growth and senescence of tissues can be inspected using:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"LeafArea"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"SapwoodArea"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-22-2.png" width="672">
Even if one year is a short period for tree growth, we can display the
resulting dynamics in diameter at breast height (DBH) or plant
height:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"DBH"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 365 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="st">"Height"</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-23-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="interactive-plots">Interactive plots<a class="anchor" aria-label="anchor" href="#interactive-plots"></a>
</h3>
<p>Finally, recall that one can interactively create plots using
function <code>shinyplot</code>, e.g.:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/shinyplot.html">shinyplot</a></span><span class="op">(</span><span class="va">G1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="growth-evaluation">Growth evaluation<a class="anchor" aria-label="anchor" href="#growth-evaluation"></a>
</h2>
<p>Evaluation of growth simulations will normally imply the comparison
of predicted vs observed basal area increment (BAI) or diameter
increment at a given temporal resolution.</p>
<p>Here, we illustrate the evaluation functions included in the package
using a fake data set, consisting on the predicted values and some added
error.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exampleobs</span><span class="op">)</span></span></code></pre></div>
<p>Normally growth evaluations will be at annual scale, but here we only
have one year of simulated growth. Assuming we want to evaluate the
predictive capacity of the model in terms of monthly basal area
increment for the pine cohort, we can plot the relationship between
observed and predicted values using function
<code><a href="../../reference/evaluation.html">evaluation_plot()</a></code>:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/evaluation.html">evaluation_plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">exampleobs</span>, <span class="st">"BAI"</span>, cohort <span class="op">=</span> <span class="st">"T1_148"</span>, </span>
<span>                temporalResolution <span class="op">=</span> <span class="st">"month"</span>, plotType <span class="op">=</span> <span class="st">"scatter"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-26-1.png" width="384"></p>
<p>And the following would help us quantifying the strength of the
relationship:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/evaluation.html">evaluation_stats</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">exampleobs</span>, <span class="st">"BAI"</span>, cohort <span class="op">=</span> <span class="st">"T1_148"</span>, </span>
<span>                 temporalResolution <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           n        Bias    Bias.rel         MAE     MAE.rel           r </span></span>
<span><span class="co">##  12.0000000  -0.2191758 -15.9764398   0.2207305  16.0897655   0.9920926 </span></span>
<span><span class="co">##         NSE     NSE.abs </span></span>
<span><span class="co">##   0.9245610   0.7924024</span></span></code></pre>
<p>The observed data set is fake and the evaluation is unrealistically
good. For illustrative purposes, we also compare diameter increment
values, here drawing the observed and predicted time series
together:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/evaluation.html">evaluation_plot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">exampleobs</span>, <span class="st">"DI"</span>, cohort <span class="op">=</span> <span class="st">"T1_148"</span>, </span>
<span>                temporalResolution <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ForestGrowth_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<p>Again, actual comparisons will be done at coarser temporal
resolution. For convenience, function <code><a href="../../reference/shinyplot.html">shinyplot()</a></code> also
accepts an observed data frame as second argument, which allows
performing model evaluation interactively:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/shinyplot.html">shinyplot</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">exampleobs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>De Cáceres M, Molowny-Horas R, Cabon A, Martínez-Vilalta J,
Mencuccini M, García-Valdés R, Nadal-Sala D, Sabaté S, Martin-StPaul N,
Morin X, D’Adamo F, Batllori E, Améztegui A (2023) MEDFATE 2.9.3: A
trait-enabled model to simulate Mediterranean forest function and
dynamics at regional scales. Geoscientific Model Development 16:
3165-3201 (<a href="https://doi.org/10.5194/gmd-16-3165-2023" class="external-link uri">https://doi.org/10.5194/gmd-16-3165-2023</a>).</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="TRUE"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
